<span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><a name="l1" /></span><span style="color: #007700">require_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">'/api/php_printer/autoload.php'</span><span style="color: #007700">);<br /><a name="l2" />require_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">"/connections/tp_connect.php"</span><span style="color: #007700">);<br /><a name="l3" /></span><span style="color: #0000BB">date_default_timezone_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'America/Chicago'</span><span style="color: #007700">);<br /><a name="l4" /><br /><a name="l5" />use&nbsp;</span><span style="color: #0000BB">Mike42</span><span style="color: #007700">\</span><span style="color: #0000BB">Escpos</span><span style="color: #007700">\</span><span style="color: #0000BB">Printer</span><span style="color: #007700">;<br /><a name="l6" />use&nbsp;</span><span style="color: #0000BB">Mike42</span><span style="color: #007700">\</span><span style="color: #0000BB">Escpos</span><span style="color: #007700">\</span><span style="color: #0000BB">EscposImage</span><span style="color: #007700">;<br /><a name="l7" />use&nbsp;</span><span style="color: #0000BB">Mike42</span><span style="color: #007700">\</span><span style="color: #0000BB">Escpos</span><span style="color: #007700">\</span><span style="color: #0000BB">PrintConnectors</span><span style="color: #007700">\</span><span style="color: #0000BB">NetworkPrintConnector</span><span style="color: #007700">;<br /><a name="l8" /><br /><a name="l9" />function&nbsp;</span><span style="color: #0000BB">wait</span><span style="color: #007700">(){<br /><a name="l10" />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$tphost</span><span style="color: #007700">;<br /><a name="l11" />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$tpport</span><span style="color: #007700">;<br /><a name="l12" /><br /><a name="l13" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Set&nbsp;up&nbsp;Printer<br /><a name="l14" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">try&nbsp;{<br /><a name="l15" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$connector&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">NetworkPrintConnector</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$tphost</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$tpport</span><span style="color: #007700">);<br /><a name="l16" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Printer</span><span style="color: #007700">(</span><span style="color: #0000BB">$connector</span><span style="color: #007700">);<br /><a name="l17" />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$setup_error</span><span style="color: #007700">)&nbsp;{<br /><a name="l18" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$json_out</span><span style="color: #007700">[</span><span style="color: #DD0000">"ERROR"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$setup_error</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">();<br /><a name="l19" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l20" /><br /><a name="l21" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//header<br /><a name="l22" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">try&nbsp;{<br /><a name="l23" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$img&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">EscposImage</span><span style="color: #007700">::</span><span style="color: #0000BB">load</span><span style="color: #007700">(</span><span style="color: #DD0000">"../../images/fablab2.png"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /><a name="l24" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l25" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">setJustification</span><span style="color: #007700">(</span><span style="color: #0000BB">Printer</span><span style="color: #007700">::</span><span style="color: #0000BB">JUSTIFY_CENTER</span><span style="color: #007700">);<br /><a name="l26" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">graphics</span><span style="color: #007700">(</span><span style="color: #0000BB">$img</span><span style="color: #007700">);<br /><a name="l27" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l28" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">text</span><span style="color: #007700">(</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">"F&nbsp;jS&nbsp;Y&nbsp;h:i&nbsp;A"</span><span style="color: #007700">));<br /><a name="l29" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l30" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//$printer&nbsp;-&gt;&nbsp;text("Ticket:&nbsp;"&nbsp;.&nbsp;$trans_id);<br /><a name="l31" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">text</span><span style="color: #007700">(</span><span style="color: #DD0000">"Wait-Tab:&nbsp;000"</span><span style="color: #007700">);<br /><a name="l32" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l33" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l34" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//body<br /><a name="l35" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l36" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">text</span><span style="color: #007700">(</span><span style="color: #DD0000">"3D&nbsp;Printer"</span><span style="color: #007700">);<br /><a name="l37" /><br /><a name="l38" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Print&nbsp;Footer<br /><a name="l39" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l40" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">text</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://fablab.uta.edu/"</span><span style="color: #007700">);<br /><a name="l41" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l42" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l43" />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$print_error</span><span style="color: #007700">)&nbsp;{<br /><a name="l44" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$json_out</span><span style="color: #007700">[</span><span style="color: #DD0000">"ERROR"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$print_error</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">();<br /><a name="l45" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l46" /><br /><a name="l47" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Close&nbsp;Printer&nbsp;Connection<br /><a name="l48" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">try&nbsp;{<br /><a name="l49" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l50" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">feed</span><span style="color: #007700">();<br /><a name="l51" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">cut</span><span style="color: #007700">();<br /><a name="l52" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l53" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Close&nbsp;printer&nbsp;*/<br /><a name="l54" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$printer&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br /><a name="l55" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l56" />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br /><a name="l57" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Couldn't&nbsp;print&nbsp;to&nbsp;this&nbsp;printer:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$e&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><a name="l58" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l59" />}<br /><a name="l60" /></span><span style="color: #0000BB">?&gt;</span>
</span>