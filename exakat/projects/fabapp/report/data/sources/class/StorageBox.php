<span style="color: #000000">
<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l1" /><br /><a name="l2" /></span><span style="color: #FF8000">/***********************************************************************************************************<br /><a name="l3" />*&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l4" />*&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;MPZinke&nbsp;on&nbsp;06.11.19<br /><a name="l5" />*&nbsp;&nbsp;&nbsp;&nbsp;Edited&nbsp;by:&nbsp;MPZinke&nbsp;on&nbsp;06.11.19&nbsp;to&nbsp;improve&nbsp;commenting&nbsp;an&nbsp;logic/functionality&nbsp;of&nbsp;class<br /><a name="l6" />*&nbsp;&nbsp;&nbsp;&nbsp;CC&nbsp;BY-NC-AS&nbsp;UTA&nbsp;FabLab&nbsp;2016-2019<br /><a name="l7" />*&nbsp;&nbsp;&nbsp;&nbsp;FabApp&nbsp;V&nbsp;0.94<br /><a name="l8" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-House&nbsp;Keeping&nbsp;(DB&nbsp;cleanup,&nbsp;$status&nbsp;variable,&nbsp;class&nbsp;syntax/functionality)<br /><a name="l9" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Multiple&nbsp;Materials<br /><a name="l10" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Off-line&nbsp;Mode<br /><a name="l11" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Sheet&nbsp;Goods<br /><a name="l12" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Storage&nbsp;Box<br /><a name="l13" />*<br /><a name="l14" />*&nbsp;&nbsp;&nbsp;&nbsp;DESCRIPTION:&nbsp;Instance&nbsp;mostly&nbsp;called&nbsp;by&nbsp;Device()&nbsp;member.&nbsp;&nbsp;Holds&nbsp;&amp;&nbsp;gets&nbsp;information&nbsp;<br /><a name="l15" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;DB<br /><a name="l16" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l17" />*<br /><a name="l18" />***********************************************************************************************************/<br /><a name="l19" />/***********************************************************************************************************<br /><a name="l20" />*&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l21" />*&nbsp;&nbsp;&nbsp;&nbsp;FUTURE:&nbsp;-Allow&nbsp;for&nbsp;a&nbsp;transaction&nbsp;to&nbsp;be&nbsp;stored&nbsp;across&nbsp;multiple&nbsp;areas<br /><a name="l22" />*<br /><a name="l23" />***********************************************************************************************************/<br /><a name="l24" /><br /><a name="l25" />//&nbsp;create&nbsp;instance&nbsp;of&nbsp;storage-side&nbsp;information&nbsp;of&nbsp;a&nbsp;transaction<br /><a name="l26" /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">StorageObject&nbsp;</span><span style="color: #007700">{<br /><a name="l27" /><br /><a name="l28" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;storage_start&nbsp;&amp;&nbsp;storage_end&nbsp;are&nbsp;mutually&nbsp;exclusiveâ€”info&nbsp;for&nbsp;both&nbsp;will&nbsp;never&nbsp;be&nbsp;had<br /><a name="l29" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;transaction&nbsp;object&nbsp;of&nbsp;ticket<br /><a name="l30" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;`storage_box`&nbsp;data<br /><a name="l31" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;location&nbsp;in&nbsp;text&nbsp;eg&nbsp;'1B'<br /><a name="l32" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;staff&nbsp;object&nbsp;of&nbsp;fablab&nbsp;employee&nbsp;who&nbsp;last&nbsp;moved&nbsp;object<br /><a name="l33" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$storage_start</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;if&nbsp;object&nbsp;currently&nbsp;in&nbsp;storage,&nbsp;item_change_time;&nbsp;else&nbsp;null<br /><a name="l34" /><br /><a name="l35" /><br /><a name="l36" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l37" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">))&nbsp;return;<br /><a name="l38" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">;<br /><a name="l39" /><br /><a name="l40" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l41" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*<br /><a name="l42" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l43" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">';"<br /><a name="l44" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l45" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//FUTURE:&nbsp;not&nbsp;yet&nbsp;designed&nbsp;to&nbsp;handle&nbsp;more&nbsp;than&nbsp;1&nbsp;transaction<br /><a name="l46" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows</span><span style="color: #007700">)&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">&nbsp;has&nbsp;no&nbsp;objects&nbsp;in&nbsp;storage"</span><span style="color: #007700">);<br /><a name="l47" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l48" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br /><a name="l49" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">box_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'drawer'</span><span style="color: #007700">].</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'unit'</span><span style="color: #007700">];<br /><a name="l50" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">staff&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Users</span><span style="color: #007700">::</span><span style="color: #0000BB">withID</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'staff_id'</span><span style="color: #007700">]);<br /><a name="l51" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">storage_start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'item_change_time'</span><span style="color: #007700">];<br /><a name="l52" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l53" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l54" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l55" /><br /><a name="l56" /><br /><a name="l57" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;add&nbsp;an&nbsp;item&nbsp;to&nbsp;a&nbsp;location.&nbsp;&nbsp;If&nbsp;already&nbsp;in&nbsp;storage,&nbsp;remove&nbsp;from&nbsp;previous&nbsp;location<br /><a name="l58" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">add_object_to_location_from_possible_previous</span><span style="color: #007700">(</span><span style="color: #0000BB">$location</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l59" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">;<br /><a name="l60" /><br /><a name="l61" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;clear&nbsp;previous&nbsp;storage&nbsp;box&nbsp;if&nbsp;exists<br /><a name="l62" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">object_is_in_storage</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">remove_object_from_storage</span><span style="color: #007700">(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">);<br /><a name="l63" /><br /><a name="l64" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;move&nbsp;to&nbsp;new&nbsp;location<br /><a name="l65" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$indicators&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">drawer_and_unit_dict_from_combined_box_label</span><span style="color: #007700">(</span><span style="color: #0000BB">$location</span><span style="color: #007700">);<br /><a name="l66" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;adjust&nbsp;the&nbsp;binding_parameters&nbsp;for&nbsp;the&nbsp;box-unit&nbsp;relationship&nbsp;(alph-num&nbsp;or&nbsp;num-alpha)<br /><a name="l67" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$execute_type&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'strg_drwr_indicator'</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"numer"&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">"dsds"&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"dssd"</span><span style="color: #007700">;<br /><a name="l68" /><br /><a name="l69" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"UPDATE&nbsp;`storage_box`<br /><a name="l70" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;`trans_id`&nbsp;=&nbsp;?,&nbsp;`item_change_time`&nbsp;=&nbsp;CURRENT_TIMESTAMP,&nbsp;`staff_id`&nbsp;=&nbsp;?<br /><a name="l71" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;?&nbsp;AND&nbsp;`unit`&nbsp;=&nbsp;?;"</span><span style="color: #007700">);<br /><a name="l72" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #0000BB">$execute_type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$indicators</span><span style="color: #007700">[</span><span style="color: #DD0000">'drawer'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$indicators</span><span style="color: #007700">[</span><span style="color: #DD0000">'unit'</span><span style="color: #007700">]);<br /><a name="l73" /><br /><a name="l74" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())&nbsp;return&nbsp;</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;update&nbsp;storage&nbsp;box&nbsp;values"</span><span style="color: #007700">;<br /><a name="l75" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;no&nbsp;errors<br /><a name="l76" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l77" /><br /><a name="l78" /><br /><a name="l79" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">all_in_storage_for_operator</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">)&nbsp;{<br /><a name="l80" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l81" /><br /><a name="l82" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$tickets&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l83" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;`storage_box`.`trans_id`<br /><a name="l84" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l85" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;`transactions`<br /><a name="l86" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;`transactions`.`trans_id`&nbsp;=&nbsp;`storage_box`.`trans_id`<br /><a name="l87" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;`authrecipients`<br /><a name="l88" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;`authrecipients`.`trans_id`&nbsp;=&nbsp;`storage_box`.`trans_id`<br /><a name="l89" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`transactions`.`operator`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$operator</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #DD0000">'<br /><a name="l90" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;`authrecipients`.`operator`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$operator</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #DD0000">'<br /><a name="l91" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;`storage_box`.`trans_id`&nbsp;ASC;"<br /><a name="l92" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l93" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())<br /><a name="l94" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">[]&nbsp;=&nbsp;new&nbsp;</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]);<br /><a name="l95" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">;<br /><a name="l96" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l97" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l98" /><br /><a name="l99" /><br /><a name="l100" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">edit_object_storage_information</span><span style="color: #007700">(</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">)&nbsp;{<br /><a name="l101" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">))&nbsp;return;<br /><a name="l102" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l103" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"staff"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">staff&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">[</span><span style="color: #DD0000">"staff"</span><span style="color: #007700">];<br /><a name="l104" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"box_id"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">box_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">[</span><span style="color: #DD0000">"box_id"</span><span style="color: #007700">];<br /><a name="l105" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"storage_start"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">storage_start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$change_array</span><span style="color: #007700">[</span><span style="color: #DD0000">"storage_start"</span><span style="color: #007700">];<br /><a name="l106" /><br /><a name="l107" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">update_storage_box</span><span style="color: #007700">();<br /><a name="l108" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l109" /><br /><a name="l110" /><br /><a name="l111" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">find_objects_in_storage_for_user</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">)&nbsp;{<br /><a name="l112" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">is_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$operator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">;<br /><a name="l113" /><br /><a name="l114" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$users_objects&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l115" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l116" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`transactions`.`trans_id`&nbsp;<br /><a name="l117" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`transactions`<br /><a name="l118" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;`authrecipients`&nbsp;<br /><a name="l119" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;`transactions`.`trans_id`&nbsp;=&nbsp;`authrecipients`.`trans_id`<br /><a name="l120" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`transactions`.`pickup_time`&nbsp;IS&nbsp;NULL<br /><a name="l121" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;(`transactions`.`operator`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$operator</span><span style="color: #DD0000">'&nbsp;OR&nbsp;`authrecipients`.`operator`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$operator</span><span style="color: #DD0000">');"<br /><a name="l122" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l123" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())&nbsp;</span><span style="color: #0000BB">$users_objects</span><span style="color: #007700">[]&nbsp;=&nbsp;new&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'trans_id'</span><span style="color: #007700">]);<br /><a name="l124" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$users_objects</span><span style="color: #007700">;<br /><a name="l125" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l126" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Unable&nbsp;to&nbsp;check&nbsp;results"</span><span style="color: #007700">;<br /><a name="l127" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l128" /><br /><a name="l129" /><br /><a name="l130" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;find&nbsp;the&nbsp;unit&nbsp;currently&nbsp;holding&nbsp;the&nbsp;sought&nbsp;object;&nbsp;return&nbsp;object&nbsp;of&nbsp;unit<br /><a name="l131" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_unit_for_trans_id</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l132" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l133" /><br /><a name="l134" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;`drawer`,&nbsp;`unit`<br /><a name="l135" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l136" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">'"<br /><a name="l137" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l138" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br /><a name="l139" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">[</span><span style="color: #DD0000">"drawer"</span><span style="color: #007700">].</span><span style="color: #0000BB">$results</span><span style="color: #007700">[</span><span style="color: #DD0000">"unit"</span><span style="color: #007700">];<br /><a name="l140" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l141" /><br /><a name="l142" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;reach&nbsp;database"</span><span style="color: #007700">;<br /><a name="l143" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l144" /><br /><a name="l145" /><br /><a name="l146" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">number_of_objects_in_storage</span><span style="color: #007700">()&nbsp;{<br /><a name="l147" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l148" /><br /><a name="l149" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;COUNT(`drawer`)&nbsp;as&nbsp;count<br /><a name="l150" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l151" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;IS&nbsp;NOT&nbsp;NULL;"<br /><a name="l152" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;return&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">()[</span><span style="color: #DD0000">"count"</span><span style="color: #007700">];<br /><a name="l153" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;get&nbsp;count"</span><span style="color: #007700">;<br /><a name="l154" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l155" /><br /><a name="l156" /><br /><a name="l157" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;boolean&nbsp;result&nbsp;of&nbsp;true&nbsp;if&nbsp;object&nbsp;is&nbsp;in&nbsp;storage,&nbsp;false&nbsp;if&nbsp;not;&nbsp;able&nbsp;to&nbsp;have&nbsp;obj&nbsp;in&nbsp;multiple&nbsp;storage&nbsp;boxes<br /><a name="l158" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">object_is_in_storage</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l159" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l160" /><br /><a name="l161" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`trans_id`<br /><a name="l162" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l163" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">';"<br /><a name="l164" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;return&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /><a name="l165" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l166" /><br /><a name="l167" /><br /><a name="l168" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">remove_object_from_storage</span><span style="color: #007700">(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l169" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l170" /><br /><a name="l171" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"UPDATE&nbsp;`storage_box`<br /><a name="l172" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;`trans_id`&nbsp;=&nbsp;NULL,&nbsp;`item_change_time`&nbsp;=&nbsp;CURRENT_TIMESTAMP,&nbsp;`staff_id`&nbsp;=&nbsp;?<br /><a name="l173" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;=&nbsp;?;"</span><span style="color: #007700">);<br /><a name="l174" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"sd"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">);<br /><a name="l175" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())&nbsp;return&nbsp;</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;update&nbsp;storage&nbsp;box&nbsp;values"</span><span style="color: #007700">;<br /><a name="l176" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l177" /><br /><a name="l178" /><br /><a name="l179" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">update_storage_box</span><span style="color: #007700">()&nbsp;{<br /><a name="l180" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l181" /><br /><a name="l182" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;update&nbsp;storage&nbsp;box&nbsp;info<br /><a name="l183" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"UPDATE&nbsp;`storage_box`<br /><a name="l184" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;`item_change_time`&nbsp;=&nbsp;?,&nbsp;`staff_id`&nbsp;=&nbsp;?<br /><a name="l185" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;=&nbsp;?;"</span><span style="color: #007700">);<br /><a name="l186" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"ssd"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">storage_start</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">staff</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">);<br /><a name="l187" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())&nbsp;return&nbsp;</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;update&nbsp;storage&nbsp;box&nbsp;values"</span><span style="color: #007700">;<br /><a name="l188" /><br /><a name="l189" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;no&nbsp;errors<br /><a name="l190" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l191" /><br /><a name="l192" /><br /><a name="l193" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;should&nbsp;be&nbsp;initiated&nbsp;before&nbsp;every&nbsp;StorageObject&nbsp;method&nbsp;call&nbsp;to&nbsp;identify&nbsp;person&nbsp;operating&nbsp;on&nbsp;object<br /><a name="l194" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">set_staff</span><span style="color: #007700">(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)&nbsp;{<br /><a name="l195" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">is_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">))&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l196" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">staff&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">;<br /><a name="l197" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /><a name="l198" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l199" />}<br /><a name="l200" /><br /><a name="l201" /><br /><a name="l202" /></span><span style="color: #FF8000">/*<br /><a name="l203" />Unit&nbsp;(drawer&nbsp;subsection)&nbsp;object&nbsp;to&nbsp;hold&nbsp;information&nbsp;about&nbsp;its&nbsp;location,&nbsp;size,&nbsp;start;<br /><a name="l204" />methods&nbsp;to&nbsp;operate&nbsp;on&nbsp;drawer&nbsp;units<br /><a name="l205" />*/<br /><a name="l206" /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">StorageUnit&nbsp;</span><span style="color: #007700">{<br /><a name="l207" /><br /><a name="l208" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;string&nbsp;for&nbsp;box&nbsp;unit&nbsp;&nbsp;(eg&nbsp;1A&nbsp;or&nbsp;C11)<br /><a name="l209" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$drawer_indicator</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;drawer&nbsp;or&nbsp;shelf&nbsp;letter&nbsp;or&nbsp;number<br /><a name="l210" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$unit_indicator</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;sub&nbsp;category&nbsp;inside&nbsp;the&nbsp;drawer<br /><a name="l211" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$start</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;subdivision&nbsp;start&nbsp;of&nbsp;drawer&nbsp;or&nbsp;shelf&nbsp;[rows,&nbsp;columns]<br /><a name="l212" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;subdivision&nbsp;end&nbsp;of&nbsp;drawer&nbsp;or&nbsp;shelf&nbsp;[rows,&nbsp;columns];&nbsp;<br /><a name="l213" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;indicates&nbsp;additional&nbsp;divisions,&nbsp;because&nbsp;a&nbsp;1x1&nbsp;unit's&nbsp;end&nbsp;==&nbsp;start&nbsp;(5-5&nbsp;minus&nbsp;5-5&nbsp;=&nbsp;0-0)<br /><a name="l214" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$span</span><span style="color: #007700">;&nbsp;&nbsp;<br /><a name="l215" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$contained_cells</span><span style="color: #007700">;<br /><a name="l216" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;trans_id&nbsp;of&nbsp;stored&nbsp;item<br /><a name="l217" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$item_change_time</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;date&nbsp;of&nbsp;when&nbsp;item&nbsp;was&nbsp;placed/stored&nbsp;in&nbsp;unit<br /><a name="l218" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;staff&nbsp;member&nbsp;to&nbsp;insert/remove&nbsp;item<br /><a name="l219" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$type</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;what&nbsp;the&nbsp;section&nbsp;label&nbsp;will&nbsp;be&nbsp;(eg&nbsp;small,&nbsp;large,&nbsp;glass,&nbsp;etc)<br /><a name="l220" /><br /><a name="l221" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l222" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l223" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">;<br /><a name="l224" /><br /><a name="l225" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;----&nbsp;get&nbsp;and&nbsp;sort&nbsp;data&nbsp;to&nbsp;populate&nbsp;fields&nbsp;----<br /><a name="l226" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">box_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">;<br /><a name="l227" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'strg_drwr_indicator'</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"numer"</span><span style="color: #007700">)&nbsp;{<br /><a name="l228" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_indicator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/[^0-9]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">);<br /><a name="l229" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'/[^a-zA-Z]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">);<br /><a name="l230" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l231" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l232" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_indicator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'/[^a-zA-Z]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">);<br /><a name="l233" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/[^0-9]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">);<br /><a name="l234" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l235" /><br /><a name="l236" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*<br /><a name="l237" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l238" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_indicator</span><span style="color: #DD0000">'<br /><a name="l239" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;`unit`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator</span><span style="color: #DD0000">';<br /><a name="l240" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span style="color: #007700">))&nbsp;{<br /><a name="l241" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br /><a name="l242" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br /><a name="l243" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_map</span><span style="color: #007700">(</span><span style="color: #DD0000">'intval'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'start'</span><span style="color: #007700">]));<br /><a name="l244" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_map</span><span style="color: #007700">(</span><span style="color: #DD0000">'intval'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'span'</span><span style="color: #007700">]));<br /><a name="l245" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'trans_id'</span><span style="color: #007700">];<br /><a name="l246" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">item_change_time&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'item_change_time'</span><span style="color: #007700">];<br /><a name="l247" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">staff&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'staff_id'</span><span style="color: #007700">];<br /><a name="l248" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">type&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'type'</span><span style="color: #007700">];<br /><a name="l249" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set_contained_cells</span><span style="color: #007700">();<br /><a name="l250" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l251" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l252" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l253" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;delete&nbsp;self&nbsp;cause&nbsp;it&nbsp;done&nbsp;messed&nbsp;up<br /><a name="l254" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l255" /><br /><a name="l256" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l257" /><br /><a name="l258" /><br /><a name="l259" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;return&nbsp;a&nbsp;HTML&nbsp;cell&nbsp;based&nbsp;on&nbsp;StorageUnit's&nbsp;attributes&nbsp;&amp;&nbsp;values&nbsp;passed;&nbsp;replace&nbsp;'_'&nbsp;with&nbsp;cell&nbsp;label<br /><a name="l260" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">)&nbsp;{<br /><a name="l261" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$colspan&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><a name="l262" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rowspan&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><a name="l263" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$width&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">$colspan</span><span style="color: #007700">;<br /><a name="l264" /><br /><a name="l265" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #DD0000">"id"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #DD0000">"id"</span><span style="color: #007700">]&nbsp;?&nbsp;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #DD0000">"id"</span><span style="color: #007700">]&nbsp;:&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator</span><span style="color: #007700">;<br /><a name="l266" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #DD0000">'label'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #DD0000">"label"</span><span style="color: #007700">]&nbsp;?&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #DD0000">"label"</span><span style="color: #007700">])&nbsp;:&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator</span><span style="color: #007700">;<br /><a name="l267" /><br /><a name="l268" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"&lt;td&nbsp;id='</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">id</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;class='</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">class</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;colspan='</span><span style="color: #0000BB">$colspan</span><span style="color: #DD0000">'&nbsp;rowspan='</span><span style="color: #0000BB">$rowspan</span><span style="color: #DD0000">'&nbsp;style='width:</span><span style="color: #007700">${</span><span style="color: #0000BB">width</span><span style="color: #007700">}</span><span style="color: #DD0000">px;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">style</span><span style="color: #007700">]</span><span style="color: #DD0000">'<br /><a name="l269" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onclick='</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">onclick</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;onmouseover='</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">onmouseover</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;onmouseout='</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">onmouseout</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;align='center'&gt;</span><span style="color: #0000BB">$td_values</span><span style="color: #007700">[</span><span style="color: #0000BB">label</span><span style="color: #007700">]</span><span style="color: #DD0000">&lt;/td&gt;"</span><span style="color: #007700">;<br /><a name="l270" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l271" /><br /><a name="l272" /><br /><a name="l273" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;add&nbsp;a&nbsp;new&nbsp;StorageUnit&nbsp;to&nbsp;DB<br /><a name="l274" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">create_new_partition</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$start</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$span</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br /><a name="l275" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$size</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">get_drawer_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l276" /><br /><a name="l277" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l278" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_unit_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$unit</span><span style="color: #007700">);<br /><a name="l279" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$size</span><span style="color: #007700">);<br /><a name="l280" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_unit_start</span><span style="color: #007700">(</span><span style="color: #0000BB">$start</span><span style="color: #007700">);<br /><a name="l281" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$span&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_unit_span</span><span style="color: #007700">(</span><span style="color: #0000BB">$span</span><span style="color: #007700">);<br /><a name="l282" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$type&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_unit_type</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br /><a name="l283" /><br /><a name="l284" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l285" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;`storage_box`&nbsp;(`drawer`,&nbsp;`unit`,&nbsp;`drawer_size`,&nbsp;`start`,&nbsp;`span`,&nbsp;`type`)&nbsp;VALUES&nbsp;<br /><a name="l286" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(?,&nbsp;?,&nbsp;?,&nbsp;?,&nbsp;?,&nbsp;?);"</span><span style="color: #007700">);<br /><a name="l287" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"ssssss"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$size</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$start</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$span</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br /><a name="l288" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /><a name="l289" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l290" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l291" /><br /><a name="l292" /><br /><a name="l293" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">currently_holds_an_item</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">)&nbsp;{<br /><a name="l294" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l295" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_unit_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$unit</span><span style="color: #007700">);<br /><a name="l296" /><br /><a name="l297" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l298" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*<br /><a name="l299" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l300" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;IS&nbsp;NOT&nbsp;NULL<br /><a name="l301" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">'<br /><a name="l302" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;`unit`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$unit</span><span style="color: #DD0000">';"<br /><a name="l303" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l304" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l305" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l306" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;could&nbsp;not&nbsp;query&nbsp;or&nbsp;size&nbsp;not&nbsp;0,&nbsp;so&nbsp;assume&nbsp;drawer&nbsp;holds&nbsp;item<br /><a name="l307" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l308" /><br /><a name="l309" /><br /><a name="l310" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">delete_unit</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">)&nbsp;{<br /><a name="l311" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l312" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_unit_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$unit</span><span style="color: #007700">);<br /><a name="l313" /><br /><a name="l314" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">currently_holds_an_item</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">))&nbsp;return&nbsp;</span><span style="color: #DD0000">"Cannot&nbsp;delete&nbsp;unit&nbsp;because&nbsp;unit&nbsp;is&nbsp;not&nbsp;empty"</span><span style="color: #007700">;<br /><a name="l315" /><br /><a name="l316" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$storage_box_DB_user</span><span style="color: #007700">;<br /><a name="l317" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$storage_box_DB_user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;`storage_box`<br /><a name="l318" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;?<br /><a name="l319" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;`unit`&nbsp;=&nbsp;?;"</span><span style="color: #007700">);<br /><a name="l320" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"ss"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">);<br /><a name="l321" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())&nbsp;return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /><a name="l322" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;delete&nbsp;unit"</span><span style="color: #007700">;<br /><a name="l323" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l324" /><br /><a name="l325" /><br /><a name="l326" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">position_is_a_part_of_unit</span><span style="color: #007700">(</span><span style="color: #0000BB">$position</span><span style="color: #007700">)&nbsp;{<br /><a name="l327" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;&lt;=&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;&lt;=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;&amp;&amp;<br /><a name="l328" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;&lt;=&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;&lt;=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]);<br /><a name="l329" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l330" /><br /><a name="l331" /><br /><a name="l332" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">starting_position_is_current_cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$position</span><span style="color: #007700">)&nbsp;{<br /><a name="l333" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$position&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">;<br /><a name="l334" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l335" /><br /><a name="l336" /><br /><a name="l337" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;get&nbsp;the&nbsp;different&nbsp;cells&nbsp;for&nbsp;a&nbsp;unit<br /><a name="l338" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">set_contained_cells</span><span style="color: #007700">()&nbsp;{<br /><a name="l339" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">++)&nbsp;{<br /><a name="l340" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">span</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">++)&nbsp;{<br /><a name="l341" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">contained_cells</span><span style="color: #007700">[]&nbsp;=&nbsp;array(</span><span style="color: #0000BB">$x</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">);<br /><a name="l342" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l343" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l344" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l345" /><br /><a name="l346" /><br /><a name="l347" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;query&nbsp;the&nbsp;different&nbsp;types&nbsp;of&nbsp;drawers&nbsp;currently&nbsp;in&nbsp;DB<br /><a name="l348" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">types</span><span style="color: #007700">()&nbsp;{<br /><a name="l349" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l350" /><br /><a name="l351" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$types&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l352" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`type`<br /><a name="l353" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l354" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP&nbsp;BY&nbsp;`type`;"<br /><a name="l355" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l356" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())<br /><a name="l357" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$types</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'type'</span><span style="color: #007700">];<br /><a name="l358" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$types</span><span style="color: #007700">;<br /><a name="l359" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l360" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /><a name="l361" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l362" /><br /><a name="l363" /><br /><a name="l364" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&nbsp;REGEX&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br /><a name="l365" /><br /><a name="l366" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">regex_unit_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">)&nbsp;{<br /><a name="l367" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br /><a name="l368" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l369" /><br /><a name="l370" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">regex_unit_span</span><span style="color: #007700">(</span><span style="color: #0000BB">$span</span><span style="color: #007700">)&nbsp;{<br /><a name="l371" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$span</span><span style="color: #007700">);<br /><a name="l372" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l373" /><br /><a name="l374" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">regex_unit_start</span><span style="color: #007700">(</span><span style="color: #0000BB">$start</span><span style="color: #007700">)&nbsp;{<br /><a name="l375" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$start</span><span style="color: #007700">);<br /><a name="l376" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l377" /><br /><a name="l378" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">regex_unit_type</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">)&nbsp;{<br /><a name="l379" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br /><a name="l380" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l381" /><br /><a name="l382" />}<br /><a name="l383" /><br /><a name="l384" /></span><span style="color: #FF8000">/***********************************************************************************************************<br /><a name="l385" />*&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l386" />*&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;of&nbsp;data&nbsp;for&nbsp;a&nbsp;drawer<br /><a name="l387" />*&nbsp;&nbsp;&nbsp;&nbsp;Takes&nbsp;in&nbsp;the&nbsp;drawer&nbsp;indicator&nbsp;and&nbsp;builds&nbsp;units&nbsp;based&nbsp;on&nbsp;query&nbsp;from&nbsp;it.&nbsp;&nbsp;Behaviors&nbsp;dictate<br /><a name="l388" />*&nbsp;&nbsp;&nbsp;&nbsp;appearance&nbsp;of&nbsp;unit&nbsp;cells&nbsp;when&nbsp;drawn&nbsp;to&nbsp;a&nbsp;table.&nbsp;&nbsp;Selected&nbsp;unit&nbsp;is&nbsp;the&nbsp;unit&nbsp;that&nbsp;the&nbsp;table&nbsp;<br /><a name="l389" />*&nbsp;&nbsp;&nbsp;&nbsp;highlights<br /><a name="l390" />*&nbsp;&nbsp;&nbsp;&nbsp;FUTURE:&nbsp;default&nbsp;behaviors<br /><a name="l391" />*<br /><a name="l392" />***********************************************************************************************************/<br /><a name="l393" /><br /><a name="l394" /><br /><a name="l395" /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">StorageDrawer&nbsp;</span><span style="color: #007700">{<br /><a name="l396" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$drawer_indicator</span><span style="color: #007700">;<br /><a name="l397" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$units&nbsp;</span><span style="color: #007700">=&nbsp;array();&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;OBJsâ€”StorageUnit:&nbsp;all&nbsp;units&nbsp;from&nbsp;DB&nbsp;(default&nbsp;&amp;&nbsp;selected_units)<br /><a name="l398" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$drawer_size</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;division&nbsp;for&nbsp;drawer&nbsp;or&nbsp;shelf&nbsp;[rows,&nbsp;columns]<br /><a name="l399" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$unit_behavior</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;array&nbsp;of&nbsp;key/values&nbsp;for&nbsp;display/function&nbsp;of&nbsp;drawer&nbsp;display:&nbsp;for&nbsp;units&nbsp;in&nbsp;DB<br /><a name="l400" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$empty_behavior</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;array&nbsp;of&nbsp;key/values&nbsp;for&nbsp;display/function&nbsp;of&nbsp;drawer&nbsp;display:&nbsp;for&nbsp;unallocated&nbsp;space<br /><a name="l401" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;item&nbsp;specific<br /><a name="l402" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;functionâ€”instructions&nbsp;of&nbsp;which&nbsp;units&nbsp;for&nbsp;drawer&nbsp;are&nbsp;desired<br /><a name="l403" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$selected_units&nbsp;</span><span style="color: #007700">=&nbsp;array();&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;OBJsâ€”StorageUnit:&nbsp;unit&nbsp;that&nbsp;is&nbsp;desired<br /><a name="l404" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$selected_unit_behavior</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;array&nbsp;of&nbsp;key/values&nbsp;for&nbsp;display/function&nbsp;of&nbsp;drawer&nbsp;display:&nbsp;for&nbsp;units&nbsp;that&nbsp;have&nbsp;matching&nbsp;trans_id<br /><a name="l405" /><br /><a name="l406" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit_behavior</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$empty_behavior</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$selected_unit_behavior</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br /><a name="l407" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_indicator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer_id</span><span style="color: #007700">);<br /><a name="l408" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">units&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">get_units_for_drawer</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_indicator</span><span style="color: #007700">);<br /><a name="l409" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_map</span><span style="color: #007700">(</span><span style="color: #DD0000">'intval'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">get_drawer_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_indicator</span><span style="color: #007700">)));<br /><a name="l410" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_behavior&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$unit_behavior</span><span style="color: #007700">;<br /><a name="l411" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">empty_behavior&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$empty_behavior</span><span style="color: #007700">;<br /><a name="l412" /><br /><a name="l413" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">select_unit_callback&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">;<br /><a name="l414" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">determine_selected_units</span><span style="color: #007700">();<br /><a name="l415" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selected_unit_behavior&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$selected_unit_behavior</span><span style="color: #007700">;<br /><a name="l416" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l417" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l418" /><br /><a name="l419" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*<br /><a name="l420" />&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;by&nbsp;HTML_display():&nbsp;creates&nbsp;the&nbsp;necessary&nbsp;cell&nbsp;data&nbsp;for&nbsp;the&nbsp;table&nbsp;that<br /><a name="l421" />&nbsp;&nbsp;&nbsp;&nbsp;displays&nbsp;the&nbsp;drawer<br /><a name="l422" />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><a name="l423" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">add_cell_to_table</span><span style="color: #007700">(</span><span style="color: #0000BB">$position</span><span style="color: #007700">)&nbsp;{<br /><a name="l424" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">units&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">)&nbsp;{<br /><a name="l425" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$unit</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">starting_position_is_current_cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$position</span><span style="color: #007700">))&nbsp;{<br /><a name="l426" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selected_units</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$unit</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selected_units</span><span style="color: #007700">))<br /><a name="l427" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selected_unit_behavior</span><span style="color: #007700">);<br /><a name="l428" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_behavior</span><span style="color: #007700">);<br /><a name="l429" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l430" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l431" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;if&nbsp;cell&nbsp;is&nbsp;a&nbsp;part&nbsp;of&nbsp;unit,&nbsp;but&nbsp;not&nbsp;start,&nbsp;do&nbsp;nothing<br /><a name="l432" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">units&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">)<br /><a name="l433" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$position</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">contained_cells</span><span style="color: #007700">))&nbsp;return;<br /><a name="l434" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;cell&nbsp;is&nbsp;not&nbsp;part&nbsp;of&nbsp;unit<br /><a name="l435" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unitless_cell</span><span style="color: #007700">(</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">'-'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">'-'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">));<br /><a name="l436" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l437" /><br /><a name="l438" /><br /><a name="l439" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;copy&nbsp;the&nbsp;drawer&nbsp;layout&nbsp;in&nbsp;the&nbsp;DB&nbsp;to&nbsp;a&nbsp;new&nbsp;drawer&nbsp;with&nbsp;the&nbsp;provided&nbsp;designator<br /><a name="l440" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">copy_drawer</span><span style="color: #007700">(</span><span style="color: #0000BB">$new_drawer_name</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$old_drawer_name</span><span style="color: #007700">)&nbsp;{<br /><a name="l441" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l442" /><br /><a name="l443" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$new_drawer_name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$new_drawer_name</span><span style="color: #007700">);<br /><a name="l444" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$old_drawer_name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$old_drawer_name</span><span style="color: #007700">);<br /><a name="l445" /><br /><a name="l446" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$new_drawer_name&nbsp;</span><span style="color: #007700">||&nbsp;!</span><span style="color: #0000BB">$old_drawer_name</span><span style="color: #007700">)&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l447" /><br /><a name="l448" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;`storage_box`&nbsp;(`drawer`,&nbsp;`unit`,&nbsp;`drawer_size`,&nbsp;`start`,&nbsp;`span`,&nbsp;`type`)<br /><a name="l449" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;?,&nbsp;`unit`,&nbsp;`drawer_size`,&nbsp;`start`,&nbsp;`span`,&nbsp;`type`&nbsp;<br /><a name="l450" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`&nbsp;<br /><a name="l451" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;?;"</span><span style="color: #007700">);<br /><a name="l452" /><br /><a name="l453" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"ss"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$new_drawer_name</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$old_drawer_name</span><span style="color: #007700">);<br /><a name="l454" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())<br /><a name="l455" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /><a name="l456" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l457" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l458" /><br /><a name="l459" /><br /><a name="l460" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">delete_drawer</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l461" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l462" /><br /><a name="l463" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">drawer_currently_holds_any_item</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">))&nbsp;return&nbsp;</span><span style="color: #DD0000">"Can&nbsp;not&nbsp;delete&nbsp;drawer&nbsp;because&nbsp;drawer&nbsp;is&nbsp;not&nbsp;empty"</span><span style="color: #007700">;<br /><a name="l464" /><br /><a name="l465" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$storage_box_DB_user</span><span style="color: #007700">;<br /><a name="l466" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$storage_box_DB_user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"DELETE&nbsp;FROM&nbsp;`storage_box`<br /><a name="l467" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;?;"</span><span style="color: #007700">);<br /><a name="l468" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"s"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l469" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$statement</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">())&nbsp;return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /><a name="l470" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;delete&nbsp;drawer"</span><span style="color: #007700">;<br /><a name="l471" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l472" /><br /><a name="l473" /><br /><a name="l474" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*<br /><a name="l475" />&nbsp;&nbsp;&nbsp;&nbsp;go&nbsp;through&nbsp;units&nbsp;in&nbsp;drawer&nbsp;and&nbsp;select&nbsp;unique&nbsp;drawers&nbsp;based&nbsp;on&nbsp;call&nbsp;back.&nbsp;&nbsp;Unique&nbsp;<br /><a name="l476" />&nbsp;&nbsp;&nbsp;&nbsp;drawers&nbsp;are&nbsp;added&nbsp;to&nbsp;a&nbsp;list&nbsp;where&nbsp;their&nbsp;attributes&nbsp;will&nbsp;be&nbsp;different&nbsp;based&nbsp;on&nbsp;<br /><a name="l477" />&nbsp;&nbsp;&nbsp;&nbsp;$selected_unit_behavior<br /><a name="l478" />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><a name="l479" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">determine_selected_units</span><span style="color: #007700">(</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br /><a name="l480" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$select_unit_callback&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$select_unit_callback&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">$select_unit_callback&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">select_unit_callback</span><span style="color: #007700">;<br /><a name="l481" /><br /><a name="l482" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">)&nbsp;return;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;nothing&nbsp;to&nbsp;call<br /><a name="l483" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selected_units&nbsp;</span><span style="color: #007700">=&nbsp;array();&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;clear&nbsp;previously&nbsp;selected&nbsp;units<br /><a name="l484" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">units&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">)&nbsp;{<br /><a name="l485" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">call_user_func</span><span style="color: #007700">(</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selected_units</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">;<br /><a name="l486" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l487" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l488" /><br /><a name="l489" /><br /><a name="l490" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;html&nbsp;button&nbsp;that&nbsp;displays&nbsp;table&nbsp;and&nbsp;highlights&nbsp;unit&nbsp;for&nbsp;unit<br /><a name="l491" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">display_tooltip</span><span style="color: #007700">(</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l492" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"&lt;button&nbsp;type='button'&nbsp;class='btn&nbsp;btn-default'&nbsp;data-toggle='tooltip'&nbsp;data-html='true'&nbsp;title=''&nbsp;data-original-title=\""</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">HTML_display</span><span style="color: #007700">().</span><span style="color: #DD0000">"\"&gt;<br /><a name="l493" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #DD0000"><br /><a name="l494" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/button&gt;"</span><span style="color: #007700">;<br /><a name="l495" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l496" /><br /><a name="l497" /><br /><a name="l498" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;dictionary&nbsp;of&nbsp;{"drawer"&nbsp;:&nbsp;drawer,&nbsp;"unit"&nbsp;:&nbsp;unit}&nbsp;from&nbsp;$box_id&nbsp;(eg&nbsp;4B&nbsp;or&nbsp;F17)<br /><a name="l499" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">drawer_and_unit_dict_from_combined_box_label</span><span style="color: #007700">(</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l500" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">;<br /><a name="l501" /><br /><a name="l502" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$dict&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'drawer'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'strg_drwr_indicator'</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"numer"&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/[^0-9]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">)&nbsp;:&nbsp;&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'/[^a-zA-Z]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">));<br /><a name="l503" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$dict</span><span style="color: #007700">[</span><span style="color: #DD0000">'unit'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'strg_drwr_indicator'</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"numer"&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'/[^a-zA-Z]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">)&nbsp;:&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/[^0-9]/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$box_id</span><span style="color: #007700">);<br /><a name="l504" /><br /><a name="l505" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$dict</span><span style="color: #007700">;<br /><a name="l506" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l507" /><br /><a name="l508" /><br /><a name="l509" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">drawer_currently_holds_any_item</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l510" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l511" /><br /><a name="l512" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l513" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*<br /><a name="l514" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l515" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`trans_id`&nbsp;IS&nbsp;NOT&nbsp;NULL<br /><a name="l516" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">';"<br /><a name="l517" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l518" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l519" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l520" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;could&nbsp;not&nbsp;query&nbsp;or&nbsp;size&nbsp;not&nbsp;0,&nbsp;so&nbsp;assume&nbsp;drawer&nbsp;holds&nbsp;item<br /><a name="l521" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l522" /><br /><a name="l523" /><br /><a name="l524" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;return&nbsp;boolean&nbsp;of&nbsp;if&nbsp;the&nbsp;input&nbsp;drawer&nbsp;exists<br /><a name="l525" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">drawer_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l526" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l527" /><br /><a name="l528" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l529" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*<br /><a name="l530" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l531" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">';"<br /><a name="l532" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l533" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /><a name="l534" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l535" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l536" /><br /><a name="l537" /><br /><a name="l538" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">drawer_units_labels</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l539" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l540" /><br /><a name="l541" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l542" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`unit`<br /><a name="l543" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l544" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">';"<br /><a name="l545" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l546" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit_indicators_for_drawer&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l547" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())<br /><a name="l548" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit_indicators_for_drawer</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'unit'</span><span style="color: #007700">];<br /><a name="l549" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$unit_indicators_for_drawer</span><span style="color: #007700">;<br /><a name="l550" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l551" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l552" /><br /><a name="l553" /><br /><a name="l554" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_all_drawers</span><span style="color: #007700">(</span><span style="color: #0000BB">$unit_behavior</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$empty_behavior</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$selected_unit_callback</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$selected_unit_behavior</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br /><a name="l555" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer_labels&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">::</span><span style="color: #0000BB">get_unique_drawers</span><span style="color: #007700">();<br /><a name="l556" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawers&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l557" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$drawer_labels&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$label</span><span style="color: #007700">)<br /><a name="l558" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawers</span><span style="color: #007700">[]&nbsp;=&nbsp;new&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">(</span><span style="color: #0000BB">$label</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$unit_behavior</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$empty_behavior</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$selected_unit_callback</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$selected_unit_behavior</span><span style="color: #007700">);<br /><a name="l559" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$drawers</span><span style="color: #007700">;<br /><a name="l560" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l561" /><br /><a name="l562" /><br /><a name="l563" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_a_drawer_and_unit_for_type</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">)&nbsp;{<br /><a name="l564" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l565" /><br /><a name="l566" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`drawer`,&nbsp;`unit`<br /><a name="l567" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l568" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`type`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$type</span><span style="color: #DD0000">'<br /><a name="l569" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;`trans_id`&nbsp;IS&nbsp;NULL<br /><a name="l570" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIMIT&nbsp;1;"<br /><a name="l571" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l572" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br /><a name="l573" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br /><a name="l574" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'drawer'</span><span style="color: #007700">];<br /><a name="l575" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit_indicator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'unit'</span><span style="color: #007700">];<br /><a name="l576" /><br /><a name="l577" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;might&nbsp;be&nbsp;good&nbsp;to&nbsp;pass&nbsp;these&nbsp;instead&nbsp;of&nbsp;hardcoding&nbsp;them<br /><a name="l578" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$basic_unit&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"style"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"background-color:#999999;border:solid;border-width:2px;"</span><span style="color: #007700">,&nbsp;<br /><a name="l579" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"onclick"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"alert(\"Incorrect&nbsp;box\");"</span><span style="color: #007700">);<br /><a name="l580" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$empty&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"style"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"background-color:#000000;color:#000000;border:solid&nbsp;black;border-width:2px;"</span><span style="color: #007700">);<br /><a name="l581" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$selected_behavior&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"style"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"background-color:#00FF00;border:solid&nbsp;black;border-width:2px;"</span><span style="color: #007700">,&nbsp;<br /><a name="l582" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"onclick"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"storage_selected(this,&nbsp;\"</span><span style="color: #0000BB">$drawer$unit_indicator</span><span style="color: #DD0000">\")"</span><span style="color: #007700">);<br /><a name="l583" /><br /><a name="l584" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$select_unit_callback&nbsp;</span><span style="color: #007700">=&nbsp;function(</span><span style="color: #0000BB">$drawer_unit</span><span style="color: #007700">)&nbsp;use&nbsp;(</span><span style="color: #0000BB">$unit_indicator</span><span style="color: #007700">)&nbsp;{return&nbsp;</span><span style="color: #0000BB">$drawer_unit</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit_indicator&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$unit_indicator</span><span style="color: #007700">;};<br /><a name="l585" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">StorageDrawer</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$basic_unit</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$empty</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$select_unit_callback</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$selected_behavior</span><span style="color: #007700">);<br /><a name="l586" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l587" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"There&nbsp;are&nbsp;no&nbsp;free&nbsp;slots&nbsp;for&nbsp;an&nbsp;object&nbsp;of&nbsp;that&nbsp;type"</span><span style="color: #007700">;<br /><a name="l588" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l589" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"Failed&nbsp;to&nbsp;search&nbsp;storage"</span><span style="color: #007700">;<br /><a name="l590" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l591" /><br /><a name="l592" /><br /><a name="l593" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_numeric_drawer_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l594" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l595" /><br /><a name="l596" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`drawer_size`&nbsp;<br /><a name="l597" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`&nbsp;<br /><a name="l598" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">'&nbsp;<br /><a name="l599" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP&nbsp;BY&nbsp;`drawer`;<br /><a name="l600" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span style="color: #007700">))&nbsp;{<br /><a name="l601" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">array_map</span><span style="color: #007700">(</span><span style="color: #DD0000">'intval'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">()[</span><span style="color: #DD0000">'drawer_size'</span><span style="color: #007700">]));<br /><a name="l602" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l603" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br /><a name="l604" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l605" /><br /><a name="l606" /><br /><a name="l607" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_drawer_containing_item</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">)&nbsp;{<br /><a name="l608" /><br /><a name="l609" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l610" /><br /><a name="l611" /><br /><a name="l612" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;return&nbsp;array&nbsp;of&nbsp;objects&nbsp;for&nbsp;all&nbsp;units&nbsp;with&nbsp;the&nbsp;desired&nbsp;row&nbsp;id<br /><a name="l613" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_units_for_drawer</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l614" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">);<br /><a name="l615" /><br /><a name="l616" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l617" /><br /><a name="l618" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$row_units&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l619" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`drawer`,&nbsp;`unit`<br /><a name="l620" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l621" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">';"<br /><a name="l622" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">))&nbsp;{<br /><a name="l623" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(</span><span style="color: #0000BB">$storage_unit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())<br /><a name="l624" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$row_units</span><span style="color: #007700">[]&nbsp;=&nbsp;new&nbsp;</span><span style="color: #0000BB">StorageUnit</span><span style="color: #007700">(</span><span style="color: #0000BB">$storage_unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'drawer'</span><span style="color: #007700">].</span><span style="color: #0000BB">$storage_unit</span><span style="color: #007700">[</span><span style="color: #DD0000">'unit'</span><span style="color: #007700">]);<br /><a name="l625" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l626" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$row_units</span><span style="color: #007700">;<br /><a name="l627" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l628" /><br /><a name="l629" /><br /><a name="l630" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_drawer_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">)&nbsp;{<br /><a name="l631" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l632" /><br /><a name="l633" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;`drawer_size`&nbsp;<br /><a name="l634" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`&nbsp;<br /><a name="l635" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`drawer`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$drawer</span><span style="color: #DD0000">'&nbsp;<br /><a name="l636" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP&nbsp;BY&nbsp;`drawer`;<br /><a name="l637" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span style="color: #007700">))&nbsp;{<br /><a name="l638" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">()[</span><span style="color: #DD0000">'drawer_size'</span><span style="color: #007700">];<br /><a name="l639" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l640" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br /><a name="l641" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l642" /><br /><a name="l643" /><br /><a name="l644" /><br /><a name="l645" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">get_unique_drawers</span><span style="color: #007700">(</span><span style="color: #0000BB">$type&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br /><a name="l646" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">;<br /><a name="l647" /><br /><a name="l648" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer_designations&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l649" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$type</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;DISTINCT&nbsp;`drawer`<br /><a name="l650" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l651" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;`type`&nbsp;=&nbsp;'</span><span style="color: #0000BB">$type</span><span style="color: #DD0000">';"</span><span style="color: #007700">);<br /><a name="l652" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;DISTINCT&nbsp;`drawer`<br /><a name="l653" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;`storage_box`<br /><a name="l654" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;CAST(`drawer`&nbsp;AS&nbsp;unsigned);"</span><span style="color: #007700">);<br /><a name="l655" /><br /><a name="l656" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$results</span><span style="color: #007700">)&nbsp;{<br /><a name="l657" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())&nbsp;{<br /><a name="l658" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$drawer_designations</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">[</span><span style="color: #DD0000">'drawer'</span><span style="color: #007700">];<br /><a name="l659" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l660" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$drawer_designations</span><span style="color: #007700">;<br /><a name="l661" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l662" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array(</span><span style="color: #DD0000">"Could&nbsp;not&nbsp;get&nbsp;drawer&nbsp;information"</span><span style="color: #007700">);<br /><a name="l663" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l664" /><br /><a name="l665" /><br /><a name="l666" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;create&nbsp;HTML&nbsp;table&nbsp;to&nbsp;display&nbsp;drawer&nbsp;in&nbsp;accordance&nbsp;to&nbsp;set&nbsp;behaviors<br /><a name="l667" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">HTML_display</span><span style="color: #007700">()&nbsp;{<br /><a name="l668" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$max_width&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_size</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br /><a name="l669" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$table&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"&lt;table&nbsp;style='max-width:</span><span style="color: #007700">${</span><span style="color: #0000BB">max_width</span><span style="color: #007700">}</span><span style="color: #DD0000">px;'&gt;&nbsp;"</span><span style="color: #007700">;<br /><a name="l670" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_size</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">++)&nbsp;{<br /><a name="l671" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"&nbsp;&lt;tr&nbsp;style='height:50px;'&gt;&nbsp;"</span><span style="color: #007700">;<br /><a name="l672" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_size</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">++)<br /><a name="l673" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add_cell_to_table</span><span style="color: #007700">(array(</span><span style="color: #0000BB">$x</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">));<br /><a name="l674" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$table&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;/tr&gt;"</span><span style="color: #007700">;<br /><a name="l675" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l676" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$table&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"<br /><a name="l677" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&nbsp;<br /><a name="l678" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;colspan='"</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">drawer_size</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">].</span><span style="color: #DD0000">"'&nbsp;align=CENTER&nbsp;style='font-size:1.5em'&gt;<br /><a name="l679" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style='text-decoration:overline'&gt;&lt;strong&gt;Drawer&nbsp;Front&lt;/strong&gt;&lt;/span&gt;<br /><a name="l680" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;&nbsp;<br /><a name="l681" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&nbsp;<br /><a name="l682" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;"</span><span style="color: #007700">;<br /><a name="l683" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$table</span><span style="color: #007700">;<br /><a name="l684" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l685" /><br /><a name="l686" /><br /><a name="l687" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">no_unit_is_using_cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$drawer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$position</span><span style="color: #007700">)&nbsp;{<br /><a name="l688" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$drawer&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$unit</span><span style="color: #007700">)&nbsp;{<br /><a name="l689" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$unit</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">position_is_a_part_of_unit</span><span style="color: #007700">(</span><span style="color: #0000BB">$position</span><span style="color: #007700">))&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><a name="l690" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l691" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /><a name="l692" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l693" /><br /><a name="l694" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*<br /><a name="l695" />&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;by&nbsp;add_cell_to_table():&nbsp;creates&nbsp;a&nbsp;cell&nbsp;for&nbsp;the&nbsp;matrix&nbsp;of&nbsp;a&nbsp;drawer&nbsp;that&nbsp;is&nbsp;not&nbsp;stated&nbsp;in&nbsp;<br /><a name="l696" />&nbsp;&nbsp;&nbsp;&nbsp;DB<br /><a name="l697" />&nbsp;&nbsp;&nbsp;&nbsp;eg&nbsp;in&nbsp;a&nbsp;5x5&nbsp;matrix&nbsp;if&nbsp;only&nbsp;20&nbsp;of&nbsp;the&nbsp;cells&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;DB,&nbsp;this&nbsp;function&nbsp;will&nbsp;handle&nbsp;the&nbsp;<br /><a name="l698" />&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;5<br /><a name="l699" />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><a name="l700" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">unitless_cell</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$label</span><span style="color: #007700">)&nbsp;{<br /><a name="l701" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$attrs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">empty_behavior</span><span style="color: #007700">;<br /><a name="l702" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"&lt;td&nbsp;id='</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">'&nbsp;class='</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #0000BB">class</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;style='width:50px;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #0000BB">style</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;onclick='</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #0000BB">onclick</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;<br /><a name="l703" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onmouseover='</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #0000BB">onmouseover</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;onmouseout='</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #0000BB">onmouseout</span><span style="color: #007700">]</span><span style="color: #DD0000">'&nbsp;align='center'&gt;</span><span style="color: #0000BB">$label</span><span style="color: #DD0000">&lt;/td&gt;"</span><span style="color: #007700">;<br /><a name="l704" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l705" /><br /><a name="l706" /><br /><a name="l707" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&nbsp;REGEX&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br /><a name="l708" /><br /><a name="l709" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">regex_drawer_indicator</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)&nbsp;{<br /><a name="l710" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br /><a name="l711" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l712" /><br /><a name="l713" />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">regex_drawer_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$size</span><span style="color: #007700">)&nbsp;{<br /><a name="l714" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$size</span><span style="color: #007700">);<br /><a name="l715" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l716" />}<br /><a name="l717" /><br /><a name="l718" /><br /><a name="l719" /></span><span style="color: #0000BB">?&gt;</span>
</span>