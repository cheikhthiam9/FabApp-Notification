<span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><a name="l1" /><br /><a name="l2" /></span><span style="color: #FF8000">/***********************************************************************************************************<br /><a name="l3" />*&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l4" />*&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;Jon&nbsp;Le<br /><a name="l5" />*&nbsp;&nbsp;&nbsp;&nbsp;Edited&nbsp;by:&nbsp;MPZinke&nbsp;on&nbsp;07.25.19&nbsp;to&nbsp;allow&nbsp;for&nbsp;multiple&nbsp;material&nbsp;assigning&nbsp;to&nbsp;ticket.&nbsp;Improve&nbsp;<br /><a name="l6" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commenting&nbsp;an&nbsp;logic/functionality&nbsp;of&nbsp;page;&nbsp;update&nbsp;in&nbsp;accord&nbsp;with&nbsp;class&nbsp;&amp;&nbsp;material&nbsp;<br /><a name="l7" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changes<br /><a name="l8" />*&nbsp;&nbsp;&nbsp;&nbsp;CC&nbsp;BY-NC-AS&nbsp;UTA&nbsp;FabLab&nbsp;2016-2019<br /><a name="l9" />*&nbsp;&nbsp;&nbsp;&nbsp;FabApp&nbsp;V&nbsp;0.94<br /><a name="l10" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Multiple&nbsp;Materials<br /><a name="l11" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Off-line&nbsp;Mode<br /><a name="l12" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Sheet&nbsp;Goods<br /><a name="l13" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Storage&nbsp;Box<br /><a name="l14" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-House&nbsp;Keeping&nbsp;(DB&nbsp;cleanup,&nbsp;$status&nbsp;variable,&nbsp;class&nbsp;syntax)<br /><a name="l15" />*<br /><a name="l16" />*&nbsp;&nbsp;&nbsp;&nbsp;FUNCTION:&nbsp;Create&nbsp;transaction&nbsp;for&nbsp;device,&nbsp;operator&nbsp;&amp;&nbsp;possible&nbsp;information.<br /><a name="l17" />*&nbsp;&nbsp;&nbsp;&nbsp;DESCRIPTION/PROCESS:&nbsp;-Check&nbsp;if&nbsp;staff&nbsp;logged&nbsp;in:&nbsp;!&nbsp;-&gt;&nbsp;go&nbsp;to&nbsp;home<br /><a name="l18" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-GET&nbsp;device&nbsp;ID&nbsp;&amp;&nbsp;create&nbsp;device&nbsp;OBJ.<br /><a name="l19" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Echo&nbsp;to&nbsp;page&nbsp;HTML&nbsp;including&nbsp;device-&gt;-&gt;required_materials&nbsp;tags.&nbsp;&nbsp;If&nbsp;device&nbsp;is&nbsp;prepaid,&nbsp;<br /><a name="l20" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;quantitiy&nbsp;inputs&nbsp;&amp;&nbsp;adjust&nbsp;to&nbsp;whether&nbsp;material&nbsp;is&nbsp;time.<br /><a name="l21" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Echo&nbsp;device-&gt;-&gt;optional_materials&nbsp;as&nbsp;options.&nbsp;JS&nbsp;handles&nbsp;tag&nbsp;creation&nbsp;including&nbsp;<br /><a name="l22" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;tag&nbsp;has&nbsp;a&nbsp;quantity&nbsp;input&nbsp;&amp;&nbsp;what&nbsp;type.&nbsp;&nbsp;Time&nbsp;quantities&nbsp;are&nbsp;not&nbsp;required&nbsp;to&nbsp;match<br /><a name="l23" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;the&nbsp;ticket&nbsp;can&nbsp;split&nbsp;time&nbsp;into&nbsp;multiple&nbsp;categories,&nbsp;however&nbsp;the&nbsp;minTime&nbsp;is&nbsp;set&nbsp;for<br /><a name="l24" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each&nbsp;of&nbsp;them&nbsp;individually.<br /><a name="l25" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-JS&nbsp;checks&nbsp;for&nbsp;Operator&nbsp;ID&nbsp;&amp;&nbsp;Purpose.<br /><a name="l26" />*&nbsp;&nbsp;&nbsp;&nbsp;-Backend&nbsp;calls&nbsp;a&nbsp;function&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;ticket&nbsp;type&nbsp;which&nbsp;pulls&nbsp;required&nbsp;&amp;&nbsp;optional&nbsp;<br /><a name="l27" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;through&nbsp;get_tags(.)&nbsp;function&nbsp;&amp;&nbsp;checks&nbsp;that&nbsp;the&nbsp;number&nbsp;of&nbsp;pulled&nbsp;required&nbsp;<br /><a name="l28" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;materials&nbsp;equals&nbsp;listed&nbsp;required.&nbsp;&nbsp;This&nbsp;pulls&nbsp;from&nbsp;the&nbsp;array&nbsp;of&nbsp;tags&nbsp;passed&nbsp;to&nbsp;<br /><a name="l29" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it.<br /><a name="l30" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-The&nbsp;two&nbsp;arrays&nbsp;are&nbsp;then&nbsp;combined&nbsp;and&nbsp;have&nbsp;keys&nbsp;renamed&nbsp;to&nbsp;a&nbsp;consolidated&nbsp;form.<br /><a name="l31" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-A&nbsp;transaction&nbsp;is&nbsp;created&nbsp;in&nbsp;DB&nbsp;and&nbsp;materials&nbsp;are&nbsp;assign&nbsp;(if&nbsp;any).<br /><a name="l32" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-User&nbsp;is&nbsp;redirected&nbsp;to&nbsp;next&nbsp;step&nbsp;(page)&nbsp;in&nbsp;process.<br /><a name="l33" />*<br /><a name="l34" />*&nbsp;&nbsp;&nbsp;&nbsp;FUTURE:&nbsp;Add&nbsp;ability&nbsp;to&nbsp;preselect&nbsp;where&nbsp;the&nbsp;object&nbsp;will&nbsp;go&nbsp;if&nbsp;storable<br /><a name="l35" />*&nbsp;&nbsp;&nbsp;&nbsp;QUESTIONS:&nbsp;Do&nbsp;we&nbsp;still&nbsp;care&nbsp;about&nbsp;est_time?<br /><a name="l36" />*<br /><a name="l37" />***********************************************************************************************************/<br /><a name="l38" /><br /><a name="l39" /><br /><a name="l40" /></span><span style="color: #007700">require_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">'/pages/header.php'</span><span style="color: #007700">);<br /><a name="l41" />require_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">'/api/gatekeeper.php'</span><span style="color: #007700">);<br /><a name="l42" /><br /><a name="l43" /></span><span style="color: #FF8000">//&nbsp;restrict&nbsp;page&nbsp;to&nbsp;staff<br /><a name="l44" /></span><span style="color: #007700">if(!</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)&nbsp;{<br /><a name="l45" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'error_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"Please&nbsp;log&nbsp;in"</span><span style="color: #007700">;<br /><a name="l46" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:/index.php"</span><span style="color: #007700">);<br /><a name="l47" />}<br /><a name="l48" />elseif(</span><span style="color: #0000BB">$staff&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getRoleID</span><span style="color: #007700">()&nbsp;&lt;&nbsp;</span><span style="color: #0000BB">$role</span><span style="color: #007700">[</span><span style="color: #DD0000">'staff'</span><span style="color: #007700">])&nbsp;{<br /><a name="l49" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'error_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"Please&nbsp;ask&nbsp;a&nbsp;staff&nbsp;member&nbsp;for&nbsp;assistance"</span><span style="color: #007700">;<br /><a name="l50" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:/index.php"</span><span style="color: #007700">);<br /><a name="l51" />}<br /><a name="l52" /><br /><a name="l53" /></span><span style="color: #FF8000">//&nbsp;Check&nbsp;Device&nbsp;ID<br /><a name="l54" /></span><span style="color: #007700">if(!isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"d_id"</span><span style="color: #007700">])&nbsp;||&nbsp;!</span><span style="color: #0000BB">Devices</span><span style="color: #007700">::</span><span style="color: #0000BB">regexDeviceID</span><span style="color: #007700">(</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_GET</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'d_id'</span><span style="color: #007700">)))&nbsp;{&nbsp;&nbsp;</span><span style="color: #FF8000">//REMOVE&nbsp;WITH&nbsp;UPDATE<br /><a name="l55" />//&nbsp;if(!isset($_GET["device_id"])&nbsp;||&nbsp;!Devices::regexDeviceID(filter_input(INPUT_GET,'device_id')))&nbsp;{&nbsp;&nbsp;//ADD&nbsp;WITH&nbsp;UPDATE<br /><a name="l56" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Device&nbsp;ID&nbsp;is&nbsp;missing&nbsp;or&nbsp;invalid"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"/index.php"</span><span style="color: #007700">);<br /><a name="l57" />}<br /><a name="l58" /><br /><a name="l59" /></span><span style="color: #0000BB">$device_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_GET</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"d_id"</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//REMOVE&nbsp;WITH&nbsp;UPDATE<br /><a name="l60" />//&nbsp;$device_id&nbsp;=&nbsp;filter_input(INPUT_GET,'device_id');&nbsp;&nbsp;//ADD&nbsp;WITH&nbsp;UPDATE<br /><a name="l61" /></span><span style="color: #0000BB">$device&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Devices</span><span style="color: #007700">(</span><span style="color: #0000BB">$device_id</span><span style="color: #007700">);<br /><a name="l62" /><br /><a name="l63" /></span><span style="color: #FF8000">//TODO:&nbsp;check&nbsp;that&nbsp;device&nbsp;is&nbsp;not&nbsp;in&nbsp;use<br /><a name="l64" /><br /><a name="l65" />//&nbsp;convert&nbsp;the&nbsp;time&nbsp;limit&nbsp;of&nbsp;a&nbsp;device&nbsp;to&nbsp;decimal&nbsp;form<br /><a name="l66" /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">time_limit</span><span style="color: #007700">)&nbsp;{<br /><a name="l67" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$timeArry&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">':'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">time_limit</span><span style="color: #007700">);<br /><a name="l68" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$lime_limit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$timeArry</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;+&nbsp;</span><span style="color: #0000BB">$timeArry</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;/&nbsp;</span><span style="color: #0000BB">60</span><span style="color: #007700">;<br /><a name="l69" />}<br /><a name="l70" /><br /><a name="l71" /><br /><a name="l72" /><br /><a name="l73" />if&nbsp;(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">Users</span><span style="color: #007700">::</span><span style="color: #0000BB">regexUser</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">]))<br /><a name="l74" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$operator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Users</span><span style="color: #007700">::</span><span style="color: #0000BB">withID</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'operator'</span><span style="color: #007700">]);<br /><a name="l75" /><br /><a name="l76" /></span><span style="color: #FF8000">//&nbsp;create&nbsp;ticket&nbsp;creation<br /><a name="l77" /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REQUEST_METHOD"</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"POST"&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;isset(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'ticketBtn'</span><span style="color: #007700">]))&nbsp;{<br /><a name="l78" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//set&nbsp;status&nbsp;id&nbsp;to&nbsp;"Powered&nbsp;On"<br /><a name="l79" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$status_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /><a name="l80" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l81" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//Call&nbsp;Gatekeeper&nbsp;to&nbsp;regex&nbsp;UTAID&nbsp;and&nbsp;validate&nbsp;if&nbsp;User&nbsp;is&nbsp;authorized<br /><a name="l82" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">gatekeeper</span><span style="color: #007700">(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_id</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">$gk_msg</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]&nbsp;=&nbsp;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br /><a name="l83" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l84" />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$gk_msg</span><span style="color: #007700">[</span><span style="color: #DD0000">"authorized"</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"N"</span><span style="color: #007700">)<br /><a name="l85" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Status&nbsp;Code:"</span><span style="color: #007700">.</span><span style="color: #0000BB">$gk_msg</span><span style="color: #007700">[</span><span style="color: #DD0000">"status_id"</span><span style="color: #007700">].</span><span style="color: #DD0000">"&nbsp;-&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$gk_msg</span><span style="color: #007700">[</span><span style="color: #DD0000">"ERROR"</span><span style="color: #007700">]);<br /><a name="l86" />&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l87" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$status_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$gk_msg</span><span style="color: #007700">[</span><span style="color: #DD0000">'status_id'</span><span style="color: #007700">];<br /><a name="l88" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$operator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Users</span><span style="color: #007700">::</span><span style="color: #0000BB">withID</span><span style="color: #007700">(</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'operator'</span><span style="color: #007700">));<br /><a name="l89" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l90" /><br /><a name="l91" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l92" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;purpose<br /><a name="l93" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$p_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'p_id'</span><span style="color: #007700">);<br /><a name="l94" />&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">Purpose</span><span style="color: #007700">::</span><span style="color: #0000BB">regexID</span><span style="color: #007700">(</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Invalid&nbsp;Purpose&nbsp;Code&nbsp;:&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l95" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l96" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;start&nbsp;ticket<br /><a name="l97" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_pay_first</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">pay_first_ticket</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">);<br /><a name="l98" />&nbsp;&nbsp;&nbsp;&nbsp;elseif(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_select_mats_first</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">select_materials_first_ticket</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">);<br /><a name="l99" />&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">ticket_without_materials</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">);<br /><a name="l100" /><br /><a name="l101" />}<br /><a name="l102" /><br /><a name="l103" /><br /><a name="l104" /></span><span style="color: #FF8000">//&nbsp;ticket&nbsp;requires&nbsp;payment&nbsp;beforehand;&nbsp;pass&nbsp;details&nbsp;and&nbsp;move&nbsp;to&nbsp;pay.php<br /><a name="l105" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">pay_first_ticket</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)&nbsp;{<br /><a name="l106" />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">;<br /><a name="l107" /><br /><a name="l108" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$required&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_tags</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"required"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"required-amount"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"required-hour"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"required-minute"</span><span style="color: #007700">));&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;get&nbsp;material&nbsp;amounts&nbsp;&amp;&nbsp;IDs<br /><a name="l109" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$required</span><span style="color: #007700">)&nbsp;!=&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">required_materials</span><span style="color: #007700">))&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;check&nbsp;for&nbsp;inconsistency&nbsp;in&nbsp;required&nbsp;vs&nbsp;gathered<br /><a name="l110" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Problem&nbsp;retrieving&nbsp;material&nbsp;quantities&nbsp;for&nbsp;DB&nbsp;storing"</span><span style="color: #007700">);<br /><a name="l111" /><br /><a name="l112" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;add&nbsp;arrays&nbsp;together&nbsp;and&nbsp;switch&nbsp;keys&nbsp;to&nbsp;a&nbsp;ubiquitious&nbsp;name<br /><a name="l113" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$optional&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_tags</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"optional"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"optional-amount"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"optional-hour"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"optional-minute"</span><span style="color: #007700">));<br /><a name="l114" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">combine_arrays_and_consolidate_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$optional</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$required</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;replace&nbsp;'required'&nbsp;in&nbsp;key&nbsp;with&nbsp;material<br /><a name="l115" /><br /><a name="l116" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;contains&nbsp;valid&nbsp;quanities&nbsp;&amp;&nbsp;IDs<br /><a name="l117" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">)&nbsp;<br /><a name="l118" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">"amount"</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;!</span><span style="color: #0000BB">Mats_Used</span><span style="color: #007700">::</span><span style="color: #0000BB">regexQuantity</span><span style="color: #007700">(</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">"amount"</span><span style="color: #007700">]))&nbsp;||&nbsp;!</span><span style="color: #0000BB">Materials</span><span style="color: #007700">::</span><span style="color: #0000BB">regexID</span><span style="color: #007700">(</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">"m_id"</span><span style="color: #007700">]))<br /><a name="l119" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_errro</span><span style="color: #007700">(</span><span style="color: #DD0000">"Invalid&nbsp;material&nbsp;quantity–</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #0000BB">amount</span><span style="color: #007700">]</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l120" /><br /><a name="l121" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;create&nbsp;new&nbsp;transaction<br /><a name="l122" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$trans_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">::</span><span style="color: #0000BB">insert_new_transaction</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'active'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">);<br /><a name="l123" />&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">is_int</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">))<br /><a name="l124" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Can&nbsp;not&nbsp;create&nbsp;a&nbsp;new&nbsp;ticket–</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l125" /><br /><a name="l126" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;create&nbsp;new&nbsp;mats_used&nbsp;instance&nbsp;for&nbsp;material<br /><a name="l127" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">)<br /><a name="l128" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">is_int</span><span style="color: #007700">(</span><span style="color: #0000BB">$mu_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Mats_Used</span><span style="color: #007700">::</span><span style="color: #0000BB">insert_material_used</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">"m_id"</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"used"</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">"amount"</span><span style="color: #007700">])))<br /><a name="l129" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Problem&nbsp;associating&nbsp;materials&nbsp;to&nbsp;ticket–</span><span style="color: #0000BB">$mu_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l130" /><br /><a name="l131" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:pay.php?trans_id=</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l132" />}<br /><a name="l133" /><br /><a name="l134" /><br /><a name="l135" /></span><span style="color: #FF8000">//&nbsp;new&nbsp;transaction:&nbsp;no&nbsp;materials;&nbsp;no&nbsp;initial&nbsp;payment<br /><a name="l136" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">ticket_without_materials</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)&nbsp;{<br /><a name="l137" />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">;<br /><a name="l138" /><br /><a name="l139" />&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">is_int</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">::</span><span style="color: #0000BB">insert_new_transaction</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'active'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)))<br /><a name="l140" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Can&nbsp;not&nbsp;create&nbsp;a&nbsp;new&nbsp;ticket–</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l141" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:lookup.php?trans_id=</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;trans_id&nbsp;is&nbsp;not&nbsp;error&nbsp;message;&nbsp;proceed&nbsp;to&nbsp;next&nbsp;part<br /><a name="l142" /></span><span style="color: #007700">}<br /><a name="l143" /><br /><a name="l144" /><br /><a name="l145" /></span><span style="color: #FF8000">//&nbsp;start&nbsp;a&nbsp;ticket&nbsp;with&nbsp;materials&nbsp;chosen&nbsp;first<br /><a name="l146" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">select_materials_first_ticket</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)&nbsp;{<br /><a name="l147" />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">;<br /><a name="l148" /><br /><a name="l149" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$required&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_tags</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"required"</span><span style="color: #007700">));<br /><a name="l150" />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$required</span><span style="color: #007700">)&nbsp;!=&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">required_materials</span><span style="color: #007700">))<br /><a name="l151" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Problem&nbsp;retrieving&nbsp;material&nbsp;quantities&nbsp;for&nbsp;DB&nbsp;storing"</span><span style="color: #007700">);<br /><a name="l152" /><br /><a name="l153" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$optional&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_tags</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"optional"</span><span style="color: #007700">));<br /><a name="l154" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">combine_arrays_and_consolidate_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$required</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$optional</span><span style="color: #007700">);<br /><a name="l155" /><br /><a name="l156" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;contains&nbsp;valid&nbsp;m_id's<br /><a name="l157" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">)<br /><a name="l158" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">Materials</span><span style="color: #007700">::</span><span style="color: #0000BB">regexID</span><span style="color: #007700">(</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">'m_id'</span><span style="color: #007700">]))<br /><a name="l159" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Problem&nbsp;reading&nbsp;material&nbsp;id–</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #0000BB">m_id</span><span style="color: #007700">]</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l160" /><br /><a name="l161" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;create&nbsp;new&nbsp;transaction<br /><a name="l162" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">is_int</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">::</span><span style="color: #0000BB">insert_new_transaction</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$p_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'active'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)))<br /><a name="l163" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Can&nbsp;not&nbsp;create&nbsp;a&nbsp;new&nbsp;ticket–</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l164" /><br /><a name="l165" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;create&nbsp;new&nbsp;mats_used&nbsp;instance&nbsp;for&nbsp;material<br /><a name="l166" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">)<br /><a name="l167" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">is_int</span><span style="color: #007700">(</span><span style="color: #0000BB">$mu_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Mats_Used</span><span style="color: #007700">::</span><span style="color: #0000BB">insert_material_used</span><span style="color: #007700">(</span><span style="color: #0000BB">$trans_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">'m_id'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$staff</span><span style="color: #007700">)))<br /><a name="l168" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Problem&nbsp;associating&nbsp;materials&nbsp;to&nbsp;ticket–</span><span style="color: #0000BB">$mu_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l169" /><br /><a name="l170" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:lookup.php?trans_id=</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l171" />}<br /><a name="l172" /><br /><a name="l173" /><br /><a name="l174" /></span><span style="color: #FF8000">//&nbsp;———————————————&nbsp;VALUES&nbsp;FROM&nbsp;FORM&nbsp;———————————————<br /><a name="l175" /><br /><a name="l176" />//&nbsp;pulls&nbsp;upto&nbsp;100&nbsp;tags&nbsp;(custom&nbsp;material&nbsp;display&nbsp;divs&nbsp;in&nbsp;selected&nbsp;materials)<br /><a name="l177" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">get_tags</span><span style="color: #007700">(</span><span style="color: #0000BB">$tags</span><span style="color: #007700">)&nbsp;{<br /><a name="l178" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$count&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><a name="l179" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$values&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l180" /><br /><a name="l181" />&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;{<br /><a name="l182" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;array();&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;temp&nbsp;array&nbsp;to&nbsp;hold&nbsp;gotten&nbsp;tags&nbsp;&amp;&nbsp;be&nbsp;added&nbsp;to&nbsp;$values<br /><a name="l183" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tags&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$attribute</span><span style="color: #007700">)<br /><a name="l184" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$var</span><span style="color: #007700">[</span><span style="color: #0000BB">$attribute</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">floatval</span><span style="color: #007700">(</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$attribute</span><span style="color: #007700">.</span><span style="color: #DD0000">'-'</span><span style="color: #007700">.</span><span style="color: #0000BB">$count</span><span style="color: #007700">));<br /><a name="l185" /><br /><a name="l186" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$var</span><span style="color: #007700">[</span><span style="color: #0000BB">$tags</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]])&nbsp;</span><span style="color: #0000BB">$values</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$var</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;add&nbsp;value&nbsp;to&nbsp;list&nbsp;if&nbsp;not&nbsp;null<br /><a name="l187" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;while(</span><span style="color: #0000BB">$var</span><span style="color: #007700">[</span><span style="color: #0000BB">$tags</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]]&nbsp;&amp;&amp;&nbsp;++</span><span style="color: #0000BB">$count&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;stop&nbsp;if&nbsp;!value,&nbsp;terminate&nbsp;value,&nbsp;or&nbsp;gone&nbsp;too&nbsp;long<br /><a name="l188" /><br /><a name="l189" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$values</span><span style="color: #007700">;<br /><a name="l190" />}<br /><a name="l191" /><br /><a name="l192" /><br /><a name="l193" /></span><span style="color: #FF8000">//&nbsp;combine&nbsp;$optional&nbsp;&amp;&nbsp;$required&nbsp;materials;&nbsp;rewrite&nbsp;to&nbsp;array&nbsp;with&nbsp;new&nbsp;einheitliche&nbsp;keys<br /><a name="l194" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">combine_arrays_and_consolidate_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$optional</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$required</span><span style="color: #007700">)&nbsp;{<br /><a name="l195" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l196" /><br /><a name="l197" />&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">array_merge</span><span style="color: #007700">(</span><span style="color: #0000BB">$optional</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$required</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">)&nbsp;{<br /><a name="l198" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$temp&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l199" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;check&nbsp;keys&nbsp;for&nbsp;correct&nbsp;key&nbsp;prefix<br /><a name="l200" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$prefix&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"required"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">)&nbsp;?&nbsp;</span><span style="color: #DD0000">"required"&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"optional"</span><span style="color: #007700">;<br /><a name="l201" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$temp</span><span style="color: #007700">[</span><span style="color: #DD0000">"m_id"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">"</span><span style="color: #007700">];<br /><a name="l202" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">-hour"</span><span style="color: #007700">]&nbsp;||&nbsp;</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">-minute"</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;!</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">-amount"</span><span style="color: #007700">])<br /><a name="l203" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$temp</span><span style="color: #007700">[</span><span style="color: #DD0000">"amount"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">intval</span><span style="color: #007700">(</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">-hour"</span><span style="color: #007700">])&nbsp;+&nbsp;</span><span style="color: #0000BB">floatval</span><span style="color: #007700">(</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">-minute"</span><span style="color: #007700">])&nbsp;/&nbsp;</span><span style="color: #0000BB">60</span><span style="color: #007700">;<br /><a name="l204" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">$temp</span><span style="color: #007700">[</span><span style="color: #DD0000">"amount"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">floatval</span><span style="color: #007700">(</span><span style="color: #0000BB">$mat_assoc</span><span style="color: #007700">[</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$prefix</span><span style="color: #DD0000">-amount"</span><span style="color: #007700">]);<br /><a name="l205" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$temp</span><span style="color: #007700">;<br /><a name="l206" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l207" />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$materials</span><span style="color: #007700">;<br /><a name="l208" />}<br /><a name="l209" /><br /><a name="l210" /><br /><a name="l211" />function&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$error</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br /><a name="l212" />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$device_id</span><span style="color: #007700">;<br /><a name="l213" />&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$error</span><span style="color: #007700">)&nbsp;return;<br /><a name="l214" /><br /><a name="l215" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'error_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$error</span><span style="color: #007700">;<br /><a name="l216" />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:</span><span style="color: #0000BB">$redirect</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l217" />&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:/pages/create.php?d_id=</span><span style="color: #0000BB">$device_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//REMOVE&nbsp;WITH&nbsp;UPDATE<br /><a name="l218" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;header("Location:/pages/create.php?device_id=$device_id");&nbsp;&nbsp;//ADD&nbsp;WITH&nbsp;UPDATE<br /><a name="l219" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit();<br /><a name="l220" />}<br /><a name="l221" /><br /><a name="l222" /></span><span style="color: #0000BB">?&gt;<br /><a name="l223" /></span>&lt;title&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'site_name'</span><span style="color: #007700">];</span><span style="color: #0000BB">?&gt;</span>&nbsp;Create&nbsp;Ticket&lt;/title&gt;<br /><a name="l224" />&lt;div&nbsp;id="page-wrapper"&gt;<br /><a name="l225" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="row"&gt;<br /><a name="l226" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="col-md-12"&gt;<br /><a name="l227" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&nbsp;class="page-header"&gt;Create&nbsp;Ticket&nbsp;for&nbsp;the&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/h1&gt;<br /><a name="l228" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l229" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="row"&gt;<br /><a name="l230" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="col-md-12"&gt;<br /><a name="l231" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l232" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(isset(</span><span style="color: #0000BB">$error</span><span style="color: #007700">))<br /><a name="l233" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;h1&nbsp;class='page-header'&gt;Error&lt;/h1&gt;</span><span style="color: #0000BB">$error</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br /><a name="l234" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l235" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l236" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel&nbsp;panel-default"&gt;<br /><a name="l237" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-body"&gt;<br /><a name="l238" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;id="cform"&nbsp;name="cform"&nbsp;method="post"&nbsp;action=""&nbsp;onsubmit="return&nbsp;validateForm()"&nbsp;autocomplete='off'&gt;<br /><a name="l239" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;class="table&nbsp;table-striped&nbsp;table-bordered&nbsp;table-hover"&gt;<br /><a name="l240" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tablerow"&gt;<br /><a name="l241" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="center"&gt;ID&nbsp;Number&lt;/td&gt;<br /><a name="l242" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l243" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="number"&nbsp;name="operator"&nbsp;id="operator"&nbsp;class='form-control'&nbsp;placeholder="1000000000"&nbsp;<br /><a name="l244" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onchange='restrict_size(this);'&nbsp;onkeyup='restrict_size(this);'&nbsp;maxlength="10"&nbsp;size="10"&nbsp;autofocus&nbsp;tabindex="1"/&gt;<br /><a name="l245" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l246" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l247" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tablerow"&gt;<br /><a name="l248" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #FF8000">//&nbsp;build&nbsp;Purpose&nbsp;Option&nbsp;List<br /><a name="l249" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$pArray&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Purpose</span><span style="color: #007700">::</span><span style="color: #0000BB">getList</span><span style="color: #007700">()){&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l250" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="Center"&gt;<br /><a name="l251" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Purpose&nbsp;of&nbsp;Visit<br /><a name="l252" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l253" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l254" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;id='purpose'&nbsp;name="p_id"&nbsp;class='form-control'&nbsp;tabindex="8"&gt;<br /><a name="l255" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;disabled&nbsp;hidden&nbsp;selected&nbsp;value=""&gt;Select&lt;/option&gt;<br /><a name="l256" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l257" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$pArray&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)<br /><a name="l258" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo(</span><span style="color: #DD0000">"&lt;option&nbsp;value='</span><span style="color: #0000BB">$key</span><span style="color: #DD0000">'&gt;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">&lt;/option&gt;"</span><span style="color: #007700">);<br /><a name="l259" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/select&gt;"</span><span style="color: #007700">;<br /><a name="l260" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l261" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l262" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l263" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;if&nbsp;device&nbsp;usage&nbsp;is&nbsp;limited&nbsp;to&nbsp;a&nbsp;max&nbsp;time&nbsp;amount<br /><a name="l264" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$lime_limit</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l265" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tablerow"&gt;<br /><a name="l266" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="center"&gt;Max&nbsp;Time&lt;/td&gt;<br /><a name="l267" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l268" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="input-group"&gt;<br /><a name="l269" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="text"&nbsp;size="1"&nbsp;name="hours"&nbsp;class='form-control&nbsp;time'&nbsp;disabled&nbsp;value="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$lime_limit?&gt;</span>"/&gt;<br /><a name="l270" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class="input-group-addon"&gt;Hours&lt;/span&gt;<br /><a name="l271" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l272" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l273" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l274" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l275" /><br /><a name="l276" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;——————————–—&nbsp;MATS&nbsp;CHOSEN&nbsp;FIRST&nbsp;————————————<br /><a name="l277" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;list&nbsp;all&nbsp;required&nbsp;mats&nbsp;associated&nbsp;with&nbsp;device&nbsp;<br /><a name="l278" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_pay_first&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_select_mats_first</span><span style="color: #007700">)&nbsp;{<br /><a name="l279" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">required_materials</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l280" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l281" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align='center'&gt;Required&nbsp;Materials&lt;/td&gt;<br /><a name="l282" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l283" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l284" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for(</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">required_materials</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">++)&nbsp;{<br /><a name="l285" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$material&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">required_materials</span><span style="color: #007700">[</span><span style="color: #0000BB">$x</span><span style="color: #007700">-</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br /><a name="l286" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$unit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"[-]"</span><span style="color: #007700">;<br /><a name="l287" /><br /><a name="l288" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;add&nbsp;quantitiy&nbsp;measurements&nbsp;if&nbsp;payfirst&nbsp;&amp;&amp;&nbsp;measurable<br /><a name="l289" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_measurable&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_pay_first</span><span style="color: #007700">)&nbsp;{<br /><a name="l290" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">"hour(s)"</span><span style="color: #007700">)&nbsp;{<br /><a name="l291" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$min_hours&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">intval</span><span style="color: #007700">(</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'minTime'</span><span style="color: #007700">]);<br /><a name="l292" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$max_hours&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">intval</span><span style="color: #007700">(</span><span style="color: #0000BB">$time_limit</span><span style="color: #007700">)&nbsp;?&nbsp;</span><span style="color: #0000BB">intval</span><span style="color: #007700">(</span><span style="color: #0000BB">$time_limit</span><span style="color: #007700">)&nbsp;:&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br /><a name="l293" /><br /><a name="l294" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$quantity&nbsp;</span><span style="color: #007700">=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;div&nbsp;class='input-group'&gt;<br /><a name="l295" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='input-group-addon'&gt;&lt;i&nbsp;class='</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #0000BB">currency</span><span style="color: #007700">]</span><span style="color: #DD0000">'&gt;&lt;/i&gt;&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%0.2f"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">price</span><span style="color: #007700">).</span><span style="color: #DD0000">"&nbsp;x&nbsp;&lt;/span&gt;<br /><a name="l296" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type='number'&nbsp;id='</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">-input'&nbsp;class='form-control&nbsp;mat_used_input&nbsp;time'&nbsp;value='</span><span style="color: #0000BB">$min_hours</span><span style="color: #DD0000">'<br /><a name="l297" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name='required-hour-</span><span style="color: #0000BB">$x</span><span style="color: #DD0000">'&nbsp;onchange='quote();'&nbsp;onkeyup='quote();'&nbsp;autocomplete='off'&nbsp;&nbsp;step='1'<br /><a name="l298" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style='text-align:right;&nbsp;max-width:75px;&nbsp;min-width:75px;'&nbsp;min='</span><span style="color: #0000BB">$min_hours</span><span style="color: #DD0000">'&nbsp;max='</span><span style="color: #0000BB">$max_hours</span><span style="color: #DD0000">'/&gt;<br /><a name="l299" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='input-group-addon'&gt;Hours&lt;/span&gt;<br /><a name="l300" /><br /><a name="l301" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type='number'&nbsp;id='</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">-minute'&nbsp;name='required-minute-</span><span style="color: #0000BB">$x</span><span style="color: #DD0000">'&nbsp;class='form-control&nbsp;time'&nbsp;value='0'<br /><a name="l302" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onchange='quote();'&nbsp;onkeyup='quote();'&nbsp;autocomplete='off'&nbsp;style='text-align:right;&nbsp;max-width:&nbsp;100px;'&nbsp;min='0'&nbsp;max='59'/&gt;<br /><a name="l303" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='input-group-addon'&gt;Minutes&lt;/span&gt;<br /><a name="l304" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;"</span><span style="color: #007700">;<br /><a name="l305" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l306" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_pay_first</span><span style="color: #007700">)<br /><a name="l307" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$quantity&nbsp;</span><span style="color: #007700">=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;div&nbsp;class='input-group'&gt;<br /><a name="l308" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='input-group-addon'&gt;&lt;i&nbsp;class='</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #0000BB">currency</span><span style="color: #007700">]</span><span style="color: #DD0000">'&gt;&lt;/i&gt;&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%0.2f"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">price</span><span style="color: #007700">).</span><span style="color: #DD0000">"&nbsp;x&nbsp;&lt;/span&gt;<br /><a name="l309" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type='number'&nbsp;id='</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">-input'&nbsp;name='required-amount-</span><span style="color: #0000BB">$x</span><span style="color: #DD0000">'&nbsp;class='form-control&nbsp;mat_used_input'&nbsp;<br /><a name="l310" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onchange='quote();'&nbsp;onkeyup='quote();'&nbsp;autocomplete='off'&nbsp;style='text-align:right;&nbsp;max-width:100px;'&nbsp;min='0'&nbsp;value='0'/&gt;<br /><a name="l311" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='input-group-addon'&gt;</span><span style="color: #0000BB">$unit</span><span style="color: #DD0000">&lt;/span&gt;<br /><a name="l312" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;"</span><span style="color: #007700">;<br /><a name="l313" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l314" /><br /><a name="l315" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;standard&nbsp;tag&nbsp;with&nbsp;quantity&nbsp;(?is_select_mats_first)&nbsp;input<br /><a name="l316" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;div&nbsp;style='background-color:&nbsp;rgb(232,&nbsp;232,&nbsp;232);&nbsp;border-style:&nbsp;solid;&nbsp;border-radius:&nbsp;8px;&nbsp;<br /><a name="l317" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border-width:&nbsp;10px;&nbsp;display:&nbsp;inline-block;&nbsp;margin:&nbsp;5px;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;justify;&nbsp;<br /><a name="l318" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border-color:&nbsp;#</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">color_hex</span><span style="color: #DD0000">;'&gt;<br /><a name="l319" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;class='material'&nbsp;readonly&nbsp;hidden&nbsp;value='</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">'&nbsp;name='required-</span><span style="color: #0000BB">$x</span><span style="color: #DD0000">'&gt;<br /><a name="l320" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_name</span><span style="color: #DD0000">&lt;/label&gt;<br /><a name="l321" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$quantity</span><span style="color: #DD0000"><br /><a name="l322" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;"</span><span style="color: #007700">;<br /><a name="l323" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l324" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l325" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l326" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l327" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l328" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;required&nbsp;materials<br /><a name="l329" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————–—&nbsp;OPTIONAL&nbsp;MATS&nbsp;—————————————<br /><a name="l330" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;optional&nbsp;materials&nbsp;for&nbsp;prepaid&nbsp;or&nbsp;select_mats_first<br /><a name="l331" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">optional_materials</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l332" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tablerow"&gt;<br /><a name="l333" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="Center"&gt;Optional&nbsp;Materials&lt;/td&gt;<br /><a name="l334" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l335" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;id="material_select"&nbsp;class='form-control'&nbsp;onchange='add_tag(this);'&nbsp;tabindex="2"&gt;<br /><a name="l336" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;disabled&nbsp;hidden&nbsp;selected&nbsp;value=""&gt;—Select—&lt;/option&gt;<br /><a name="l337" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l338" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">optional_materials&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">)<br /><a name="l339" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo</span><span style="color: #DD0000">"&lt;option&nbsp;value='</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">'&gt;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_name</span><span style="color: #DD0000">&lt;/option&gt;"</span><span style="color: #007700">;<br /><a name="l340" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l341" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;<br /><a name="l342" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id='selected_materials'&nbsp;style='width:100%;'&gt;<br /><a name="l343" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l344" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l345" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l346" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l347" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;optional&nbsp;materials<br /><a name="l348" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;prepaid&nbsp;or&nbsp;select_mats_first<br /><a name="l349" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————&nbsp;MATS&nbsp;SELECTED&nbsp;AT&nbsp;END&nbsp;———————————<br /><a name="l350" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;mats&nbsp;are&nbsp;selected&nbsp;at&nbsp;the&nbsp;end<br /><a name="l351" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">elseif(</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">optional_materials</span><span style="color: #007700">))&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l352" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tablerow"&gt;<br /><a name="l353" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="Center"&gt;Material&lt;/td&gt;<br /><a name="l354" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;b&gt;Indicate&nbsp;the&nbsp;material&nbsp;used&nbsp;when&nbsp;closing&nbsp;this&nbsp;ticket.&lt;/b&gt;<br /><a name="l355" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;name="m_id"&nbsp;id="m_id"&nbsp;tabindex="2"&nbsp;disabled="true"&nbsp;hidden&gt;<br /><a name="l356" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;selected&nbsp;value="none"&gt;None&lt;/option&gt;<br /><a name="l357" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;<br /><a name="l358" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l359" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l360" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l361" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l362" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;select&nbsp;at&nbsp;end&nbsp;<br /><a name="l363" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;is_pay_first&nbsp;price&nbsp;quote<br /><a name="l364" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_pay_first</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l365" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tableheader&nbsp;warning"&gt;<br /><a name="l366" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='pay_first_cell'&nbsp;align="center"&nbsp;colspan=2&gt;Payment&nbsp;Required&nbsp;First<br /><a name="l367" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id="quote"&nbsp;style="float:right"&gt;&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'currency'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;fa-fw'&gt;&lt;/i&gt;&nbsp;0.00&lt;/div&gt;<br /><a name="l368" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l369" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l370" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l371" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class="tablerow"&gt;<br /><a name="l372" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="center"&gt;&lt;input&nbsp;type="button"&nbsp;class='btn&nbsp;btn-default'&nbsp;onclick="resetForm()"&nbsp;value="Reset&nbsp;form"&gt;&lt;/td&gt;<br /><a name="l373" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align="right"&gt;&lt;input&nbsp;type="submit"&nbsp;name="ticketBtn"&nbsp;value="Submit"&nbsp;class='btn&nbsp;btn-default'&nbsp;tabindex="9"&gt;&lt;/td&gt;<br /><a name="l374" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l375" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l376" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br /><a name="l377" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l378" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l379" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l380" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l381" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l382" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l383" />&lt;/div&gt;<br /><a name="l384" /><br /><a name="l385" /><span style="color: #0000BB">&lt;?php<br /><a name="l386" /></span><span style="color: #FF8000">//Standard&nbsp;call&nbsp;for&nbsp;dependencies<br /><a name="l387" /></span><span style="color: #007700">include_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">'/pages/footer.php'</span><span style="color: #007700">);<br /><a name="l388" /></span><span style="color: #0000BB">?&gt;<br /><a name="l389" /></span><br /><a name="l390" />&lt;script&nbsp;type="text/javascript"&gt;<br /><a name="l391" /><br /><a name="l392" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;——&nbsp;FROM&nbsp;DB&nbsp;——<br /><a name="l393" />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;currency&nbsp;=&nbsp;"<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"&lt;i&nbsp;class='</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #0000BB">currency</span><span style="color: #007700">]</span><span style="color: #DD0000">&nbsp;fa-fw'&gt;&lt;/i&gt;"</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>";<br /><a name="l394" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;minimum&nbsp;amout&nbsp;of&nbsp;time&nbsp;to&nbsp;be&nbsp;charge&nbsp;for&nbsp;a&nbsp;device<br /><a name="l395" />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;minimum_charge_time&nbsp;=&nbsp;parseFloat(<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">"minTime"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>);<br /><a name="l396" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;devices&nbsp;time&nbsp;limit<br /><a name="l397" />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;time_limit&nbsp;=&nbsp;parseFloat(<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$time_limit</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>);<br /><a name="l398" /><br /><a name="l399" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;dictionary&nbsp;of&nbsp;m_id,&nbsp;color_hex,&nbsp;m_name,&nbsp;unit&nbsp;for&nbsp;all&nbsp;optional&nbsp;materials&nbsp;associated&nbsp;with&nbsp;a&nbsp;device<br /><a name="l400" />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;device_mat_attrs&nbsp;=&nbsp;{<br /><a name="l401" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;echo&nbsp;materials&nbsp;as&nbsp;a&nbsp;dictionary<br /><a name="l402" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">optional_materials</span><span style="color: #007700">;<br /><a name="l403" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">",\n"</span><span style="color: #007700">,&nbsp;<br /><a name="l404" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">array_map</span><span style="color: #007700">(<br /><a name="l405" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(</span><span style="color: #0000BB">$m</span><span style="color: #007700">)&nbsp;{return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">&nbsp;:&nbsp;{'color'&nbsp;:&nbsp;'</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">color_hex</span><span style="color: #DD0000">',&nbsp;'name'&nbsp;:&nbsp;'</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_name</span><span style="color: #DD0000">',&nbsp;"</span><span style="color: #007700">.<br /><a name="l406" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"'price'&nbsp;:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%0.2f"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">price</span><span style="color: #007700">).</span><span style="color: #DD0000">",&nbsp;'unit'&nbsp;:&nbsp;'</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unit</span><span style="color: #DD0000">',&nbsp;"</span><span style="color: #007700">.<br /><a name="l407" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"'measurable'&nbsp;:&nbsp;"</span><span style="color: #007700">.(</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">is_measurable&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">"true"&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"false"</span><span style="color: #007700">).</span><span style="color: #DD0000">"}"</span><span style="color: #007700">;},&nbsp;<br /><a name="l408" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials</span><span style="color: #007700">));&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l409" /></span>&nbsp;&nbsp;&nbsp;&nbsp;};<br /><a name="l410" /><br /><a name="l411" /><br /><a name="l412" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;for&nbsp;more&nbsp;information&nbsp;about&nbsp;class&nbsp;see&nbsp;~/pages/end.php<br /><a name="l413" />&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Input&nbsp;{<br /><a name="l414" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructor(input)&nbsp;{<br /><a name="l415" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.mu_id&nbsp;=&nbsp;input.id.substr(0,&nbsp;input.id.indexOf('-'));<br /><a name="l416" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element;&nbsp;<br /><a name="l417" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.is_time_based;<br /><a name="l418" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.initialize_element_and_type(input);<br /><a name="l419" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.parent&nbsp;=&nbsp;this.parent_from_classes(input.classList);<br /><a name="l420" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.price&nbsp;=&nbsp;parseFloat(input.parentElement.children[0].innerHTML.match(/\d+(\.\d+)?/g));<br /><a name="l421" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.status&nbsp;=&nbsp;document.getElementById(this.mu_id+"-select");<br /><a name="l422" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l423" /><br /><a name="l424" /><br /><a name="l425" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;input&nbsp;is&nbsp;time&nbsp;based&nbsp;assign&nbsp;appropriate&nbsp;elements&nbsp;for&nbsp;it<br /><a name="l426" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initialize_element_and_type(input)&nbsp;{<br /><a name="l427" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(input.classList.contains("time"))&nbsp;<br /><a name="l428" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element&nbsp;=&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;"hour"&nbsp;:&nbsp;document.getElementById(this.mu_id+"-input"),&nbsp;<br /><a name="l429" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"min"&nbsp;:&nbsp;document.getElementById(this.mu_id+"-minute")},&nbsp;<br /><a name="l430" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.is_time_based&nbsp;=&nbsp;true;<br /><a name="l431" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l432" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element&nbsp;=&nbsp;input<br /><a name="l433" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.is_time_based&nbsp;=&nbsp;false;<br /><a name="l434" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l435" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l436" /><br /><a name="l437" /><br /><a name="l438" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return&nbsp;numeric&nbsp;quantity&nbsp;for&nbsp;input(s)&nbsp;associated<br /><a name="l439" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity()&nbsp;{<br /><a name="l440" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!this.is_time_based)&nbsp;return&nbsp;parseFloat(this.element.value);<br /><a name="l441" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parseFloat(this.element['hour'].value)&nbsp;+&nbsp;parseFloat(this.element['min'].value)&nbsp;/&nbsp;60&nbsp;||&nbsp;0;<br /><a name="l442" /><br /><a name="l443" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l444" /><br /><a name="l445" /><br /><a name="l446" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refactor_name(index)&nbsp;{<br /><a name="l447" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!this.is_time_based)&nbsp;this.element.name&nbsp;=&nbsp;`optional-amount-${index}`;<br /><a name="l448" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l449" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element["hour"].name&nbsp;=&nbsp;`optional-hour-${index}`;<br /><a name="l450" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element["min"].name&nbsp;=&nbsp;`optional-minute-${index}`;<br /><a name="l451" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l452" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l453" /><br /><a name="l454" /><br /><a name="l455" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;set&nbsp;quantity&nbsp;based&nbsp;on&nbsp;quantity&nbsp;passed&nbsp;and&nbsp;parse&nbsp;into&nbsp;hour/minute&nbsp;if&nbsp;necessary<br /><a name="l456" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_val(quantity)&nbsp;{<br /><a name="l457" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!this.is_time_based)&nbsp;this.element.value&nbsp;=&nbsp;parseFloat(quantity);<br /><a name="l458" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l459" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hour&nbsp;=&nbsp;parseInt(quantity);<br /><a name="l460" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;minute&nbsp;=&nbsp;(quantity&nbsp;-&nbsp;hour)&nbsp;*&nbsp;60;<br /><a name="l461" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element["hour"].value&nbsp;=&nbsp;hour;<br /><a name="l462" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element["min"].value&nbsp;=&nbsp;round(minute,&nbsp;2);<br /><a name="l463" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l464" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l465" /><br /><a name="l466" /><br /><a name="l467" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;retrieve&nbsp;the&nbsp;parent&nbsp;name&nbsp;of&nbsp;a&nbsp;class&nbsp;(&lt;parent_name&gt;-child);&nbsp;return&nbsp;null&nbsp;if&nbsp;no&nbsp;parent&nbsp;name<br /><a name="l468" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent_from_classes(classList)&nbsp;{<br /><a name="l469" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;classList.length;&nbsp;x++)<br /><a name="l470" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(classList[x].includes("-child")&nbsp;&amp;&amp;&nbsp;classList[x].length&nbsp;&gt;&nbsp;6)&nbsp;<br /><a name="l471" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;document.getElementById(classList[x].substr(0,&nbsp;classList[x].indexOf('-')));<br /><a name="l472" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br /><a name="l473" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l474" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l475" /><br /><a name="l476" /><br /><a name="l477" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------&nbsp;FORM&nbsp;------------------------------------------------------<br /><a name="l478" /><br /><a name="l479" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;resetForm()&nbsp;{<br /><a name="l480" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("cform").reset();<br /><a name="l481" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById("selected_materials"))&nbsp;{<br /><a name="l482" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;options&nbsp;=&nbsp;document.getElementById("material_select");<br /><a name="l483" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;options.options.length;&nbsp;x++)&nbsp;options.options[x].hidden&nbsp;=&nbsp;false;<br /><a name="l484" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("selected_materials").innerHTML&nbsp;=&nbsp;"";<br /><a name="l485" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l486" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("quote").innerHTML&nbsp;=&nbsp;currency+"&nbsp;0.00";<br /><a name="l487" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l488" /><br /><a name="l489" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;validateForm()&nbsp;{<br /><a name="l490" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!stdRegEx("operator",&nbsp;/^\d{10}$/,&nbsp;"Invalid&nbsp;ID&nbsp;#"))&nbsp;return&nbsp;false;<br /><a name="l491" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;purpose&nbsp;populated<br /><a name="l492" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(!document.getElementById("purpose").value)&nbsp;{<br /><a name="l493" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("Please&nbsp;select&nbsp;a&nbsp;purpose");<br /><a name="l494" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br /><a name="l495" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l496" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l497" /><br /><a name="l498" /><br /><a name="l499" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;calculate&nbsp;&amp;&nbsp;display&nbsp;cost&nbsp;of&nbsp;selected&nbsp;materials<br /><a name="l500" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;quote()&nbsp;{<br /><a name="l501" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;materials&nbsp;=&nbsp;document.getElementsByClassName("mat_used_input");<br /><a name="l502" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;total&nbsp;=&nbsp;0;<br /><a name="l503" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;materials.length;&nbsp;x++)&nbsp;{<br /><a name="l504" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input&nbsp;=&nbsp;new&nbsp;Input(materials[x]);<br /><a name="l505" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(input.is_time_based&nbsp;&amp;&amp;&nbsp;input.quantity()&nbsp;&gt;&nbsp;time_limit)&nbsp;{<br /><a name="l506" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("The&nbsp;current&nbsp;time&nbsp;amount&nbsp;is&nbsp;above&nbsp;the&nbsp;max&nbsp;allowed&nbsp;time&nbsp;for&nbsp;this&nbsp;device");<br /><a name="l507" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.set_val(time_limit);<br /><a name="l508" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l509" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(input.is_time_based&nbsp;&amp;&amp;&nbsp;input.quantity()&nbsp;&lt;&nbsp;minimum_charge_time)&nbsp;{<br /><a name="l510" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("The&nbsp;current&nbsp;time&nbsp;amount&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;minimum&nbsp;amount&nbsp;to&nbsp;be&nbsp;charged&nbsp;for");<br /><a name="l511" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.set_val(minimum_charge_time);<br /><a name="l512" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l513" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;+=&nbsp;input.quantity()&nbsp;*&nbsp;input.price;<br /><a name="l514" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l515" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("quote").innerHTML&nbsp;=&nbsp;currency&nbsp;+&nbsp;total.toFixed(2);<br /><a name="l516" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l517" /><br /><a name="l518" /><br /><a name="l519" /><br /><a name="l520" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;–—————————————&nbsp;OPTIONAL&nbsp;MATERIALS&nbsp;——————————————<br /><a name="l521" /><br /><a name="l522" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;call&nbsp;tag&nbsp;creation,&nbsp;style&nbsp;fields&nbsp;of&nbsp;tag&nbsp;and&nbsp;add&nbsp;tag&nbsp;to&nbsp;selected_materials&nbsp;div<br /><a name="l523" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;add_tag(select)&nbsp;{<br /><a name="l524" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;selected&nbsp;=&nbsp;select.options[select.selectedIndex];<br /><a name="l525" /><br /><a name="l526" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input&nbsp;=&nbsp;document.createElement("input");<br /><a name="l527" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.classList.add("material");<br /><a name="l528" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.readOnly&nbsp;=&nbsp;true;<br /><a name="l529" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.type&nbsp;=&nbsp;"hidden";<br /><a name="l530" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.value&nbsp;=&nbsp;select.value;<br /><a name="l531" /><br /><a name="l532" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;label&nbsp;=&nbsp;document.createElement("label");<br /><a name="l533" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.innerHTML&nbsp;=&nbsp;device_mat_attrs[select.value]['name'];<br /><a name="l534" /><br /><a name="l535" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;functionality&nbsp;=&nbsp;function()&nbsp;{<br /><a name="l536" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selected.hidden&nbsp;=&nbsp;false;<br /><a name="l537" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quote();<br /><a name="l538" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refactor_selection_names();&nbsp;&nbsp;//&nbsp;rename&nbsp;others&nbsp;to&nbsp;be&nbsp;sequential<br /><a name="l539" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br /><a name="l540" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parent&nbsp;=&nbsp;document.getElementById("selected_materials");<br /><a name="l541" /><br /><a name="l542" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag&nbsp;=&nbsp;create_tag(functionality,&nbsp;input,&nbsp;label,&nbsp;parent);<br /><a name="l543" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag.style["border-color"]&nbsp;=&nbsp;`#${device_mat_attrs[select.value]['color']}`;&nbsp;&nbsp;//&nbsp;add&nbsp;groovy&nbsp;color&nbsp;border&nbsp;of&nbsp;selected&nbsp;material<br /><a name="l544" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent.appendChild(tag);<br /><a name="l545" /><br /><a name="l546" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refactor_selection_names();&nbsp;&nbsp;//&nbsp;rename&nbsp;others&nbsp;to&nbsp;be&nbsp;sequential<br /><a name="l547" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select.value&nbsp;=&nbsp;select.options[0];<br /><a name="l548" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selected.hidden&nbsp;=&nbsp;true;&nbsp;&nbsp;//&nbsp;prevent&nbsp;double&nbsp;selection<br /><a name="l549" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l550" /><br /><a name="l551" /><br /><a name="l552" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;tag&nbsp;(input,&nbsp;label&nbsp;and&nbsp;display)&nbsp;for&nbsp;selected&nbsp;materials<br /><a name="l553" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;create_tag(functionality,&nbsp;input,&nbsp;label,&nbsp;parent)&nbsp;{<br /><a name="l554" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag&nbsp;=&nbsp;document.createElement("div");<br /><a name="l555" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;close&nbsp;=&nbsp;document.createElement("button");<br /><a name="l556" /><br /><a name="l557" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;appearance<br /><a name="l558" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close.style&nbsp;=&nbsp;input.style&nbsp;=&nbsp;"background-color:#E8E8E8;border-style:none;height:100%;display:inline-block;float:right;";<br /><a name="l559" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag.style&nbsp;=&nbsp;'background-color:#E8E8E8;border-style:solid;border-radius:8px;border-width:10px;display:inline-block;margin:5px;padding:8px;text-align:justify;';<br /><a name="l560" /><br /><a name="l561" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;close&nbsp;button&nbsp;event<br /><a name="l562" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close.innerHTML&nbsp;=&nbsp;"&lt;strong&gt;&amp;#215&lt;/strong&gt;";<br /><a name="l563" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close.onclick&nbsp;=&nbsp;function()&nbsp;{<br /><a name="l564" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent.removeChild(tag);&nbsp;&nbsp;//&nbsp;remove&nbsp;self<br /><a name="l565" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;functionality();&nbsp;&nbsp;//&nbsp;user&nbsp;specified&nbsp;proceeding&nbsp;function<br /><a name="l566" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br /><a name="l567" /><br /><a name="l568" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;parts&nbsp;to&nbsp;tag;&nbsp;add&nbsp;tag&nbsp;to&nbsp;parent<br /><a name="l569" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag.appendChild(input);<br /><a name="l570" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag.appendChild(label);<br /><a name="l571" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag.appendChild(close);<br /><a name="l572" /><br /><a name="l573" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent.appendChild(tag);<br /><a name="l574" /><br /><a name="l575" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;amounts&nbsp;if&nbsp;payFirst<br /><a name="l576" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById("pay_first_cell")&nbsp;&amp;&amp;&nbsp;device_mat_attrs[input.value]['measurable'])&nbsp;{<br /><a name="l577" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag.appendChild(add_quantity_input(input));<br /><a name="l578" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quote();<br /><a name="l579" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l580" /><br /><a name="l581" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tag;<br /><a name="l582" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l583" /><br /><a name="l584" /><br /><a name="l585" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;when&nbsp;prepaid&nbsp;(choose&nbsp;quantity),&nbsp;add&nbsp;inputs&nbsp;for&nbsp;quantity<br /><a name="l586" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;add_quantity_input(mat_input)&nbsp;{<br /><a name="l587" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input_group&nbsp;=&nbsp;document.createElement("div");<br /><a name="l588" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_group.classList.add("input-group");<br /><a name="l589" /><br /><a name="l590" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;price_span&nbsp;=&nbsp;document.createElement("span");<br /><a name="l591" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price_span.classList.add("input-group-addon");<br /><a name="l592" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price_span.innerHTML&nbsp;=&nbsp;"&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'currency'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;fa-fw'&gt;&lt;/i&gt;&nbsp;"&nbsp;+&nbsp;device_mat_attrs[mat_input.value]['price'];<br /><a name="l593" /><br /><a name="l594" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input_attrs&nbsp;=&nbsp;{"onchange"&nbsp;:&nbsp;quote,&nbsp;"onkeyup"&nbsp;:&nbsp;quote,&nbsp;"min"&nbsp;:&nbsp;"0",&nbsp;"value"&nbsp;:&nbsp;0,&nbsp;"type"&nbsp;:&nbsp;"number",&nbsp;"autocomplete"&nbsp;:&nbsp;"off"};<br /><a name="l595" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input&nbsp;=&nbsp;document.createElement("input");<br /><a name="l596" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.classList.add("form-control",&nbsp;"mat_used_input");<br /><a name="l597" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.id&nbsp;=&nbsp;`${mat_input.value}-input`;<br /><a name="l598" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.style.maxWidth&nbsp;=&nbsp;"100px";<br /><a name="l599" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.style.textAlign&nbsp;=&nbsp;"right";<br /><a name="l600" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(key&nbsp;in&nbsp;input_attrs)&nbsp;&nbsp;//&nbsp;add&nbsp;ubiquitous&nbsp;attributes<br /><a name="l601" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input[key]&nbsp;=&nbsp;input_attrs[key];<br /><a name="l602" /><br /><a name="l603" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;unit_span&nbsp;=&nbsp;document.createElement("span");<br /><a name="l604" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unit_span.classList.add("input-group-addon");<br /><a name="l605" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unit_span.innerHTML&nbsp;=&nbsp;device_mat_attrs[mat_input.value]['unit'];<br /><a name="l606" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;to&nbsp;div<br /><a name="l607" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_group.appendChild(price_span);<br /><a name="l608" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_group.appendChild(input);<br /><a name="l609" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_group.appendChild(unit_span);<br /><a name="l610" /><br /><a name="l611" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;adjust&nbsp;for&nbsp;time&nbsp;based&nbsp;data<br /><a name="l612" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(device_mat_attrs[mat_input.value]['unit']&nbsp;==&nbsp;"hour(s)")&nbsp;{<br /><a name="l613" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.classList.add("time");<br /><a name="l614" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.max&nbsp;=&nbsp;time_limit;<br /><a name="l615" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.min&nbsp;=&nbsp;minimum_charge_time;<br /><a name="l616" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.value&nbsp;=&nbsp;minimum_charge_time;<br /><a name="l617" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.style.maxWidth&nbsp;=&nbsp;"75px";<br /><a name="l618" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.step&nbsp;=&nbsp;1;&nbsp;&nbsp;//&nbsp;only&nbsp;take&nbsp;full&nbsp;hour&nbsp;increments<br /><a name="l619" /><br /><a name="l620" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;minute_input&nbsp;=&nbsp;document.createElement("input");<br /><a name="l621" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_input.id&nbsp;=&nbsp;`${mat_input.value}-minute`;<br /><a name="l622" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_input.classList.add("form-control",&nbsp;"time");<br /><a name="l623" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_input.max&nbsp;=&nbsp;59;<br /><a name="l624" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_input.style.textAlign&nbsp;=&nbsp;"right";<br /><a name="l625" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(key&nbsp;in&nbsp;input_attrs)&nbsp;&nbsp;//&nbsp;add&nbsp;ubiquitous&nbsp;attributes<br /><a name="l626" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_input[key]&nbsp;=&nbsp;input_attrs[key];<br /><a name="l627" /><br /><a name="l628" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unit_span.innerHTML&nbsp;=&nbsp;"Hour";<br /><a name="l629" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;minute_span&nbsp;=&nbsp;document.createElement("span");<br /><a name="l630" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_span.classList.add("input-group-addon");<br /><a name="l631" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute_span.innerHTML&nbsp;=&nbsp;"Minutes";<br /><a name="l632" /><br /><a name="l633" /><br /><a name="l634" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_group.appendChild(minute_input);<br /><a name="l635" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_group.appendChild(minute_span);<br /><a name="l636" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l637" /><br /><a name="l638" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;input_group;<br /><a name="l639" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l640" /><br /><a name="l641" /><br /><a name="l642" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;used&nbsp;for&nbsp;name&nbsp;attribute&nbsp;that&nbsp;PHP&nbsp;pulls<br /><a name="l643" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;when&nbsp;selection&nbsp;is&nbsp;deleted,&nbsp;rename&nbsp;all&nbsp;elements&nbsp;to&nbsp;be&nbsp;sequentially&nbsp;named<br /><a name="l644" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;refactor_selection_names()&nbsp;{<br /><a name="l645" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag_space&nbsp;=&nbsp;document.getElementById("selected_materials");<br /><a name="l646" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;tag_space.children.length;&nbsp;x++)&nbsp;{<br /><a name="l647" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag_space.children[x].children[0].name&nbsp;=&nbsp;'optional-'+(x+1);<br /><a name="l648" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l649" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;tag&nbsp;has&nbsp;a&nbsp;quantity&nbsp;input,&nbsp;name&nbsp;quantity&nbsp;input(s)<br /><a name="l650" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById("pay_first_cell")&nbsp;&amp;&amp;&nbsp;<br /><a name="l651" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;device_mat_attrs[tag_space.children[x].children[0].value]["measurable"])&nbsp;{<br /><a name="l652" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;group_addon&nbsp;=&nbsp;tag_space.children[x].children[3];<br /><a name="l653" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input&nbsp;=&nbsp;new&nbsp;Input(group_addon.children[1]);<br /><a name="l654" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.refactor_name(x+1);<br /><a name="l655" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l656" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l657" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l658" /><br /><a name="l659" /><br /><a name="l660" /><br /><a name="l661" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;—————————————————&nbsp;UTILITY&nbsp;——————————————————<br /><a name="l662" /><br /><a name="l663" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;because&nbsp;JS&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;good&nbsp;rounding&nbsp;function,&nbsp;copied&nbsp;one&nbsp;from&nbsp;StackOverflow<br /><a name="l664" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;round(float,&nbsp;decimal)&nbsp;{<br /><a name="l665" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!float)&nbsp;return&nbsp;0;<br /><a name="l666" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Number(Math.round(float+`e${decimal}`)+`e-${decimal}`).toFixed(decimal);<br /><a name="l667" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l668" /><br /><a name="l669" /><br /><a name="l670" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;prevent&nbsp;string&nbsp;from&nbsp;being&nbsp;longer&nbsp;than&nbsp;10&nbsp;chars&nbsp;for&nbsp;ID<br /><a name="l671" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;restrict_size(element)&nbsp;{<br /><a name="l672" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(element.value.length&nbsp;&gt;&nbsp;10)&nbsp;element.value&nbsp;=&nbsp;element.value.substring(0,&nbsp;10);<br /><a name="l673" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l674" /><br /><a name="l675" />&lt;/script&gt;<br /><a name="l676" /></span>