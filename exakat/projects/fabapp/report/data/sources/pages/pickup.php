<span style="color: #000000">
<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l1" /><br /><a name="l2" /></span><span style="color: #FF8000">/***********************************************************************************************************<br /><a name="l3" />*&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l4" />*&nbsp;&nbsp;&nbsp;&nbsp;@author&nbsp;MPZinke<br /><a name="l5" />*&nbsp;&nbsp;&nbsp;&nbsp;created&nbsp;on&nbsp;08.07.19&nbsp;<br /><a name="l6" />*&nbsp;&nbsp;&nbsp;&nbsp;CC&nbsp;BY-NC-AS&nbsp;UTA&nbsp;FabLab&nbsp;2016-2019<br /><a name="l7" />*&nbsp;&nbsp;&nbsp;&nbsp;FabApp&nbsp;V&nbsp;0.94<br /><a name="l8" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-House&nbsp;Keeping&nbsp;(DB&nbsp;cleanup,&nbsp;$status&nbsp;variable,&nbsp;class&nbsp;syntax/functionality)<br /><a name="l9" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Multiple&nbsp;Materials<br /><a name="l10" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Off-line&nbsp;Mode<br /><a name="l11" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Sheet&nbsp;Goods<br /><a name="l12" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Storage&nbsp;Box<br /><a name="l13" />*<br /><a name="l14" />*&nbsp;&nbsp;&nbsp;&nbsp;DESCRIPTION:&nbsp;Convenience&nbsp;page&nbsp;to&nbsp;allow&nbsp;for&nbsp;selecting&nbsp;of&nbsp;items&nbsp;in&nbsp;storage&nbsp;for&nbsp;user.&nbsp;&nbsp;<br /><a name="l15" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Display&nbsp;transactions.&nbsp;Once&nbsp;transaction&nbsp;selected&nbsp;delete&nbsp;other&nbsp;&amp;&nbsp;use&nbsp;same&nbsp;process&nbsp;as&nbsp;<br /><a name="l16" />*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end.php.&nbsp;&nbsp;Update&nbsp;values&nbsp;for&nbsp;selections.<br /><a name="l17" />*&nbsp;&nbsp;&nbsp;&nbsp;FUTURE:&nbsp;&nbsp;&nbsp;&nbsp;-Make&nbsp;workable&nbsp;with&nbsp;a&nbsp;transaction&nbsp;being&nbsp;stored&nbsp;in&nbsp;multiple&nbsp;places<br /><a name="l18" />*&nbsp;&nbsp;&nbsp;&nbsp;BUGS:&nbsp;<br /><a name="l19" />*<br /><a name="l20" />***********************************************************************************************************/<br /><a name="l21" /><br /><a name="l22" /></span><span style="color: #007700">include_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">'/pages/header.php'</span><span style="color: #007700">);<br /><a name="l23" /><br /><a name="l24" />if(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">roleID&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$role</span><span style="color: #007700">[</span><span style="color: #DD0000">"staff"</span><span style="color: #007700">])&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"You&nbsp;do&nbsp;not&nbsp;have&nbsp;permission&nbsp;to&nbsp;view&nbsp;this&nbsp;page"</span><span style="color: #007700">);<br /><a name="l25" />elseif(!</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;!</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">])&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"No&nbsp;parameters&nbsp;supplied"</span><span style="color: #007700">);<br /><a name="l26" />elseif(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;!</span><span style="color: #0000BB">Users</span><span style="color: #007700">::</span><span style="color: #0000BB">regexUser</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">]))&nbsp;<br /><a name="l27" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Operator&nbsp;#</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">operator</span><span style="color: #007700">]</span><span style="color: #DD0000">&nbsp;is&nbsp;not&nbsp;valid"</span><span style="color: #007700">);<br /><a name="l28" />elseif(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;!</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">::</span><span style="color: #0000BB">regexTrans</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]))<br /><a name="l29" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"Transaction&nbsp;#</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">]</span><span style="color: #DD0000">&nbsp;is&nbsp;not&nbsp;valid"</span><span style="color: #007700">);<br /><a name="l30" />else&nbsp;{<br /><a name="l31" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$operator&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Users</span><span style="color: #007700">::</span><span style="color: #0000BB">withID</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"operator"</span><span style="color: #007700">]);<br /><a name="l32" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$tickets&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">StorageObject</span><span style="color: #007700">::</span><span style="color: #0000BB">all_in_storage_for_operator</span><span style="color: #007700">(</span><span style="color: #0000BB">$operator</span><span style="color: #007700">);<br /><a name="l33" />}<br /><a name="l34" /><br /><a name="l35" /></span><span style="color: #FF8000">//&nbsp;auto&nbsp;redirect&nbsp;if&nbsp;user&nbsp;only&nbsp;has&nbsp;1&nbsp;ticket&nbsp;in&nbsp;storage<br /><a name="l36" /></span><span style="color: #007700">if(!</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)<br /><a name="l37" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:./pickup.php?operator=</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">operator</span><span style="color: #007700">]</span><span style="color: #DD0000">&amp;trans_id="</span><span style="color: #007700">.</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">);<br /><a name="l38" /><br /><a name="l39" /><br /><a name="l40" /></span><span style="color: #FF8000">//&nbsp;cost&nbsp;associated;&nbsp;get&nbsp;attributes&nbsp;from&nbsp;user<br /><a name="l41" /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REQUEST_METHOD"</span><span style="color: #007700">]&nbsp;==&nbsp;</span><span style="color: #DD0000">"POST"&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;isset(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'end_button'</span><span style="color: #007700">]))&nbsp;{<br /><a name="l42" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$ticket&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]);<br /><a name="l43" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;get&nbsp;material&nbsp;status&nbsp;and&nbsp;quanity<br /><a name="l44" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials_values&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_material_statuses_from_page</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mats_used</span><span style="color: #007700">);<br /><a name="l45" />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mats_used&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;!</span><span style="color: #0000BB">$materials_values</span><span style="color: #007700">)&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;materials&nbsp;to&nbsp;be&nbsp;gathered&nbsp;but&nbsp;none&nbsp;gathered<br /><a name="l46" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"End:&nbsp;Could&nbsp;not&nbsp;get&nbsp;all&nbsp;values&nbsp;for&nbsp;materials"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"./end.php?trans_id=</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l47" />&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mats_used&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$mat_used</span><span style="color: #007700">)&nbsp;{<br /><a name="l48" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$material_values&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$materials_values</span><span style="color: #007700">[</span><span style="color: #0000BB">$mat_used</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mu_id</span><span style="color: #007700">];<br /><a name="l49" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$mat_used</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">end_material_used</span><span style="color: #007700">(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$material_values</span><span style="color: #007700">[</span><span style="color: #DD0000">'status'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$material_values</span><span style="color: #007700">[</span><span style="color: #DD0000">'quantity'</span><span style="color: #007700">]));<br /><a name="l50" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l51" /><br /><a name="l52" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;ticket<br /><a name="l53" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$ticket_status&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ticket_status"</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;update&nbsp;ticket<br /><a name="l54" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;prevent&nbsp;frontend&nbsp;changing&nbsp;of&nbsp;variables&nbsp;to&nbsp;cheat&nbsp;backend<br /><a name="l55" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket_status&nbsp;</span><span style="color: #007700">&gt;=&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'charge_to_acct'</span><span style="color: #007700">])&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #DD0000">"End:&nbsp;Ticket&nbsp;status&nbsp;is&nbsp;invalid."</span><span style="color: #007700">);<br /><a name="l56" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">end_transaction</span><span style="color: #007700">(</span><span style="color: #0000BB">$staff</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ticket_status</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"./end.php?trans_id=</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l57" /><br /><a name="l58" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$ticket_notes&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ticket_notes"</span><span style="color: #007700">));<br /><a name="l59" />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$ticket_notes</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">edit_transaction_information</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"notes"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$ticket_notes</span><span style="color: #007700">)));<br /><a name="l60" /><br /><a name="l61" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;completely&nbsp;failed&nbsp;ticket;&nbsp;nothing&nbsp;to&nbsp;pay&nbsp;for<br /><a name="l62" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket_status&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'total_fail'</span><span style="color: #007700">])&nbsp;{<br /><a name="l63" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'success_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"Ticket&nbsp;successfully&nbsp;ended."</span><span style="color: #007700">;<br /><a name="l64" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:./lookup.php?trans_id=</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l65" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l66" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;already&nbsp;paid&nbsp;for;&nbsp;process&nbsp;is&nbsp;finished<br /><a name="l67" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">elseif(!</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">remaining_balance</span><span style="color: #007700">())&nbsp;{<br /><a name="l68" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$storage_obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">StorageObject</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">);<br /><a name="l69" /><br /><a name="l70" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">edit_transaction_information</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"status_id"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;new&nbsp;</span><span style="color: #0000BB">Status</span><span style="color: #007700">(</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'charge_to_acct'</span><span style="color: #007700">]))));<br /><a name="l71" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'success_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"There&nbsp;is&nbsp;no&nbsp;balance&nbsp;on&nbsp;the&nbsp;ticket.&nbsp;Retrieve&nbsp;object&nbsp;from&nbsp;</span><span style="color: #0000BB">$storage_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">box_id</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br /><a name="l72" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:./pay.php?trans_id=</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l73" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l74" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;proceed&nbsp;to&nbsp;payment;&nbsp;if&nbsp;balance&nbsp;is&nbsp;negative,&nbsp;this&nbsp;is&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;refunded<br /><a name="l75" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">else&nbsp;{<br /><a name="l76" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'success_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"Please&nbsp;proceed&nbsp;to&nbsp;payment"</span><span style="color: #007700">;<br /><a name="l77" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:./pay.php?trans_id=</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l78" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l79" />}<br /><a name="l80" /><br /><a name="l81" /><br /><a name="l82" /></span><span style="color: #FF8000">//&nbsp;——————————————————&nbsp;UTILITY&nbsp;&nbsp;——————————————————<br /><a name="l83" /><br /><a name="l84" />//&nbsp;dynamically&nbsp;get&nbsp;the&nbsp;materials&nbsp;(mu_id,&nbsp;status,&nbsp;quantity)&nbsp;from&nbsp;page&nbsp;<br /><a name="l85" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">get_material_statuses_from_page</span><span style="color: #007700">(</span><span style="color: #0000BB">$mats_used</span><span style="color: #007700">)&nbsp;{<br /><a name="l86" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l87" />&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$mats_used&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$mat_used</span><span style="color: #007700">)&nbsp;{<br /><a name="l88" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$material&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /><a name="l89" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(array(</span><span style="color: #DD0000">"status"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"quantity"</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$header</span><span style="color: #007700">)<br /><a name="l90" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #0000BB">$header</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">floatval</span><span style="color: #007700">(</span><span style="color: #0000BB">filter_input</span><span style="color: #007700">(</span><span style="color: #0000BB">INPUT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mat_used</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mu_id</span><span style="color: #007700">.</span><span style="color: #DD0000">"-"</span><span style="color: #007700">.</span><span style="color: #0000BB">$header</span><span style="color: #007700">));<br /><a name="l91" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">$material</span><span style="color: #007700">[</span><span style="color: #DD0000">"status"</span><span style="color: #007700">])&nbsp;return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;check&nbsp;to&nbsp;make&nbsp;sure&nbsp;a&nbsp;value&nbsp;is&nbsp;always&nbsp;gotten<br /><a name="l92" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$materials</span><span style="color: #007700">[</span><span style="color: #0000BB">$mat_used</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mu_id</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">;<br /><a name="l93" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l94" />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$materials</span><span style="color: #007700">;<br /><a name="l95" />}<br /><a name="l96" /><br /><a name="l97" /><br /><a name="l98" /></span><span style="color: #FF8000">//&nbsp;if&nbsp;an&nbsp;error&nbsp;message&nbsp;passes,&nbsp;add&nbsp;error&nbsp;to&nbsp;session,&nbsp;redirect&nbsp;(default:&nbsp;home)<br /><a name="l99" /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">exit_if_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$error</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br /><a name="l100" />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$error</span><span style="color: #007700">)&nbsp;{<br /><a name="l101" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'error_msg'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"Pickup.php:&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$error</span><span style="color: #007700">;<br /><a name="l102" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:</span><span style="color: #0000BB">$redirect</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l103" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:/index.php"</span><span style="color: #007700">);<br /><a name="l104" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();<br /><a name="l105" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l106" />}<br /><a name="l107" /><br /><a name="l108" /><br /><a name="l109" />function&nbsp;</span><span style="color: #0000BB">exit_with_success</span><span style="color: #007700">(</span><span style="color: #0000BB">$message</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br /><a name="l110" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">"success_msg"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$message</span><span style="color: #007700">;<br /><a name="l111" />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:</span><span style="color: #0000BB">$redirect</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br /><a name="l112" />&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location:/index.php"</span><span style="color: #007700">);<br /><a name="l113" />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br /><a name="l114" />}<br /><a name="l115" /><br /><a name="l116" /></span><span style="color: #0000BB">?&gt;<br /><a name="l117" /></span><br /><a name="l118" />&lt;title&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'site_name'</span><span style="color: #007700">];</span><span style="color: #0000BB">?&gt;</span>&nbsp;Pickup&nbsp;Print&lt;/title&gt;<br /><a name="l119" />&lt;div&nbsp;id="page-wrapper"&gt;<br /><a name="l120" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="row"&gt;<br /><a name="l121" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="col-lg-12"&gt;<br /><a name="l122" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&nbsp;class='page-header'&gt;Prints&lt;/h1&gt;<br /><a name="l123" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l124" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l125" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="row"&gt;<br /><a name="l126" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id='page'&nbsp;class="col-md-10"&gt;<br /><a name="l127" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l128" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel&nbsp;panel-default"&gt;<br /><a name="l129" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-heading"&nbsp;style="color:Tomato"&gt;<br /><a name="l130" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class="fas&nbsp;fa-exclamation-triangle"&nbsp;&gt;&lt;/i&gt;&nbsp;No&nbsp;Objects&nbsp;in&nbsp;Storage<br /><a name="l131" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l132" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-body"&gt;<br /><a name="l133" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href="/pages/lookup.php?operator=<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>"&nbsp;title="Click&nbsp;to&nbsp;look&nbsp;up&nbsp;the&nbsp;user's&nbsp;last&nbsp;ticket"&gt;&lt;i&nbsp;class="fas&nbsp;fa-link"&gt;&lt;/i&gt;&nbsp;Goto&nbsp;Last&nbsp;Ticket&lt;/a&gt;<br /><a name="l134" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l135" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l136" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l137" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l138" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;ticket&nbsp;selection<br /><a name="l139" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">elseif(!</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">2&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">))&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l140" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;class='table'&gt;<br /><a name="l141" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tickets&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">)&nbsp;{<br /><a name="l142" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;tr&gt;<br /><a name="l143" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l144" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href='./pickup.php?operator=</span><span style="color: #0000BB">$operator</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #DD0000">&amp;trans_id=</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">'&gt;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #DD0000">&lt;/a&gt;<br /><a name="l145" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l146" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;"</span><span style="color: #007700">;<br /><a name="l147" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l148" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/table&gt;"</span><span style="color: #007700">;<br /><a name="l149" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l150" /><br /><a name="l151" /><br /><a name="l152" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;pickup<br /><a name="l153" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">else<br /><a name="l154" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br /><a name="l155" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$ticket&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">$tickets</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;:&nbsp;&nbsp;new&nbsp;</span><span style="color: #0000BB">Transactions</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"trans_id"</span><span style="color: #007700">]);&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l156" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel&nbsp;panel-default"&gt;<br /><a name="l157" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-heading"&gt;<br /><a name="l158" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class="fas&nbsp;fa-ticket-alt&nbsp;fa-fw"&gt;&lt;/i&gt;&nbsp;Ticket&nbsp;#<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;<br /><a name="l159" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l160" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-body&nbsp;ticket"&gt;<br /><a name="l161" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;class="table&nbsp;table-striped&nbsp;table-bordered"&gt;<br /><a name="l162" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l163" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;class='col-md-3'&gt;Device&lt;/td&gt;<br /><a name="l164" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;class='col-md-9'&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br /><a name="l165" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l166" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l167" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Operator&lt;/td&gt;<br /><a name="l168" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l169" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="btn-group"&gt;<br /><a name="l170" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type="button"&nbsp;class="btn&nbsp;btn-default&nbsp;btn-sm&nbsp;dropdown-toggle"&nbsp;data-toggle="dropdown"&gt;<br /><a name="l171" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">icon</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;</span>&nbsp;fa-lg"&nbsp;title="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;</span>"&gt;&lt;/i&gt;<br /><a name="l172" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/button&gt;<br /><a name="l173" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&nbsp;class="dropdown-menu"&nbsp;role="menu"&gt;<br /><a name="l174" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&nbsp;style="padding-left:&nbsp;5px;"&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">operator</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;</span>&lt;/li&gt;<br /><a name="l175" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br /><a name="l176" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l177" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l178" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l179" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l180" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Ticket&lt;/td&gt;<br /><a name="l181" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br /><a name="l182" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l183" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l184" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Time&lt;/td&gt;<br /><a name="l185" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">t_start</span><span style="color: #007700">.</span><span style="color: #DD0000">"&nbsp;-&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">t_end</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br /><a name="l186" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l187" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">est_time</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l188" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l189" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Estimated&nbsp;Time&lt;/td&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l190" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">est_time</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br /><a name="l191" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l192" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l193" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><a name="l194" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">duration</span><span style="color: #007700">)&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l195" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l196" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Duration&lt;/td&gt;<br /><a name="l197" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">duration</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l198" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l199" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l200" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l201" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l202" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Current&nbsp;Status&lt;/td&gt;<br /><a name="l203" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">status</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">message</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br /><a name="l204" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l205" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l206" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;End&nbsp;Status&lt;/td&gt;<br /><a name="l207" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l208" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;width="100%"&gt;<br /><a name="l209" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l210" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l211" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;id='ticket_status'&nbsp;name='ticket_status'&nbsp;class='form-control'&nbsp;onchange='adjust_materials_status(this);'&gt;<br /><a name="l212" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;selected&nbsp;hidden&gt;SELECT&lt;/option&gt;<br /><a name="l213" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'complete'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;Complete&lt;/option&gt;<br /><a name="l214" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'partial_fail'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;Partial&nbsp;Fail&lt;/option&gt;<br /><a name="l215" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'total_fail'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;Total&nbsp;Fail&lt;/option&gt;<br /><a name="l216" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'cancelled'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;Cancelled&lt;/option&gt;<br /><a name="l217" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;<br /><a name="l218" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l219" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">StorageObject</span><span style="color: #007700">::</span><span style="color: #0000BB">object_is_in_storage</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">))&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l220" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='storage_location'&nbsp;style='padding:4px;align:right'&gt;<br /><a name="l221" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;onclick='reset_and_show_storage_modal();'&nbsp;style='background-color:#0055FF;<br /><a name="l222" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:4px&nbsp;solid&nbsp;#0055FF;border-radius:4px;padding:8px;margin:auto;color:#FFFFFF;'&gt;<br /><a name="l223" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">StorageObject</span><span style="color: #007700">::</span><span style="color: #0000BB">get_unit_for_trans_id</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l224" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;<br /><a name="l225" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l226" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;<br /><a name="l227" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}&nbsp;<br /><a name="l228" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l229" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='storage_location'&nbsp;style='padding:4px;align:right'&nbsp;hidden&gt;<br /><a name="l230" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l231" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l232" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l233" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l234" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l235" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l236" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l237" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;i&nbsp;class="fas&nbsp;fa-edit"&gt;&lt;/i&gt;Notes&lt;/td&gt;<br /><a name="l238" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l239" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;textarea&nbsp;name='ticket_notes'&nbsp;id='ticket_notes'&nbsp;<br /><a name="l240" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class="form-control"&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">notes</span><span style="color: #007700">;</span><span style="color: #0000BB">?&gt;</span>&lt;/textarea&gt;<br /><a name="l241" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l242" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l243" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l244" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&lt;!--&nbsp;end&nbsp;pannel&nbsp;body&nbsp;--&gt;<br /><a name="l245" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;!--&nbsp;end&nbsp;pannel&nbsp;--&gt;<br /><a name="l246" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!------------------&nbsp;MATERIALS&nbsp;------------------&gt;<br /><a name="l247" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l248" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;if&nbsp;materials&nbsp;associated&nbsp;with&nbsp;ticket,&nbsp;or&nbsp;materials&nbsp;can&nbsp;be&nbsp;associated&nbsp;with&nbsp;ticket<br /><a name="l249" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mats_used&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all_device_group_materials</span><span style="color: #007700">())&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l250" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel&nbsp;panel-default"&gt;<br /><a name="l251" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-heading"&gt;<br /><a name="l252" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class="fas&nbsp;fa-ticket-alt&nbsp;fa-fw"&gt;&lt;/i&gt;&nbsp;Materials<br /><a name="l253" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l254" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="panel-body"&gt;<br /><a name="l255" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id='mats_used'&gt;<br /><a name="l256" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l257" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mats_used</span><span style="color: #007700">)&nbsp;<br /><a name="l258" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">Mats_Used</span><span style="color: #007700">::</span><span style="color: #0000BB">group_mats_used_HTML</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mats_used</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l259" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l260" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l261" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all_device_group_materials</span><span style="color: #007700">())&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l262" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;class='table&nbsp;table-bordered&nbsp;table-striped'&gt;<br /><a name="l263" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class='warning'&gt;<br /><a name="l264" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;colspan='3'&gt;&nbsp;Add&nbsp;material&nbsp;&lt;/td&gt;<br /><a name="l265" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l266" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l267" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;class='col-sm-4'&gt;Material&lt;/td&gt;<br /><a name="l268" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;class='col-sm-5'&gt;<br /><a name="l269" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;id='new_material'&nbsp;name='new_material'&nbsp;class='form-control'&gt;<br /><a name="l270" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br /><a name="l271" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;allows&nbsp;for&nbsp;materials&nbsp;to&nbsp;added&nbsp;twice<br /><a name="l272" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device_group</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all_device_group_materials</span><span style="color: #007700">()&nbsp;as&nbsp;</span><span style="color: #0000BB">$material</span><span style="color: #007700">)<br /><a name="l273" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;option&nbsp;value='</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_id</span><span style="color: #DD0000">'&gt;</span><span style="color: #0000BB">$material</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">m_name</span><span style="color: #DD0000">&lt;/option&gt;"</span><span style="color: #007700">;<br /><a name="l274" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l275" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;<br /><a name="l276" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l277" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;class='col-sm-4'&gt;<br /><a name="l278" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type='button'&nbsp;name='new_material_button'&nbsp;class='btn&nbsp;btn-info'&nbsp;onclick='add_new_material_used(document.getElementById("new_material").value);'&gt;Add&nbsp;Material&lt;/button&gt;<br /><a name="l279" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l280" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l281" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l282" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l283" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;!--&nbsp;end&nbsp;pannel&nbsp;body&nbsp;--&gt;<br /><a name="l284" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&lt;!--&nbsp;end&nbsp;pannel&nbsp;&nbsp;--&gt;<br /><a name="l285" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l286" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!------------------&nbsp;COST&nbsp;AND&nbsp;SUBMIT&nbsp;------------------&gt;<br /><a name="l287" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;width='100%'&gt;<br /><a name="l288" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l289" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l290" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="button"&nbsp;value="End"&nbsp;class="btn&nbsp;btn-success"&nbsp;onclick='populate_end_modal();'/&gt;<br /><a name="l291" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l292" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align='right'&gt;<br /><a name="l293" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br /><a name="l294" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l295" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align='right'&gt;Total:&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'currency'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;&lt;/i&gt;&nbsp;&lt;/td&gt;<br /><a name="l296" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='total'&nbsp;align='right'&gt;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%0.2f"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quote_cost</span><span style="color: #007700">());&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;&lt;/td&gt;<br /><a name="l297" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l298" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">current_transaction_credit</span><span style="color: #007700">())&nbsp;{&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l299" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l300" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align='right'&gt;&nbsp;Credit:&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'currency'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;&lt;/i&gt;&nbsp;&lt;/td&gt;<br /><a name="l301" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='credit'&nbsp;align='right'&gt;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%0.2f"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">current_transaction_credit</span><span style="color: #007700">());&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l302" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l303" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br /><a name="l304" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;align='right'&gt;Remaining&nbsp;Balance:&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">'currency'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;&lt;/i&gt;&lt;/td&gt;<br /><a name="l305" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='remaining_balance'&nbsp;align='right'&gt;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%0.2f"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">remaining_balance</span><span style="color: #007700">());&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;&lt;/td&gt;<br /><a name="l306" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l307" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">}&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l308" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l309" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l310" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l311" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l312" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;!--&nbsp;end&nbsp;ticket&nbsp;--&gt;<br /><a name="l313" />&lt;/div&gt;<br /><a name="l314" /><br /><a name="l315" /><br /><a name="l316" />&lt;!--&nbsp;modal&nbsp;for&nbsp;selecting&nbsp;storage&nbsp;location&nbsp;--&gt;<br /><a name="l317" />&lt;div&nbsp;id='confirmation_modal'&nbsp;class='modal'&gt;<br /><a name="l318" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class='modal-dialog'&gt;<br /><a name="l319" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class='modal-content'&gt;<br /><a name="l320" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;method='post'&gt;<br /><a name="l321" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class='modal-header'&gt;<br /><a name="l322" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type='button'&nbsp;class='close'&nbsp;onclick='$("#confirmation_modal").hide();'&gt;&amp;times;&lt;/button&gt;<br /><a name="l323" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h4&nbsp;id='modal_title'&nbsp;class='modal-title'&gt;End&nbsp;Ticket&nbsp;#<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$trans_id</span><span style="color: #DD0000">&nbsp;on&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">device</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/h4&gt;<br /><a name="l324" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;id='chosen_ticket'&nbsp;name='chosen_ticket'&nbsp;hidden/&gt;&nbsp;&nbsp;&lt;!--&nbsp;hold&nbsp;ticket&nbsp;number&nbsp;for&nbsp;backend&nbsp;--&gt;<br /><a name="l325" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l326" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id='confirmation_body'&nbsp;class='modal-body'&gt;<br /><a name="l327" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;class='table'&gt;<br /><a name="l328" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;class='info'&gt;<br /><a name="l329" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br /><a name="l330" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h5&gt;&nbsp;Ticket&nbsp;Status&nbsp;&lt;/h5&gt;<br /><a name="l331" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l332" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id='ticket_status_confirmation'&gt;<br /><a name="l333" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br /><a name="l334" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><a name="l335" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l336" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h5&gt;&nbsp;Materials&nbsp;&lt;/h5&gt;<br /><a name="l337" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;id='material_confirmation_table'&nbsp;class='table'&gt;<br /><a name="l338" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><a name="l339" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id='storage_confirmation'&nbsp;hidden&gt;<br /><a name="l340" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h4&nbsp;id='storage_confirmation_location'&nbsp;align='center'&gt;&lt;/h4&gt;<br /><a name="l341" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l342" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id='notes_confirmation'&nbsp;name='notes_confirmation'&nbsp;hidden&gt;<br /><a name="l343" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;strong&gt;NOTES:&nbsp;&lt;/strong&gt;<br /><a name="l344" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;textarea&nbsp;id='ticket_notes_modal'&nbsp;name='ticket_notes_modal'&nbsp;class='form-control'&nbsp;width='100%'&nbsp;readonly&gt;<br /><a name="l345" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/textarea&gt;<br /><a name="l346" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l347" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l348" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class='modal-footer'&gt;<br /><a name="l349" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type='button'&nbsp;class='btn&nbsp;btn-default'&nbsp;onclick='$("#confirmation_modal").hide();'&gt;Change&nbsp;Info&lt;/button&gt;<br /><a name="l350" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type='submit'&nbsp;name='end_button'&nbsp;class='btn&nbsp;btn-success'&gt;Submit&lt;/button&gt;<br /><a name="l351" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l352" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br /><a name="l353" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l354" />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br /><a name="l355" />&lt;/div&gt;<br /><a name="l356" /><br /><a name="l357" /><span style="color: #0000BB">&lt;?php<br /><a name="l358" /></span><span style="color: #007700">}<br /><a name="l359" />include_once&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'DOCUMENT_ROOT'</span><span style="color: #007700">].</span><span style="color: #DD0000">'/pages/footer.php'</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l360" /></span><br /><a name="l361" />&lt;script&gt;<br /><a name="l362" /><br /><a name="l363" />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;COLORS&nbsp;=&nbsp;["DD00DD",&nbsp;"0F8DFF",&nbsp;"339933",&nbsp;"FFFF00",&nbsp;"888800",&nbsp;"FF0000"];<br /><a name="l364" /><br /><a name="l365" /><br /><a name="l366" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;—————————————&nbsp;INPUT-STATUS&nbsp;CONTROL&nbsp;—————————————–<br /><a name="l367" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————————————————————————————————<br /><a name="l368" />&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;This&nbsp;is&nbsp;a&nbsp;large&nbsp;chunk&nbsp;of&nbsp;the&nbsp;JS.&nbsp;&nbsp;Its&nbsp;gloal&nbsp;is&nbsp;to&nbsp;control&nbsp;the&nbsp;values&nbsp;of&nbsp;inputs&nbsp;based&nbsp;on&nbsp;<br /><a name="l369" />&nbsp;&nbsp;&nbsp;&nbsp;statuses&nbsp;and&nbsp;statuses&nbsp;based&nbsp;on&nbsp;inputs.<br /><a name="l370" />&nbsp;&nbsp;&nbsp;&nbsp;CONTROLS:<br /><a name="l371" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TICKET:<br /><a name="l372" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-A&nbsp;ticket&nbsp;status&nbsp;of&nbsp;cancelled&nbsp;with&nbsp;default&nbsp;to&nbsp;all&nbsp;materials&nbsp;being&nbsp;used.&nbsp;&nbsp;This&nbsp;way&nbsp;they&nbsp;<br /><a name="l373" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;must&nbsp;justify&nbsp;why/how&nbsp;a&nbsp;material&nbsp;is&nbsp;not&nbsp;used.&nbsp;&nbsp;Gives&nbsp;inventory/FabLab&nbsp;benefit&nbsp;of&nbsp;the&nbsp;<br /><a name="l374" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doubt.<br /><a name="l375" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-A&nbsp;ticket&nbsp;status&nbsp;of&nbsp;cancelled&nbsp;may&nbsp;not&nbsp;have&nbsp;any&nbsp;failed_mat&nbsp;statuses,&nbsp;because&nbsp;a&nbsp;failed&nbsp;&amp;<br /><a name="l376" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sellable&nbsp;ticket&nbsp;means&nbsp;it&nbsp;should&nbsp;be&nbsp;marked&nbsp;as&nbsp;partial_fail.<br /><a name="l377" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-If&nbsp;no&nbsp;materials&nbsp;are&nbsp;used,&nbsp;then&nbsp;default&nbsp;to&nbsp;total&nbsp;fail,&nbsp;because&nbsp;we&nbsp;assume&nbsp;that&nbsp;a&nbsp;ticket&nbsp;<br /><a name="l378" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failed&nbsp;before&nbsp;it&nbsp;even&nbsp;started&nbsp;is&nbsp;more&nbsp;likely&nbsp;than&nbsp;individual&nbsp;starting&nbsp;&amp;&nbsp;cancelling&nbsp;before<br /><a name="l379" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any&nbsp;cost&nbsp;accrued.<br /><a name="l380" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATERIALS:<br /><a name="l381" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-If&nbsp;all&nbsp;materials&nbsp;are&nbsp;marked&nbsp;as&nbsp;not&nbsp;failed,&nbsp;the&nbsp;ticket&nbsp;status&nbsp;is&nbsp;marked&nbsp;as&nbsp;complete.&nbsp;&nbsp;B/c<br /><a name="l382" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;materials&nbsp;that&nbsp;are&nbsp;being&nbsp;marked,&nbsp;page&nbsp;assumes&nbsp;that&nbsp;the&nbsp;user&nbsp;is&nbsp;completing&nbsp;materials<br /><a name="l383" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;individually&nbsp;and&nbsp;is&nbsp;unsure&nbsp;of&nbsp;ticket&nbsp;status.&nbsp;&nbsp;Otherwise,&nbsp;they&nbsp;would&nbsp;either&nbsp;mark&nbsp;it&nbsp;initially<br /><a name="l384" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;complete,&nbsp;or&nbsp;have&nbsp;an&nbsp;unused/failed&nbsp;material.<br /><a name="l385" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-If&nbsp;a&nbsp;mat_used&nbsp;has&nbsp;a&nbsp;status&nbsp;of&nbsp;unused,&nbsp;the&nbsp;quantity&nbsp;is&nbsp;set&nbsp;to&nbsp;0.&nbsp;If&nbsp;the&nbsp;quantity&nbsp;is&nbsp;<br /><a name="l386" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changed&nbsp;then&nbsp;the&nbsp;status&nbsp;must&nbsp;be&nbsp;reselected,&nbsp;because&nbsp;it&nbsp;is&nbsp;no&nbsp;longer&nbsp;unused.<br /><a name="l387" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-When&nbsp;a&nbsp;material&nbsp;status&nbsp;is&nbsp;set&nbsp;to&nbsp;unused,&nbsp;the&nbsp;input&nbsp;value&nbsp;is&nbsp;stored&nbsp;in&nbsp;a&nbsp;dictionary,&nbsp;in<br /><a name="l388" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;the&nbsp;user&nbsp;decides&nbsp;to&nbsp;revert&nbsp;the&nbsp;status&nbsp;or&nbsp;misclicked.<br /><a name="l389" />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><a name="l390" /><br /><a name="l391" />&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;<br /><a name="l392" />&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;to&nbsp;store&nbsp;data&nbsp;for&nbsp;quantity&nbsp;inputs&nbsp;and&nbsp;calculate/set&nbsp;quantities&nbsp;with&nbsp;methods.<br /><a name="l393" />&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;was&nbsp;chosen&nbsp;because&nbsp;it&nbsp;allows&nbsp;for&nbsp;its&nbsp;quantity&nbsp;to&nbsp;be&nbsp;available&nbsp;and&nbsp;set&nbsp;regardless&nbsp;of&nbsp;<br /><a name="l394" />&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;the&nbsp;input&nbsp;is&nbsp;a&nbsp;time.&nbsp;&nbsp;It&nbsp;takes&nbsp;the&nbsp;parameter&nbsp;of&nbsp;a&nbsp;input&nbsp;element,&nbsp;finds&nbsp;it&nbsp;(and&nbsp;its&nbsp;<br /><a name="l395" />&nbsp;&nbsp;&nbsp;&nbsp;associated&nbsp;elements&nbsp;ie&nbsp;time,&nbsp;parent,&nbsp;status).<br /><a name="l396" />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><a name="l397" />&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Input&nbsp;{<br /><a name="l398" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructor(input)&nbsp;{<br /><a name="l399" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.mu_id&nbsp;=&nbsp;input.id.substr(0,&nbsp;input.id.indexOf('-'));<br /><a name="l400" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element;&nbsp;<br /><a name="l401" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.is_time_based;<br /><a name="l402" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.initialize_element_and_type(input);<br /><a name="l403" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.subtotal&nbsp;=&nbsp;this.subtotal_from_classes(input);<br /><a name="l404" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.price&nbsp;=&nbsp;parseFloat(input.parentElement.children[0].innerHTML.match(/\d+(\.\d+)?/g));<br /><a name="l405" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.status&nbsp;=&nbsp;document.getElementById(this.mu_id+"-select");<br /><a name="l406" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l407" /><br /><a name="l408" /><br /><a name="l409" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;input&nbsp;is&nbsp;time&nbsp;based&nbsp;assign&nbsp;appropriate&nbsp;elements&nbsp;for&nbsp;it<br /><a name="l410" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initialize_element_and_type(input)&nbsp;{<br /><a name="l411" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(input.classList.contains("time"))&nbsp;<br /><a name="l412" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element&nbsp;=&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;"hour"&nbsp;:&nbsp;document.getElementById(this.mu_id+"-input"),&nbsp;<br /><a name="l413" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"min"&nbsp;:&nbsp;document.getElementById(this.mu_id+"-minute")},&nbsp;<br /><a name="l414" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.is_time_based&nbsp;=&nbsp;true;<br /><a name="l415" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l416" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element&nbsp;=&nbsp;input<br /><a name="l417" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.is_time_based&nbsp;=&nbsp;false;<br /><a name="l418" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l419" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l420" /><br /><a name="l421" /><br /><a name="l422" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return&nbsp;numeric&nbsp;quantity&nbsp;for&nbsp;input(s)&nbsp;associated<br /><a name="l423" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity()&nbsp;{<br /><a name="l424" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!this.is_time_based)&nbsp;return&nbsp;parseFloat(this.element.value);<br /><a name="l425" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parseFloat(this.element['hour'].value)&nbsp;+&nbsp;parseFloat(this.element['min'].value)&nbsp;/&nbsp;60;<br /><a name="l426" /><br /><a name="l427" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l428" /><br /><a name="l429" /><br /><a name="l430" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;set&nbsp;quantity&nbsp;based&nbsp;on&nbsp;quantity&nbsp;passed&nbsp;and&nbsp;parse&nbsp;into&nbsp;hour/minute&nbsp;if&nbsp;necessary<br /><a name="l431" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_val(quantity)&nbsp;{<br /><a name="l432" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!this.is_time_based)&nbsp;this.element.value&nbsp;=&nbsp;parseFloat(quantity);<br /><a name="l433" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<br /><a name="l434" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hour&nbsp;=&nbsp;parseInt(quantity);<br /><a name="l435" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;minute&nbsp;=&nbsp;(quantity&nbsp;-&nbsp;hour)&nbsp;*&nbsp;60;<br /><a name="l436" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element["hour"].value&nbsp;=&nbsp;hour;<br /><a name="l437" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.element["min"].value&nbsp;=&nbsp;round(minute,&nbsp;2);<br /><a name="l438" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l439" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l440" /><br /><a name="l441" /><br /><a name="l442" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;retrieve&nbsp;the&nbsp;parent&nbsp;name&nbsp;of&nbsp;a&nbsp;class&nbsp;(&lt;parent_name&gt;-input);&nbsp;return&nbsp;null&nbsp;if&nbsp;no&nbsp;parent&nbsp;name<br /><a name="l443" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtotal_from_classes(input)&nbsp;{<br /><a name="l444" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;input.classList.length;&nbsp;x++)<br /><a name="l445" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(input.classList[x].includes("-input"))<br /><a name="l446" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;document.getElementById(input.classList[x].substr(0,&nbsp;input.classList[x].indexOf('-input'))+"-subtotal");<br /><a name="l447" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br /><a name="l448" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l449" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l450" /><br /><a name="l451" /><br /><a name="l452" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;{'mu_id'&nbsp;:&nbsp;quantity,&nbsp;etc.}&nbsp;to&nbsp;hold&nbsp;values&nbsp;before&nbsp;status&nbsp;switching&nbsp;causes&nbsp;value&nbsp;to&nbsp;equal&nbsp;0<br /><a name="l453" />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;previous_mats_used_quantities&nbsp;=&nbsp;{};<br /><a name="l454" /><br /><a name="l455" /><br /><a name="l456" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;————–————&nbsp;QUANTITY&nbsp;CHILD-PARENT&nbsp;CALCULATION&nbsp;——————————<br /><a name="l457" /><br /><a name="l458" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;group&nbsp;total&nbsp;is&nbsp;changed,&nbsp;change&nbsp;individual&nbsp;units&nbsp;used&nbsp;proportionally&nbsp;for&nbsp;new&nbsp;total<br /><a name="l459" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_children_input(parent_input)&nbsp;{<br /><a name="l460" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;children&nbsp;=&nbsp;children_input_objects(parent_input.id.substr(0,&nbsp;parent_input.id.indexOf("-subtotal")));<br /><a name="l461" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;quantity_sum&nbsp;=&nbsp;0;<br /><a name="l462" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;previous&nbsp;sum&nbsp;&amp;&nbsp;create&nbsp;input&nbsp;objects<br /><a name="l463" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;children.length;&nbsp;x++)&nbsp;{<br /><a name="l464" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isNaN(children[x].quantity()))<br /><a name="l465" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity_sum&nbsp;+=&nbsp;children[x].quantity();<br /><a name="l466" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;console.log(children[x]);&nbsp;&nbsp;//&nbsp;error&nbsp;checking<br /><a name="l467" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l468" /><br /><a name="l469" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;children.length;&nbsp;x++)<br /><a name="l470" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;children[x].set_val(round(children[x].quantity()&nbsp;/&nbsp;quantity_sum&nbsp;*&nbsp;parent_input.value,&nbsp;2));<br /><a name="l471" /><br /><a name="l472" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adjust_balances();<br /><a name="l473" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l474" /><br /><a name="l475" /><br /><a name="l476" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;individual&nbsp;units&nbsp;used&nbsp;are&nbsp;changed,&nbsp;change&nbsp;group&nbsp;total&nbsp;units&nbsp;for&nbsp;new&nbsp;individual;&nbsp;adjust&nbsp;statuses<br /><a name="l477" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_parent_input(child_input_element)&nbsp;{<br /><a name="l478" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mu_input&nbsp;=&nbsp;new&nbsp;Input(child_input_element);<br /><a name="l479" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!mu_input.subtotal)&nbsp;return;&nbsp;&nbsp;//&nbsp;ignore&nbsp;ungrouped&nbsp;elements<br /><a name="l480" /><br /><a name="l481" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;children&nbsp;=&nbsp;children_input_objects(mu_input.subtotal.id.substr(0,&nbsp;mu_input.subtotal.id.indexOf("-subtotal")));<br /><a name="l482" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;group_total&nbsp;=&nbsp;0;<br /><a name="l483" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;children.length;&nbsp;x++)&nbsp;{<br /><a name="l484" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isNaN(children[x].quantity()))<br /><a name="l485" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group_total&nbsp;+=&nbsp;children[x].quantity();<br /><a name="l486" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;console.log(children[x]);&nbsp;&nbsp;//&nbsp;error&nbsp;checking<br /><a name="l487" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l488" /><br /><a name="l489" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu_input.subtotal.value&nbsp;=&nbsp;group_total;<br /><a name="l490" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l491" /><br /><a name="l492" /><br /><a name="l493" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;——————————–———&nbsp;COST&nbsp;CALCULATION&nbsp;———————————————<br /><a name="l494" /><br /><a name="l495" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;each&nbsp;mat&nbsp;used&nbsp;changes,&nbsp;calculate&nbsp;total&nbsp;cost&nbsp;(&amp;&nbsp;remaining&nbsp;balance)&nbsp;for&nbsp;units&nbsp;provided<br /><a name="l496" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_balances()&nbsp;{<br /><a name="l497" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;total&nbsp;=&nbsp;calculate_total();<br /><a name="l498" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;remaining_balance&nbsp;=&nbsp;calculate_remaining_balance(total);<br /><a name="l499" /><br /><a name="l500" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("total").innerHTML&nbsp;=&nbsp;round(total,&nbsp;2);<br /><a name="l501" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById("credit"))<br /><a name="l502" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("remaining_balance").innerHTML&nbsp;=&nbsp;round(remaining_balance,&nbsp;2);<br /><a name="l503" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l504" /><br /><a name="l505" /><br /><a name="l506" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;total&nbsp;cost&nbsp;for&nbsp;all&nbsp;materials&nbsp;used&nbsp;without&nbsp;fail&nbsp;(does&nbsp;not&nbsp;include&nbsp;credit)<br /><a name="l507" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;calculate_total()&nbsp;{<br /><a name="l508" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mats_used&nbsp;=&nbsp;create_inputs_by_class_name("mat_used_input");<br /><a name="l509" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;total&nbsp;=&nbsp;0;<br /><a name="l510" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;mats_used.length;&nbsp;x++)<br /><a name="l511" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(mats_used[x].status.value&nbsp;!=&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'unused'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;&amp;&amp;&nbsp;mats_used[x].status.value&nbsp;!=&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'failed_mat'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l512" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;+=&nbsp;mats_used[x].quantity()&nbsp;*&nbsp;mats_used[x].price;<br /><a name="l513" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;total;<br /><a name="l514" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l515" /><br /><a name="l516" /><br /><a name="l517" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;amount&nbsp;to&nbsp;be&nbsp;charged&nbsp;<br /><a name="l518" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;calculate_remaining_balance(total=null)&nbsp;{<br /><a name="l519" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;credit&nbsp;=&nbsp;document.getElementById("credit");<br /><a name="l520" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!credit)&nbsp;return;&nbsp;&nbsp;//&nbsp;no&nbsp;credit&nbsp;found;&nbsp;no&nbsp;need&nbsp;to&nbsp;try&nbsp;to&nbsp;caluclate&nbsp;remaining&nbsp;balance<br /><a name="l521" /><br /><a name="l522" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;credit&nbsp;=&nbsp;parseFloat(credit.innerHTML);<br /><a name="l523" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(total)&nbsp;return&nbsp;total&nbsp;-&nbsp;credit;&nbsp;&nbsp;//&nbsp;option&nbsp;to&nbsp;save&nbsp;the&nbsp;resources<br /><a name="l524" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;calculate_total()&nbsp;-&nbsp;credit;<br /><a name="l525" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l526" /><br /><a name="l527" /><br /><a name="l528" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;—————————————————&nbsp;STATUS&nbsp;—————————————————<br /><a name="l529" /><br /><a name="l530" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;————&nbsp;TICKET-MAT_USED&nbsp;RELATIONSHIP&nbsp;————<br /><a name="l531" /><br /><a name="l532" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;material&nbsp;status&nbsp;changed:&nbsp;adjust&nbsp;ticket&nbsp;status<br /><a name="l533" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_ticket_status(status_element)&nbsp;{<br /><a name="l534" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;all&nbsp;materials&nbsp;being&nbsp;used&nbsp;(!failed)&nbsp;means&nbsp;ticket&nbsp;was&nbsp;complete<br /><a name="l535" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(all_material_status_are(<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'used'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>))&nbsp;<br /><a name="l536" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("ticket_status").value&nbsp;=&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'complete'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>;<br /><a name="l537" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;no&nbsp;materials&nbsp;were&nbsp;used&nbsp;then&nbsp;nothing&nbsp;is&nbsp;usable&nbsp;and&nbsp;is&nbsp;a&nbsp;total&nbsp;fail<br /><a name="l538" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(all_material_status_are(<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'unused'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>))&nbsp;<br /><a name="l539" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("ticket_status").value&nbsp;=&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'total_fail'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>;<br /><a name="l540" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l541" /><br /><a name="l542" /><br /><a name="l543" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ticket&nbsp;status&nbsp;has&nbsp;been&nbsp;changed:&nbsp;adjust&nbsp;materials'&nbsp;statuses<br /><a name="l544" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_materials_status(ticket_status_object)&nbsp;{<br /><a name="l545" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("storage_location").innerHTML&nbsp;=&nbsp;"";&nbsp;&nbsp;//&nbsp;clear&nbsp;prior&nbsp;storage&nbsp;location<br /><a name="l546" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ticket_status&nbsp;=&nbsp;ticket_status_object.value;<br /><a name="l547" /><br /><a name="l548" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;cancelled&nbsp;included&nbsp;b/c&nbsp;user&nbsp;more&nbsp;willing&nbsp;to&nbsp;check&nbsp;off&nbsp;what&nbsp;they&nbsp;didn't&nbsp;use<br /><a name="l549" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(ticket_status&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"stored"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;||&nbsp;ticket_status&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"complete"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;||<br /><a name="l550" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ticket_status&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"cancelled"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l551" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_status_for_all_materials_to_used_if_status_quantity_not_null();<br /><a name="l552" /><br /><a name="l553" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;cancelled&nbsp;tickets&nbsp;are&nbsp;not&nbsp;allowed&nbsp;to&nbsp;have&nbsp;any&nbsp;failed_mat&nbsp;statuses<br /><a name="l554" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(ticket_status&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'cancelled'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l555" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(`.mat_used_select&nbsp;option[value='${<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'failed_mat'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>}']`).hide();<br /><a name="l556" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;$(`.mat_used_select&nbsp;option[value='${<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'failed_mat'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>}']`).show();<br /><a name="l557" /><br /><a name="l558" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(ticket_status&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"stored"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l559" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reset_and_show_storage_modal();<br /><a name="l560" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l561" /><br /><a name="l562" /><br /><a name="l563" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;————&nbsp;INPUT-STATUS&nbsp;RELATIONSHIP&nbsp;————<br /><a name="l564" /><br /><a name="l565" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;change&nbsp;value&nbsp;to&nbsp;0&nbsp;if&nbsp;not&nbsp;used;&nbsp;reset&nbsp;value&nbsp;if&nbsp;changed&nbsp;back<br /><a name="l566" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_input_for_status(status_element)&nbsp;{<br /><a name="l567" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input&nbsp;=&nbsp;input_for_status(status_element);<br /><a name="l568" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;prevent&nbsp;unused&nbsp;materials&nbsp;from&nbsp;having&nbsp;any&nbsp;quantity<br /><a name="l569" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(parseInt(status_element.value)&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'unused'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)&nbsp;{<br /><a name="l570" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;store&nbsp;previous&nbsp;value&nbsp;into&nbsp;dictionary&nbsp;for&nbsp;mu_id&nbsp;for&nbsp;reverting&nbsp;when&nbsp;changing&nbsp;status&nbsp;back&nbsp;from&nbsp;unused<br /><a name="l571" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previous_mats_used_quantities[input.mu_id]&nbsp;=&nbsp;input.quantity();<br /><a name="l572" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.set_val(0);<br /><a name="l573" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l574" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(!input.quantity()&nbsp;&amp;&amp;&nbsp;previous_mats_used_quantities[input.mu_id])&nbsp;{<br /><a name="l575" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.set_val(previous_mats_used_quantities[input.mu_id]);<br /><a name="l576" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;previous_mats_used_quantities[input.mu_id];&nbsp;&nbsp;//&nbsp;inaccurate&nbsp;replacements<br /><a name="l577" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l578" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;recalulate&nbsp;amounts<br /><a name="l579" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;input_element&nbsp;=&nbsp;document.getElementById(input.mu_id+"-input");<br /><a name="l580" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adjust_parent_input(input_element);<br /><a name="l581" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adjust_balances();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l582" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l583" /><br /><a name="l584" /><br /><a name="l585" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;auto&nbsp;select&nbsp;statuses&nbsp;based&nbsp;on&nbsp;input&nbsp;values<br /><a name="l586" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;adjust_status_for_input(input_element)&nbsp;{<br /><a name="l587" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mu_input&nbsp;=&nbsp;new&nbsp;Input(input_element);<br /><a name="l588" /><br /><a name="l589" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;don't&nbsp;allow&nbsp;non-zero&nbsp;elements&nbsp;to&nbsp;have&nbsp;"unused"&nbsp;status<br /><a name="l590" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(mu_input.quantity()&nbsp;&amp;&amp;&nbsp;mu_input.status.value&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'unused'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l591" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu_input.status.selectedIndex&nbsp;=&nbsp;"0";<br /><a name="l592" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;don't&nbsp;allow&nbsp;zero&nbsp;values&nbsp;to&nbsp;have&nbsp;status&nbsp;of&nbsp;used&nbsp;or&nbsp;failed<br /><a name="l593" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(!mu_input.quantity())<br /><a name="l594" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu_input.status.value&nbsp;=&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'unused'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>;<br /><a name="l595" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l596" /><br /><a name="l597" /><br /><a name="l598" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;————&nbsp;STATUS&nbsp;UTILITY&nbsp;————<br /><a name="l599" /><br /><a name="l600" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;if&nbsp;all&nbsp;of&nbsp;the&nbsp;materials&nbsp;have&nbsp;the&nbsp;same&nbsp;status&nbsp;as&nbsp;status&nbsp;passed<br /><a name="l601" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;all_material_status_are(status)&nbsp;{<br /><a name="l602" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;materials_statuses&nbsp;=&nbsp;document.getElementsByClassName("mat_used_select");<br /><a name="l603" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;materials_statuses.length;&nbsp;x++)&nbsp;<br /><a name="l604" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(parseInt(materials_statuses[x].value)&nbsp;!=&nbsp;status)&nbsp;return&nbsp;false;<br /><a name="l605" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br /><a name="l606" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l607" /><br /><a name="l608" /><br /><a name="l609" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return&nbsp;Input&nbsp;object&nbsp;for&nbsp;a&nbsp;status&nbsp;element<br /><a name="l610" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;input_for_status(status_object)&nbsp;{<br /><a name="l611" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mat_used_id&nbsp;=&nbsp;mat_used_id_of_element(status_object);<br /><a name="l612" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Input(document.getElementById(mat_used_id+"-input"));<br /><a name="l613" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l614" /><br /><a name="l615" /><br /><a name="l616" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;<br /><a name="l617" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;set_status_for_all_materials_to_used_if_status_quantity_not_null()&nbsp;{<br /><a name="l618" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;materials_statuses&nbsp;=&nbsp;document.getElementsByClassName("mat_used_select");<br /><a name="l619" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;materials_statuses.length;&nbsp;x++)<br /><a name="l620" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;a&nbsp;material&nbsp;is&nbsp;measurable&nbsp;&amp;&amp;&nbsp;not&nbsp;used&nbsp;if&nbsp;its&nbsp;value&nbsp;is&nbsp;0<br /><a name="l621" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(materials_statuses[x].classList.contains("measurable")&nbsp;&amp;&amp;&nbsp;input_for_status(materials_statuses[x]).quantity())<br /><a name="l622" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;materials_statuses[x].value&nbsp;=&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"used"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>;<br /><a name="l623" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l624" /><br /><a name="l625" /><br /><a name="l626" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;—————————————&nbsp;ADD&nbsp;NEW&nbsp;MATERIAL&nbsp;USED&nbsp;—————————————<br /><a name="l627" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————————————————————————————————<br /><a name="l628" /><br /><a name="l629" />&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;AJAX:&nbsp;add&nbsp;mat_used&nbsp;to&nbsp;DB&nbsp;for&nbsp;transaction.&nbsp;&nbsp;If&nbsp;preexisting&nbsp;group,&nbsp;add&nbsp;material&nbsp;to&nbsp;group.<br /><a name="l630" />&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;preexisting&nbsp;(ungrouped)&nbsp;material,&nbsp;create&nbsp;group.&nbsp;&nbsp;Otherwise,&nbsp;add&nbsp;material&nbsp;input&nbsp;to&nbsp;end<br /><a name="l631" />&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;table.&nbsp;*/<br /><a name="l632" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;add_new_material_used(m_id)&nbsp;{<br /><a name="l633" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isNaN(parseInt(m_id)))&nbsp;return;<br /><a name="l634" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!confirm("Are&nbsp;you&nbsp;sure&nbsp;you&nbsp;would&nbsp;like&nbsp;to&nbsp;add&nbsp;another&nbsp;material&nbsp;to&nbsp;this&nbsp;transaction?"))&nbsp;return;<br /><a name="l635" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l636" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add_new_material:&nbsp;request&nbsp;function&nbsp;from&nbsp;page&nbsp;(new&nbsp;material&nbsp;instance&nbsp;created,&nbsp;return&nbsp;HTML)<br /><a name="l637" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;edit_request:&nbsp;request&nbsp;coming&nbsp;from&nbsp;edit.php&nbsp;(add&nbsp;functions/staff&nbsp;row)<br /><a name="l638" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.ajax({<br /><a name="l639" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:&nbsp;"./sub/material_ajax_requests.php",<br /><a name="l640" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;"POST",<br /><a name="l641" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;"json",<br /><a name="l642" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;"add_new_material"&nbsp;:&nbsp;true,&nbsp;<br /><a name="l643" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"m_id"&nbsp;:&nbsp;m_id,<br /><a name="l644" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"trans_id"&nbsp;:&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$ticket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trans_id</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;<br /><a name="l645" /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br /><a name="l646" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(response)&nbsp;{<br /><a name="l647" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(response);<br /><a name="l648" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(response["error"])&nbsp;{<br /><a name="l649" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(response["error"]);<br /><a name="l650" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br /><a name="l651" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l652" /><br /><a name="l653" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update_material_display(response);<br /><a name="l654" /><br /><a name="l655" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("Successfully&nbsp;added&nbsp;"+response["material_name"]+"&nbsp;to&nbsp;materials");<br /><a name="l656" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(`#new_material`).val("");<br /><a name="l657" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l658" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br /><a name="l659" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l660" /><br /><a name="l661" /><br /><a name="l662" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;split&nbsp;material&nbsp;used&nbsp;into&nbsp;two&nbsp;mat_used&nbsp;instances&nbsp;with&nbsp;the&nbsp;same&nbsp;material<br /><a name="l663" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;split(m_id)&nbsp;{<br /><a name="l664" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_new_material_used(m_id);<br /><a name="l665" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l666" /><br /><a name="l667" /><br /><a name="l668" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;mat_used&nbsp;to&nbsp;page<br /><a name="l669" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;update_material_display(response)&nbsp;{<br /><a name="l670" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;delete&nbsp;newly&nbsp;grouped&nbsp;prior&nbsp;instance&nbsp;from&nbsp;page<br /><a name="l671" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(response["grouplength"]&nbsp;==&nbsp;2)<br /><a name="l672" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementsByClassName(`${response["parent_id"]}-child`)[0].parentElement.closest("table").remove();<br /><a name="l673" /><br /><a name="l674" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;to&nbsp;table&nbsp;(1,&nbsp;2)&nbsp;(3)<br /><a name="l675" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(response["grouplength"]&nbsp;&lt;&nbsp;3)<br /><a name="l676" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("mats_used").innerHTML&nbsp;+=&nbsp;response["material_HTML"];<br /><a name="l677" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br /><a name="l678" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(`${response["parent_id"]}-children_display_row`).children[0].innerHTML&nbsp;+=&nbsp;response["material_HTML"];<br /><a name="l679" /><br /><a name="l680" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;new_mat_used&nbsp;=&nbsp;document.getElementById(response["mu_id"]+"-table");<br /><a name="l681" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;color&nbsp;if&nbsp;new&nbsp;group&nbsp;(2)&nbsp;(do&nbsp;not&nbsp;need&nbsp;for&nbsp;grouplength&nbsp;of&nbsp;1&nbsp;b/c&nbsp;automatically&nbsp;highlighted)<br /><a name="l682" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(response["grouplength"]&nbsp;==&nbsp;2)&nbsp;{<br /><a name="l683" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;new_entrant&nbsp;=&nbsp;new_mat_used.parentElement.closest("table");<br /><a name="l684" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;color&nbsp;=&nbsp;COLORS[new_entrant.parentElement.children.length-1&nbsp;%&nbsp;COLORS.length];<br /><a name="l685" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_entrant.style["border-left"]&nbsp;=&nbsp;`#${color}&nbsp;2px&nbsp;solid`;&nbsp;&nbsp;//&nbsp;add&nbsp;color&nbsp;to&nbsp;part<br /><a name="l686" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_entrant.getElementsByTagName("td")[0].style["background-color"]&nbsp;=&nbsp;`#${color}`;&nbsp;&nbsp;//&nbsp;color&nbsp;top&nbsp;bar&nbsp;(row)&nbsp;of&nbsp;table<br /><a name="l687" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l688" /><br /><a name="l689" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;highlight&nbsp;table&nbsp;and&nbsp;scroll&nbsp;to&nbsp;change&nbsp;(*)<br /><a name="l690" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_mat_used.style.border&nbsp;=&nbsp;"#00FF00&nbsp;8px&nbsp;solid";<br /><a name="l691" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location.href&nbsp;=&nbsp;`#${response["mu_id"]}-table`;<br /><a name="l692" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l693" /><br /><a name="l694" /><br /><a name="l695" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;————————————–——&nbsp;END&nbsp;CONFIRMATION&nbsp;——————————————<br /><a name="l696" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————————————————————————————————<br /><a name="l697" /><br /><a name="l698" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;to&nbsp;make&nbsp;sure&nbsp;information&nbsp;is&nbsp;properly&nbsp;filled&nbsp;out<br /><a name="l699" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;table_is_not_properly_populated(materials,&nbsp;ticket_status)&nbsp;{<br /><a name="l700" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isNaN(ticket_status.value))&nbsp;{<br /><a name="l701" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("Please&nbsp;select&nbsp;a&nbsp;ticket&nbsp;status");<br /><a name="l702" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br /><a name="l703" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l704" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if((ticket_status.value&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"partial_fail"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;||&nbsp;ticket_status.value&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">"total_fail"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l705" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;document.getElementById("ticket_notes").value.length&nbsp;&lt;&nbsp;10)&nbsp;{<br /><a name="l706" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("You&nbsp;must&nbsp;state&nbsp;how&nbsp;the&nbsp;ticket&nbsp;failed");<br /><a name="l707" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br /><a name="l708" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l709" /><br /><a name="l710" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;mats_used&nbsp;listed&nbsp;but&nbsp;none&nbsp;accounted&nbsp;for:&nbsp;error&nbsp;in&nbsp;get_and_sort_materials()<br /><a name="l711" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!materials&nbsp;&amp;&amp;&nbsp;document.getElementsByClassName("mat_used_select").length)&nbsp;return&nbsp;true;<br /><a name="l712" /><br /><a name="l713" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;no&nbsp;material&nbsp;is&nbsp;marked&nbsp;as&nbsp;failed&nbsp;&amp;&amp;&nbsp;not&nbsp;all&nbsp;are&nbsp;unused:&nbsp;a&nbsp;failed&nbsp;ticket&nbsp;requires&nbsp;a&nbsp;fail&nbsp;material&nbsp;or&nbsp;all&nbsp;to&nbsp;be&nbsp;null<br /><a name="l714" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((ticket_status.value&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'partial_fail'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;||&nbsp;ticket_status.value&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'total_fail'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)<br /><a name="l715" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;(!any(materials,&nbsp;function(part,&nbsp;value)&nbsp;{return&nbsp;part['status'].value&nbsp;==&nbsp;value;},&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'failed_mat'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)&nbsp;<br /><a name="l716" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;any(materials,&nbsp;function(part,&nbsp;value)&nbsp;{return&nbsp;part['status'].value&nbsp;!=&nbsp;value;},&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'unused'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>)))&nbsp;{<br /><a name="l717" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(&nbsp;&nbsp;&nbsp;&nbsp;"Ticket&nbsp;is&nbsp;marked&nbsp;as&nbsp;failed,&nbsp;but&nbsp;no&nbsp;failed&nbsp;material&nbsp;is&nbsp;indicated.\n"+<br /><a name="l718" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Please&nbsp;indicate&nbsp;which&nbsp;material&nbsp;was&nbsp;failed&nbsp;on&nbsp;usage.\n"+<br /><a name="l719" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"If&nbsp;no&nbsp;materials&nbsp;were&nbsp;used,&nbsp;please&nbsp;mark&nbsp;all&nbsp;materials&nbsp;as&nbsp;unused.");<br /><a name="l720" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br /><a name="l721" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l722" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br /><a name="l723" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l724" /><br /><a name="l725" /><br /><a name="l726" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;information&nbsp;from&nbsp;page&nbsp;and&nbsp;put&nbsp;into&nbsp;confirmation&nbsp;modal<br /><a name="l727" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;populate_end_modal()&nbsp;{<br /><a name="l728" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;----&nbsp;ticket&nbsp;----<br /><a name="l729" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ticket_status&nbsp;=&nbsp;document.getElementById("ticket_status");<br /><a name="l730" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ticket_status_name&nbsp;=&nbsp;ticket_status.options[ticket_status.selectedIndex].text;<br /><a name="l731" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l732" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("ticket_status_confirmation").innerHTML&nbsp;=&nbsp;<br /><a name="l733" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;confirmation_cell_format('ticket_status',&nbsp;`&lt;h5&gt;${ticket_status_name}&lt;/h5&gt;`,&nbsp;ticket_status.value);<br /><a name="l734" /><br /><a name="l735" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;materials&nbsp;=&nbsp;get_and_sort_materials();<br /><a name="l736" /><br /><a name="l737" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(table_is_not_properly_populated(materials,&nbsp;ticket_status))&nbsp;return;&nbsp;&nbsp;//&nbsp;error&nbsp;checking<br /><a name="l738" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;populate_material_table(materials);<br /><a name="l739" /><br /><a name="l740" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;----&nbsp;storage&nbsp;----<br /><a name="l741" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;storage_confirmation&nbsp;=&nbsp;document.getElementById("storage_confirmation_location");<br /><a name="l742" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;storage_confirmation.innerHTML&nbsp;=&nbsp;"";&nbsp;&nbsp;//&nbsp;clear&nbsp;prior&nbsp;storage&nbsp;location<br /><a name="l743" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById("storage_location").children.length)&nbsp;{<br /><a name="l744" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$("#storage_confirmation").show();<br /><a name="l745" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;box_id&nbsp;=&nbsp;document.getElementById("storage_location").children[0].innerHTML;<br /><a name="l746" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;span&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&lt;span&nbsp;style='background-color:#0055FF;border:4px&nbsp;solid&nbsp;#0055FF;"+<br /><a name="l747" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"border-radius:4px;padding:8px;margin:auto;color:#FFFFFF;margin:auto'&gt;"+<br /><a name="l748" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Currently&nbsp;stored&nbsp;in&nbsp;"+box_id+"&lt;/span&gt;";<br /><a name="l749" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;storage_confirmation.innerHTML&nbsp;=&nbsp;confirmation_cell_format("storage",&nbsp;span,&nbsp;box_id.replace("-",&nbsp;""));<br /><a name="l750" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l751" /><br /><a name="l752" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById("ticket_notes").value)&nbsp;{<br /><a name="l753" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("notes_confirmation").hidden&nbsp;=&nbsp;false;<br /><a name="l754" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("ticket_notes_modal").innerHTML&nbsp;=&nbsp;<br /><a name="l755" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("ticket_notes").value;<br /><a name="l756" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l757" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;document.getElementById("notes_confirmation").innerHTML&nbsp;=&nbsp;"";<br /><a name="l758" /><br /><a name="l759" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$("#confirmation_modal").show();<br /><a name="l760" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l761" /><br /><a name="l762" /><br /><a name="l763" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;————&nbsp;MATERIALS&nbsp;————<br /><a name="l764" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;—&nbsp;DATA&nbsp;COLLECTION&nbsp;—<br /><a name="l765" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;materials&nbsp;by&nbsp;class;&nbsp;get&nbsp;inputs,&nbsp;selects,&nbsp;m_name,&nbsp;mu_id&nbsp;&amp;&nbsp;add&nbsp;to&nbsp;dict;&nbsp;dict&nbsp;to&nbsp;array<br /><a name="l766" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;get_and_sort_materials()&nbsp;{<br /><a name="l767" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;materials&nbsp;=&nbsp;[];<br /><a name="l768" /><br /><a name="l769" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;measurable&nbsp;materials&nbsp;to&nbsp;mat&nbsp;list<br /><a name="l770" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;materials_inputs&nbsp;=&nbsp;create_inputs_by_class_name("mat_used_input");<br /><a name="l771" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;materials_inputs.length;&nbsp;x++)&nbsp;{<br /><a name="l772" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;material&nbsp;=&nbsp;dictionary_of_measurable_material(materials_inputs[x]);<br /><a name="l773" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!material)&nbsp;return&nbsp;null;&nbsp;&nbsp;//&nbsp;submission&nbsp;error:&nbsp;end&nbsp;process<br /><a name="l774" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;materials.push(material);<br /><a name="l775" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l776" /><br /><a name="l777" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;immeasurable&nbsp;materials&nbsp;to&nbsp;mat&nbsp;list<br /><a name="l778" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;immeasurable_select&nbsp;=&nbsp;document.getElementsByClassName("immeasurable");<br /><a name="l779" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;immeasurable_select.length;&nbsp;x++)<br /><a name="l780" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;materials.push(dictionary_for_immeasurable_material(immeasurable_select[x]));<br /><a name="l781" /><br /><a name="l782" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;materials;<br /><a name="l783" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l784" /><br /><a name="l785" /><br /><a name="l786" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;dictionary&nbsp;for&nbsp;the&nbsp;materials&nbsp;that&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;quantity<br /><a name="l787" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;dictionary_for_immeasurable_material(immeasurable_select)&nbsp;{<br /><a name="l788" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;name&nbsp;=&nbsp;material_name(immeasurable_select);<br /><a name="l789" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;status&nbsp;=&nbsp;immeasurable_select;<br /><a name="l790" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mu_id&nbsp;=&nbsp;immeasurable_select.id.substr(0,&nbsp;immeasurable_select.id.indexOf('-'));<br /><a name="l791" /><br /><a name="l792" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{"mu_id"&nbsp;:&nbsp;mu_id,&nbsp;"name"&nbsp;:&nbsp;name,&nbsp;"status"&nbsp;:&nbsp;status,&nbsp;"immeasurable"&nbsp;:&nbsp;true};<br /><a name="l793" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l794" /><br /><a name="l795" /><br /><a name="l796" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;dictionary&nbsp;for&nbsp;the&nbsp;materials&nbsp;that&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;quantity<br /><a name="l797" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;dictionary_of_measurable_material(material)&nbsp;{<br /><a name="l798" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;cost&nbsp;=&nbsp;material.quantity()&nbsp;*&nbsp;material.price;<br /><a name="l799" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;name&nbsp;=&nbsp;material_name(material.status);<br /><a name="l800" /><br /><a name="l801" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;--error/logic&nbsp;checking<br /><a name="l802" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isNaN(parseFloat(material.status.value)))&nbsp;{<br /><a name="l803" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("Please&nbsp;select&nbsp;a&nbsp;status&nbsp;for&nbsp;"+name);<br /><a name="l804" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br /><a name="l805" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l806" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(material.status.value&nbsp;==&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">[</span><span style="color: #DD0000">'used'</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>&nbsp;&amp;&amp;&nbsp;!material.quantity())&nbsp;{&nbsp;<br /><a name="l807" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("Material&nbsp;status&nbsp;cannot&nbsp;be&nbsp;used&nbsp;with&nbsp;a&nbsp;0&nbsp;quantity&nbsp;for&nbsp;"+name);<br /><a name="l808" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br /><a name="l809" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l810" /><br /><a name="l811" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{'mu_id'&nbsp;:&nbsp;material.mu_id,&nbsp;'name'&nbsp;:&nbsp;name,&nbsp;'cost'&nbsp;:&nbsp;cost,&nbsp;'quantity'&nbsp;:&nbsp;material.quantity(),&nbsp;'status'&nbsp;:&nbsp;material.status};<br /><a name="l812" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l813" /><br /><a name="l814" /><br /><a name="l815" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;—&nbsp;MODAL&nbsp;BUILDING&nbsp;—<br /><a name="l816" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;using&nbsp;the&nbsp;material&nbsp;dictionary,&nbsp;add&nbsp;values&nbsp;to&nbsp;material&nbsp;table&nbsp;in&nbsp;modal<br /><a name="l817" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;populate_material_table(materials)&nbsp;{<br /><a name="l818" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$("#material_confirmation_table&nbsp;tr").remove();&nbsp;&nbsp;//&nbsp;clear&nbsp;previous&nbsp;entries<br /><a name="l819" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!materials)&nbsp;return;<br /><a name="l820" /><br /><a name="l821" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;table&nbsp;=&nbsp;document.getElementById("material_confirmation_table");<br /><a name="l822" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><a name="l823" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create/add&nbsp;table&nbsp;headers<br /><a name="l824" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;header&nbsp;=&nbsp;table.insertRow(-1);<br /><a name="l825" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;header1&nbsp;=&nbsp;header.insertCell(0);<br /><a name="l826" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;header2&nbsp;=&nbsp;header.insertCell(1);<br /><a name="l827" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;header3&nbsp;=&nbsp;header.insertCell(2);<br /><a name="l828" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;header4&nbsp;=&nbsp;header.insertCell(3);<br /><a name="l829" /><br /><a name="l830" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header1.innerHTML&nbsp;=&nbsp;"&lt;h5&gt;Material&lt;/h5&gt;";<br /><a name="l831" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header2.innerHTML&nbsp;=&nbsp;"&lt;h5&gt;Status&lt;/h5&gt;";<br /><a name="l832" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header3.innerHTML&nbsp;=&nbsp;"&lt;h5&gt;Quantity&lt;/h5&gt;";<br /><a name="l833" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header4.innerHTML&nbsp;=&nbsp;"&lt;h5&gt;Cost&lt;/h5&gt;";<br /><a name="l834" /><br /><a name="l835" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;values<br /><a name="l836" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;materials.length;&nbsp;x++)<br /><a name="l837" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;populate_material_table_row(materials[x],&nbsp;table.insertRow(-1));<br /><a name="l838" /><br /><a name="l839" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;total&nbsp;to&nbsp;modal<br /><a name="l840" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;total_row&nbsp;=&nbsp;table.insertRow(-1);<br /><a name="l841" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_row.classList.add("warning");<br /><a name="l842" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;total_title&nbsp;=&nbsp;total_row.insertCell(0);<br /><a name="l843" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_title.innerHTML&nbsp;=&nbsp;"&lt;h5&nbsp;align='left'&gt;Total&lt;/h5&gt;";<br /><a name="l844" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_title.colSpan&nbsp;=&nbsp;"3";<br /><a name="l845" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;total_value&nbsp;=&nbsp;total_row.insertCell(1);<br /><a name="l846" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_value.innerHTML&nbsp;=&nbsp;`&lt;h5&gt;&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">"currency"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;&lt;/i&gt;${document.getElementById("total").innerHTML}&lt;/h5&gt;`;<br /><a name="l847" /><br /><a name="l848" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(materials.length)&nbsp;&nbsp;//&nbsp;center&nbsp;values<br /><a name="l849" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$("#material_confirmation_table&nbsp;tr&nbsp;td").not("first-input").attr("align",&nbsp;"center");<br /><a name="l850" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l851" /><br /><a name="l852" /><br /><a name="l853" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;used&nbsp;by&nbsp;populate_material_table(.)&nbsp;to&nbsp;create&nbsp;a&nbsp;row&nbsp;and&nbsp;store&nbsp;values&nbsp;in&nbsp;it<br /><a name="l854" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;populate_material_table_row(material,&nbsp;row)&nbsp;{<br /><a name="l855" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;status_name&nbsp;=&nbsp;material['status'].options[material['status'].selectedIndex].text;<br /><a name="l856" /><br /><a name="l857" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mat&nbsp;=&nbsp;row.insertCell(0);<br /><a name="l858" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;status&nbsp;=&nbsp;row.insertCell(1);<br /><a name="l859" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;quantity&nbsp;=&nbsp;row.insertCell(2);<br /><a name="l860" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;cost&nbsp;=&nbsp;row.insertCell(3);<br /><a name="l861" /><br /><a name="l862" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat.innerHTML&nbsp;=&nbsp;material['name'];<br /><a name="l863" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status.innerHTML&nbsp;=&nbsp;confirmation_cell_format(material['mu_id']+'-status',&nbsp;status_name,&nbsp;material['status'].value);<br /><a name="l864" /><br /><a name="l865" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!material["immeasurable"])&nbsp;{<br /><a name="l866" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity.innerHTML&nbsp;=&nbsp;confirmation_cell_format(material['mu_id']+'-quantity',&nbsp;material['quantity'],&nbsp;material['quantity']);<br /><a name="l867" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cost.innerHTML&nbsp;=&nbsp;`&lt;i&nbsp;class='<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sv</span><span style="color: #007700">[</span><span style="color: #DD0000">"currency"</span><span style="color: #007700">];&nbsp;</span><span style="color: #0000BB">?&gt;</span>'&gt;&lt;/i&gt;${round(material['cost'],&nbsp;2)}`;<br /><a name="l868" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l869" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l870" /><br /><a name="l871" /><br /><a name="l872" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;innerHTML&nbsp;for&nbsp;a&nbsp;cell&nbsp;using&nbsp;text&nbsp;and&nbsp;a&nbsp;hidden&nbsp;input<br /><a name="l873" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;confirmation_cell_format(name,&nbsp;text,&nbsp;value)&nbsp;{<br /><a name="l874" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;`${text}&lt;input&nbsp;name='${name}'&nbsp;value='${value}'&nbsp;hidden/&gt;`;<br /><a name="l875" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l876" /><br /><a name="l877" /><br /><a name="l878" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;retrieve&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;material&nbsp;based&nbsp;on&nbsp;a&nbsp;given&nbsp;input<br /><a name="l879" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ascend&nbsp;up:&nbsp;status&nbsp;-&gt;&nbsp;td&nbsp;-&gt;&nbsp;tr&nbsp;-&gt;&nbsp;table;&nbsp;down:&nbsp;tr[0]&nbsp;-&gt;&nbsp;td&nbsp;[0]&nbsp;-&gt;&nbsp;text;&nbsp;remove&nbsp;newline<br /><a name="l880" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;material_name(status_element)&nbsp;{<br /><a name="l881" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ancestor&nbsp;=&nbsp;status_element.parentElement.parentElement.parentElement<br /><a name="l882" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ancestor.children[0].children[0].textContent.trim();<br /><a name="l883" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l884" /><br /><a name="l885" /><br /><a name="l886" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————————&nbsp;OBJECT&nbsp;STORAGE&nbsp;———————————————<br /><a name="l887" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————————————————————————————————<br /><a name="l888" /><br /><a name="l889" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;call&nbsp;to&nbsp;modal&nbsp;to&nbsp;get&nbsp;first&nbsp;available&nbsp;box&nbsp;with&nbsp;type;&nbsp;create&nbsp;drawer&nbsp;layout&nbsp;&amp;&nbsp;insert&nbsp;into&nbsp;modal<br /><a name="l890" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;get_box_for_type(unit_type)&nbsp;{<br /><a name="l891" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.ajax({<br /><a name="l892" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:&nbsp;"./sub/storage_ajax_requests.php",<br /><a name="l893" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;"POST",<br /><a name="l894" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;"json",<br /><a name="l895" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;{"drawer_for_type"&nbsp;:&nbsp;true,&nbsp;"unit_type"&nbsp;:&nbsp;unit_type.value},<br /><a name="l896" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(response)&nbsp;{<br /><a name="l897" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(response["error"])&nbsp;{<br /><a name="l898" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(response["error"]);<br /><a name="l899" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br /><a name="l900" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l901" /><br /><a name="l902" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;stuff&nbsp;to&nbsp;page<br /><a name="l903" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;message&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;`Please&nbsp;place&nbsp;the&nbsp;object&nbsp;into&nbsp;drawer&nbsp;${response["drawer_label"]}&nbsp;box&nbsp;${response["unit_label"]},&nbsp;`+&nbsp;<br /><a name="l904" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`then&nbsp;confirm&nbsp;its&nbsp;placement&nbsp;by&nbsp;clicking&nbsp;the&nbsp;highlighted&nbsp;box&nbsp;on&nbsp;the&nbsp;screen`;<br /><a name="l905" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;drawer_label&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`&lt;h3&gt;Drawer&nbsp;${response["drawer_label"]}&nbsp;&lt;/h3&gt;`;<br /><a name="l906" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("drawer_fill").innerHTML&nbsp;=&nbsp;message&nbsp;+&nbsp;drawer_label&nbsp;+&nbsp;response["drawer_HTML"];<br /><a name="l907" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l908" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br /><a name="l909" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l910" /><br /><a name="l911" /><br /><a name="l912" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;storage&nbsp;modal&nbsp;is&nbsp;refreshed&nbsp;everytime&nbsp;it&nbsp;is&nbsp;opened<br /><a name="l913" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;reset_and_show_storage_modal()&nbsp;{<br /><a name="l914" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("drawer_fill").innerHTML&nbsp;=&nbsp;"";<br /><a name="l915" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById("storage_box_type_select").value&nbsp;=&nbsp;"—";<br /><a name="l916" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$("#storage_modal").show();<br /><a name="l917" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l918" /><br /><a name="l919" /><br /><a name="l920" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;called&nbsp;by&nbsp;box&nbsp;click&nbsp;on&nbsp;confirmation&nbsp;of&nbsp;object&nbsp;placement<br /><a name="l921" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;storage_selected(element,&nbsp;box_id)&nbsp;{<br /><a name="l922" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element.style.backgroundColor&nbsp;=&nbsp;"#0055FF";<br /><a name="l923" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element.style.color&nbsp;=&nbsp;"#FFFFFF";<br /><a name="l924" /><br /><a name="l925" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;add&nbsp;<br /><a name="l926" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;cell&nbsp;=&nbsp;document.getElementById("storage_location");<br /><a name="l927" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell.innerHTML&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`&lt;span&nbsp;onclick='reset_and_show_storage_modal();'&nbsp;style='background-color:#0055FF;<br /><a name="l928" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:4px&nbsp;solid&nbsp;#0055FF;border-radius:4px;padding:8px;margin:auto;color:#FFFFFF;'&gt;${box_id}&lt;/span&gt;`;<br /><a name="l929" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell.hidden&nbsp;=&nbsp;false;<br /><a name="l930" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(function()&nbsp;{<br /><a name="l931" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$('#storage_modal').fadeOut('fast');<br /><a name="l932" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;500);<br /><a name="l933" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l934" /><br /><a name="l935" /><br /><a name="l936" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;——————————————————&nbsp;UTILITY&nbsp;—————————————————<br /><a name="l937" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;———————————————————————————————————————<br /><a name="l938" /><br /><a name="l939" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;any&nbsp;of&nbsp;the&nbsp;items&nbsp;is&nbsp;relevant&nbsp;to&nbsp;the&nbsp;/usage&nbsp;function&nbsp;(eg&nbsp;contains&nbsp;/value),&nbsp;return&nbsp;true<br /><a name="l940" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;any(list,&nbsp;usage,&nbsp;value)&nbsp;{<br /><a name="l941" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;list.length;&nbsp;x++)<br /><a name="l942" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(usage(list[x],&nbsp;value))&nbsp;return&nbsp;true;<br /><a name="l943" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br /><a name="l944" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l945" /><br /><a name="l946" /><br /><a name="l947" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;find&nbsp;all&nbsp;the&nbsp;children&nbsp;for&nbsp;a&nbsp;selected&nbsp;input<br /><a name="l948" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;children_input_objects(parent_id)&nbsp;{<br /><a name="l949" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;children&nbsp;=&nbsp;[];<br /><a name="l950" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;elements&nbsp;=&nbsp;document.getElementsByClassName(parent_id+"-input");<br /><a name="l951" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;elements.length;&nbsp;x++)<br /><a name="l952" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($(elements[x]).find("input"))<br /><a name="l953" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;children.push(new&nbsp;Input(elements[x]));<br /><a name="l954" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;children;<br /><a name="l955" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l956" /><br /><a name="l957" /><br /><a name="l958" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;for&nbsp;every&nbsp;element&nbsp;in&nbsp;class_name&nbsp;passed,&nbsp;create&nbsp;an&nbsp;input&nbsp;object<br /><a name="l959" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;create_inputs_by_class_name(class_name)&nbsp;{<br /><a name="l960" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;inputs&nbsp;=&nbsp;[];<br /><a name="l961" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;elements&nbsp;=&nbsp;document.getElementsByClassName(class_name);<br /><a name="l962" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;x&nbsp;=&nbsp;0;&nbsp;x&nbsp;&lt;&nbsp;elements.length;&nbsp;x++)<br /><a name="l963" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputs.push(new&nbsp;Input(elements[x]));<br /><a name="l964" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;inputs;<br /><a name="l965" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l966" /><br /><a name="l967" /><br /><a name="l968" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;the&nbsp;mat_used&nbsp;id&nbsp;number&nbsp;from&nbsp;an&nbsp;element<br /><a name="l969" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;mat_used_id_of_element(element)&nbsp;{<br /><a name="l970" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;element.id.substr(0,&nbsp;element.id.indexOf('-'));<br /><a name="l971" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l972" /><br /><a name="l973" /><br /><a name="l974" />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;because&nbsp;JS&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;good&nbsp;rounding&nbsp;function,&nbsp;copied&nbsp;one&nbsp;from&nbsp;StackOverflow<br /><a name="l975" />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;round(float,&nbsp;decimal)&nbsp;{<br /><a name="l976" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!float)&nbsp;return&nbsp;0;<br /><a name="l977" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Number(Math.round(float+`e${decimal}`)+`e-${decimal}`).toFixed(decimal);<br /><a name="l978" />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><a name="l979" /><br /><a name="l980" /><br /><a name="l981" />&lt;/script&gt;<br /><a name="l982" /></span>